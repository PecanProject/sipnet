{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"SIPNET SIPNET (Simplified Photosynthesis and Evapotranspiration Model) is an ecosystem model designed to efficiently simulate carbon and water dynamics. Originally developed for assimilation of eddy covariance flux data in forest ecosystems, current development is focused on representing carbon balance and GHG fluxes and agricultural management practices. Getting Started Installing [What's required?] [Python may be required in the future, depending on what happens with formatting pre-commit hooks; we'll see] [Steps for building the program with make; mention 'make help' here too] [Add reference here to src/README.md for other utilities in this package] Executing the Program [Running the program - example] [Description of sipnet.in and different modes, some variation of the below paragraph] The program used for forward runs of the model. Its operation is controlled by the file 'sipnet.in'. SIPNET can run in three different modes: 'standard', for a standard forward run; 'senstest', for performing a sensitivity test on a single parameter; and 'montecarlo', for running the model forward using an ensemble of parameter sets. See 'sipnet.in' for further configuration options for each of these types of runs. Documentation [Describe building the doxygen documentation and what it contains] Roadmap or Changelog section? Do we want to list upcoming work? We could link to the issues page, and/or to the changelog Contributing See the main Contributing page License Distributed under the BSD 3-Clause license. See LICENSE for more information.","title":"Home"},{"location":"#sipnet","text":"SIPNET (Simplified Photosynthesis and Evapotranspiration Model) is an ecosystem model designed to efficiently simulate carbon and water dynamics. Originally developed for assimilation of eddy covariance flux data in forest ecosystems, current development is focused on representing carbon balance and GHG fluxes and agricultural management practices.","title":"SIPNET"},{"location":"#getting-started","text":"","title":"Getting Started"},{"location":"#installing","text":"[What's required?] [Python may be required in the future, depending on what happens with formatting pre-commit hooks; we'll see] [Steps for building the program with make; mention 'make help' here too] [Add reference here to src/README.md for other utilities in this package]","title":"Installing"},{"location":"#executing-the-program","text":"[Running the program - example] [Description of sipnet.in and different modes, some variation of the below paragraph] The program used for forward runs of the model. Its operation is controlled by the file 'sipnet.in'. SIPNET can run in three different modes: 'standard', for a standard forward run; 'senstest', for performing a sensitivity test on a single parameter; and 'montecarlo', for running the model forward using an ensemble of parameter sets. See 'sipnet.in' for further configuration options for each of these types of runs.","title":"Executing the Program"},{"location":"#documentation","text":"[Describe building the doxygen documentation and what it contains]","title":"Documentation"},{"location":"#roadmap-or-changelog-section","text":"Do we want to list upcoming work? We could link to the issues page, and/or to the changelog","title":"Roadmap or Changelog section?"},{"location":"#contributing","text":"See the main Contributing page","title":"Contributing"},{"location":"#license","text":"Distributed under the BSD 3-Clause license. See LICENSE for more information.","title":"License"},{"location":"CHANGELOG/","text":"Change Log All notable changes are kept in this file. All changes made should be added to the section called Unreleased . Once a new release is made this file will be updated to create a new Unreleased section for the next release. For more information about this file see also Keep a Changelog . [Unreleased] Added model structure and parameter documentation #42 Changelog #33 Build docs and push to gh-pages #41 Fixed Changed reorganized codebase, removed old sensitivity, ensemble, and fitting code as well as other study-specific code. Removed SIPNET 1.3.0 - \"Event Handler\" v1.3.0 represents the initial development of support for agricultural management events. Added Introduced Event Handler infrastructure #23 Add testing infrastructure. Changed Code cleanup (including comment standardization and spelling corrections). Update Doxyfile Add make help . 8ff893e61d69d0374bdf0fa14d156fd621c40eb4 SIPNET 1.2.1 - \"Add LICENSE and minor fixes\" Added Add BSD 3-Clause LICENSE file. Migrate documentation from Word to Markdown. Fixed Minor fixes prior to agricultural management implementation. Bug fix for output formatting (identified by @Qianyuxuan). 0c77ce863ac61113740c759dbe502a74e2d64edf SIPNET 1.2.0 - \"fAPAR assimilation\" Added Modify fAPAR calculation to enable assimilation of MODIS satellite-derived fAPAR. Publications Zobitz, J.M., David J.P. Moore, Tristan Quaife, Bobby H. Braswell, Andrew Bergeson, Jeremy A. Anthony, and Russell K. Monson. 2014. \u201cJoint Data Assimilation of Satellite Reflectance and Net Ecosystem Exchange Data Constrains Ecosystem Carbon Fluxes at a High-Elevation Subalpine Forest.\u201d Agricultural and Forest Meteorology 195\u2013196 (September):73\u201388. https://doi.org/10.1016/j.agrformet.2014.04.011. 97a225956775035506f573a29c7022de8d7d269d SIPNET 1.1.0 - \"Roots and Microbes\" Moore et al. (2008) Support joint CO2 and H2O assimilation. Zobitz et al. (2008) Add process-based soil respiration with microbes \"soil quality model\". Add fine and coarse root pools. Compare different model structures (base, soil quality, and roots). Calculate Transpiration using Ball Berry, initial implementation of and Penman-Monteith Publications Moore, David J.P., Jia Hu, William J. Sacks, David S. Schimel, and Russell K. Monson. 2008. \u201cEstimating Transpiration and the Sensitivity of Carbon Uptake to Water Availability in a Subalpine Forest Using a Simple Ecosystem Process Model Informed by Measured Net CO2 and H2O Fluxes.\u201d Agricultural and Forest Meteorology 148 (10): 1467\u201377. https://doi.org/10.1016/j.agrformet.2008.04.013. Zobitz, J. M., D. J. P. Moore, W. J. Sacks, R. K. Monson, D. R. Bowling, and D. S. Schimel. 2008. \u201cIntegration of Process-Based Soil Respiration Models with Whole-Ecosystem CO2 Measurements.\u201d Ecosystems 11 (2): 250\u201369. https://doi.org/10.1007/s10021-007-9120-1. SIPNET 1.0.0 - \"SIPNET First Release\" The first release of SIPNET reflected a series of improvements over the original SIPNET model (Braswell et al., 2005). The model was developed by Bill Sacks and Dave Moore, with contributions from John Zobitz. The model was parameterized using data from the Harvard Forest flux tower using MCMC (Sacks et al., 2006). The model was designed to simulate the carbon and water cycles of a forest ecosystem at half-daily time steps. Braswell et al. (2005) Initial version of SIPNET. Half-daily time step with two vegetation carbon pools and one soil pool. MCMC parameter fitting with observations from Harvard forest flux tower. Sacks et al. (2006) More complex water routine incorporating evaporation and snow pack. Evergreen leaf phenology. Sacks et al. (2007): \"Better Respiration\" Shut down photosynthesis and foliar respiration when soil temperature < threshold. Partition autotrophic and heterotrophic respiration. 47d6546e245384dbda7e981a3bc8b729d4f756fc Publications Braswell, Bobby H., William J. Sacks, Ernst Linder, and David S. Schimel. 2005. \u201cEstimating Diurnal to Annual Ecosystem Parameters by Synthesis of a Carbon Flux Model with Eddy Covariance Net Ecosystem Exchange Observations.\u201d Global Change Biology 11 (2): 335\u201355. https://doi.org/10.1111/j.1365-2486.2005.00897.x. Sacks, William J., David S. Schimel, and Russell K. Monson. 2007. \u201cCoupling between Carbon Cycling and Climate in a High-Elevation, Subalpine Forest: A Model-Data Fusion Analysis.\u201d Oecologia 151 (1): 54\u201368. https://doi.org/10.1007/s00442-006-0565-2. Sacks, William J., David S. Schimel, Russell K. Monson, and Bobby H. Braswell. 2006. \u201cModel\u2010data Synthesis of Diurnal and Seasonal CO2 Fluxes at Niwot Ridge, Colorado.\u201d Global Change Biology 12 (2): 240\u201359. https://doi.org/10.1111/j.1365-2486.2005.01059.x.","title":"Changelog"},{"location":"CHANGELOG/#change-log","text":"All notable changes are kept in this file. All changes made should be added to the section called Unreleased . Once a new release is made this file will be updated to create a new Unreleased section for the next release. For more information about this file see also Keep a Changelog .","title":"Change Log"},{"location":"CHANGELOG/#unreleased","text":"","title":"[Unreleased]"},{"location":"CHANGELOG/#added","text":"model structure and parameter documentation #42 Changelog #33 Build docs and push to gh-pages #41","title":"Added"},{"location":"CHANGELOG/#fixed","text":"","title":"Fixed"},{"location":"CHANGELOG/#changed","text":"reorganized codebase, removed old sensitivity, ensemble, and fitting code as well as other study-specific code.","title":"Changed"},{"location":"CHANGELOG/#removed","text":"","title":"Removed"},{"location":"CHANGELOG/#sipnet-130-event-handler","text":"v1.3.0 represents the initial development of support for agricultural management events.","title":"SIPNET 1.3.0 - \"Event Handler\""},{"location":"CHANGELOG/#added_1","text":"Introduced Event Handler infrastructure #23 Add testing infrastructure.","title":"Added"},{"location":"CHANGELOG/#changed_1","text":"Code cleanup (including comment standardization and spelling corrections). Update Doxyfile Add make help . 8ff893e61d69d0374bdf0fa14d156fd621c40eb4","title":"Changed"},{"location":"CHANGELOG/#sipnet-121-add-license-and-minor-fixes","text":"","title":"SIPNET 1.2.1 - \"Add LICENSE and minor fixes\""},{"location":"CHANGELOG/#added_2","text":"Add BSD 3-Clause LICENSE file. Migrate documentation from Word to Markdown.","title":"Added"},{"location":"CHANGELOG/#fixed_1","text":"Minor fixes prior to agricultural management implementation. Bug fix for output formatting (identified by @Qianyuxuan). 0c77ce863ac61113740c759dbe502a74e2d64edf","title":"Fixed"},{"location":"CHANGELOG/#sipnet-120-fapar-assimilation","text":"","title":"SIPNET 1.2.0 - \"fAPAR assimilation\""},{"location":"CHANGELOG/#added_3","text":"Modify fAPAR calculation to enable assimilation of MODIS satellite-derived fAPAR.","title":"Added"},{"location":"CHANGELOG/#publications","text":"Zobitz, J.M., David J.P. Moore, Tristan Quaife, Bobby H. Braswell, Andrew Bergeson, Jeremy A. Anthony, and Russell K. Monson. 2014. \u201cJoint Data Assimilation of Satellite Reflectance and Net Ecosystem Exchange Data Constrains Ecosystem Carbon Fluxes at a High-Elevation Subalpine Forest.\u201d Agricultural and Forest Meteorology 195\u2013196 (September):73\u201388. https://doi.org/10.1016/j.agrformet.2014.04.011. 97a225956775035506f573a29c7022de8d7d269d","title":"Publications"},{"location":"CHANGELOG/#sipnet-110-roots-and-microbes","text":"Moore et al. (2008) Support joint CO2 and H2O assimilation. Zobitz et al. (2008) Add process-based soil respiration with microbes \"soil quality model\". Add fine and coarse root pools. Compare different model structures (base, soil quality, and roots). Calculate Transpiration using Ball Berry, initial implementation of and Penman-Monteith","title":"SIPNET 1.1.0 - \"Roots and Microbes\""},{"location":"CHANGELOG/#publications_1","text":"Moore, David J.P., Jia Hu, William J. Sacks, David S. Schimel, and Russell K. Monson. 2008. \u201cEstimating Transpiration and the Sensitivity of Carbon Uptake to Water Availability in a Subalpine Forest Using a Simple Ecosystem Process Model Informed by Measured Net CO2 and H2O Fluxes.\u201d Agricultural and Forest Meteorology 148 (10): 1467\u201377. https://doi.org/10.1016/j.agrformet.2008.04.013. Zobitz, J. M., D. J. P. Moore, W. J. Sacks, R. K. Monson, D. R. Bowling, and D. S. Schimel. 2008. \u201cIntegration of Process-Based Soil Respiration Models with Whole-Ecosystem CO2 Measurements.\u201d Ecosystems 11 (2): 250\u201369. https://doi.org/10.1007/s10021-007-9120-1.","title":"Publications"},{"location":"CHANGELOG/#sipnet-100-sipnet-first-release","text":"The first release of SIPNET reflected a series of improvements over the original SIPNET model (Braswell et al., 2005). The model was developed by Bill Sacks and Dave Moore, with contributions from John Zobitz. The model was parameterized using data from the Harvard Forest flux tower using MCMC (Sacks et al., 2006). The model was designed to simulate the carbon and water cycles of a forest ecosystem at half-daily time steps. Braswell et al. (2005) Initial version of SIPNET. Half-daily time step with two vegetation carbon pools and one soil pool. MCMC parameter fitting with observations from Harvard forest flux tower. Sacks et al. (2006) More complex water routine incorporating evaporation and snow pack. Evergreen leaf phenology. Sacks et al. (2007): \"Better Respiration\" Shut down photosynthesis and foliar respiration when soil temperature < threshold. Partition autotrophic and heterotrophic respiration. 47d6546e245384dbda7e981a3bc8b729d4f756fc","title":"SIPNET 1.0.0 - \"SIPNET First Release\""},{"location":"CHANGELOG/#publications_2","text":"Braswell, Bobby H., William J. Sacks, Ernst Linder, and David S. Schimel. 2005. \u201cEstimating Diurnal to Annual Ecosystem Parameters by Synthesis of a Carbon Flux Model with Eddy Covariance Net Ecosystem Exchange Observations.\u201d Global Change Biology 11 (2): 335\u201355. https://doi.org/10.1111/j.1365-2486.2005.00897.x. Sacks, William J., David S. Schimel, and Russell K. Monson. 2007. \u201cCoupling between Carbon Cycling and Climate in a High-Elevation, Subalpine Forest: A Model-Data Fusion Analysis.\u201d Oecologia 151 (1): 54\u201368. https://doi.org/10.1007/s00442-006-0565-2. Sacks, William J., David S. Schimel, Russell K. Monson, and Bobby H. Braswell. 2006. \u201cModel\u2010data Synthesis of Diurnal and Seasonal CO2 Fluxes at Niwot Ridge, Colorado.\u201d Global Change Biology 12 (2): 240\u201359. https://doi.org/10.1111/j.1365-2486.2005.01059.x.","title":"Publications"},{"location":"CODE_OF_CONDUCT/","text":"","title":"Code of Conduct"},{"location":"CONTRIBUTING/","text":"Contributing to SIPNET We welcome contributions to SIPNET. This document outlines the process for contributing to the SIPNET project. All contributors are expected to adhere to the PEcAn Project Code of Conduct . Setup If changes are intended for any C-code files, please execute this command: tools/setup.sh to run the setup script, which will: 1. Check to make sure that python is installed and is at least version 3.8 2. Ensure that clang-format and clang-tidy are installed (and install them if running on MacOS) 3. Install the pre-commit hook, which checks the format of modified C files. This will help prevent PR failures due to formatting issues by finding those issues earlier. Note: This step is not necessary for changes to documentation, markdown files, config, etc. GitHub Workflow Branches The master branch is the default branch for SIPNET. Development should be done in feature branches. Feature branches should be named to clearly indicate the purpose, and may be combined with an associated issue, e.g. ISSUE#-feature-name . Pull Requests Pull requests should be made from feature branches to the master branch. Pull request descriptions should include a brief summary of the changes and links to related issues. Expectations for merging: - Pass all unit and integration tests. - Approved by at least one other developer before being merged. - Include updates and additions to - Documentation - Tests - CHANGELOG.md Pull requests must pass all required checks to be merged into master, including code format and style checks. Code Format and Style Clang Tools This repo uses clang-format and clang-tidy to ensure code consistency and prevent (some) bad coding practices. Each tool has a configuration file in the repo root directory. clang-format is run on each modified C-language file on commit; the commit will fail if any of the format checks fail. To fix these errors: * if all changes are staged (via git add ), run the command git clang-format to fix the formatting and re-commit * if not all changes are staged (likely a git commit -a command), either git add all the changes, or try git clang-format -f to reformat all modified files * clang-format may also be run outside of git , as a means of updating a file's format regardless of modification status (see clang-format --help ) clang-tidy is one of the checks run on PR submission (along with building and testing) via the cpp-linter github action. If this action fails, a comment will be made in the PR detailing the issues found. clang-format is also run by this action, so formatting issues that might have been bypassed on commit will be found here. You may attempt to have clang-tidy automatically fix clang-tidy issues with the command: clang-tidy --fix <filename> Documentation What goes in Doxygen : - Documentation for functions, classes, and parameters. What goes in docs/*md : - User guides and tutorials. - Documentation of equations, theoretical basis, and parameters. Compiling SIPNET binaries SIPNET uses make to build the model and documentation. There are also miscellaneous targets for running analysis workflows: # build SIPNET executable make sipnet # build documentation make document # clean up build artifacts make clean # list all make commands make help Testing Any new features (that are worth keeping!) should be covered by tests. SIPNET also uses make to build and run its unit tests. This can be done with the following commands: # Compile tests make test # Run tests make testrun # Clean after tests are run make testclean If changes are made to the modelStructure.h file and unit tests are failing, try running the update script as shown below. Consider running this script even if unit tests are not failing. # Run this command from the root directory to update unit test versions of modelStructures.h tests/update_model_structures.sh Releases Use Semantic Versioning v2 for SIPNET releases. Tag releases with the version number vX.Y.Z . Include content from CHANGELOG.md file. Add compiled SIPNET binaries.","title":"Contributing"},{"location":"CONTRIBUTING/#contributing-to-sipnet","text":"We welcome contributions to SIPNET. This document outlines the process for contributing to the SIPNET project. All contributors are expected to adhere to the PEcAn Project Code of Conduct .","title":"Contributing to SIPNET"},{"location":"CONTRIBUTING/#setup","text":"If changes are intended for any C-code files, please execute this command: tools/setup.sh to run the setup script, which will: 1. Check to make sure that python is installed and is at least version 3.8 2. Ensure that clang-format and clang-tidy are installed (and install them if running on MacOS) 3. Install the pre-commit hook, which checks the format of modified C files. This will help prevent PR failures due to formatting issues by finding those issues earlier. Note: This step is not necessary for changes to documentation, markdown files, config, etc.","title":"Setup"},{"location":"CONTRIBUTING/#github-workflow","text":"","title":"GitHub Workflow"},{"location":"CONTRIBUTING/#branches","text":"The master branch is the default branch for SIPNET. Development should be done in feature branches. Feature branches should be named to clearly indicate the purpose, and may be combined with an associated issue, e.g. ISSUE#-feature-name .","title":"Branches"},{"location":"CONTRIBUTING/#pull-requests","text":"Pull requests should be made from feature branches to the master branch. Pull request descriptions should include a brief summary of the changes and links to related issues. Expectations for merging: - Pass all unit and integration tests. - Approved by at least one other developer before being merged. - Include updates and additions to - Documentation - Tests - CHANGELOG.md Pull requests must pass all required checks to be merged into master, including code format and style checks.","title":"Pull Requests"},{"location":"CONTRIBUTING/#code-format-and-style","text":"","title":"Code Format and Style"},{"location":"CONTRIBUTING/#clang-tools","text":"This repo uses clang-format and clang-tidy to ensure code consistency and prevent (some) bad coding practices. Each tool has a configuration file in the repo root directory. clang-format is run on each modified C-language file on commit; the commit will fail if any of the format checks fail. To fix these errors: * if all changes are staged (via git add ), run the command git clang-format to fix the formatting and re-commit * if not all changes are staged (likely a git commit -a command), either git add all the changes, or try git clang-format -f to reformat all modified files * clang-format may also be run outside of git , as a means of updating a file's format regardless of modification status (see clang-format --help ) clang-tidy is one of the checks run on PR submission (along with building and testing) via the cpp-linter github action. If this action fails, a comment will be made in the PR detailing the issues found. clang-format is also run by this action, so formatting issues that might have been bypassed on commit will be found here. You may attempt to have clang-tidy automatically fix clang-tidy issues with the command: clang-tidy --fix <filename>","title":"Clang Tools"},{"location":"CONTRIBUTING/#documentation","text":"What goes in Doxygen : - Documentation for functions, classes, and parameters. What goes in docs/*md : - User guides and tutorials. - Documentation of equations, theoretical basis, and parameters.","title":"Documentation"},{"location":"CONTRIBUTING/#compiling-sipnet-binaries","text":"SIPNET uses make to build the model and documentation. There are also miscellaneous targets for running analysis workflows: # build SIPNET executable make sipnet # build documentation make document # clean up build artifacts make clean # list all make commands make help","title":"Compiling SIPNET binaries"},{"location":"CONTRIBUTING/#testing","text":"Any new features (that are worth keeping!) should be covered by tests. SIPNET also uses make to build and run its unit tests. This can be done with the following commands: # Compile tests make test # Run tests make testrun # Clean after tests are run make testclean If changes are made to the modelStructure.h file and unit tests are failing, try running the update script as shown below. Consider running this script even if unit tests are not failing. # Run this command from the root directory to update unit test versions of modelStructures.h tests/update_model_structures.sh","title":"Testing"},{"location":"CONTRIBUTING/#releases","text":"Use Semantic Versioning v2 for SIPNET releases. Tag releases with the version number vX.Y.Z . Include content from CHANGELOG.md file. Add compiled SIPNET binaries.","title":"Releases"},{"location":"model-structure/","text":"Model Structure Goal: simplified biogeochemical model that is capable of simulating GHG balance, including soil carbon, $CO_2$, $CH_4$, and $N_2O$ flux. Key validation criteria is the ability to correctly capture the response of these pools and fluxes to changes in agronomic management practices, both current and future. Design approach: Start as simple as possible, add complexity as needed. When new features are considered, they should be evaluated alongside other possible model improvements that have been considered, and the overall list of project needs. Notes on notation: Fluxes are denoted by $F$, except that respiration is denoted by $R$ following convention and previous descriptions of SIPNET. Parameters and other information can be found in the Parameters documentation. Scope This document provides an overview of the SIPNET model\u2019s structure. It was written to - Consolidate the descriptions from multiple papers (notably Braswell et al 2005 and Zobitz et al 2008). - Provide enough detail to support the addition of agronomic events, CH4, and N2O fluxes. - Focus on features currently in regular use. There are multiple ways to configure the model structure, and not all model structures are listed, notably the litter quality model. We aim to extend the scope of this document to be more comprehensive of the regularly used features. $\\mathfrak{Proposed \\ Features}$ Proposed features are indicated using the using $\\mathfrak{Fraktur Font}$. Where an entire section is new, it is only used in the section heading. Otherwise, it is used for terms within equations. As these features are implemented, the \\mathfrak{} commands should be removed. Carbon Dynamics Maximum Photosynthetic Rate $$ \\text{GPP} {\\text{max}} = A {\\text{max}} \\cdot A_d + R_{leaf,0} \\tag{Braswell A6}\\label{eq:A6} $$ The daily maximum gross photosynthetic rate $(\\text{GPP} {\\text{max}})$ represents the maximum potential GPP under optimal conditions. It is modeled as the leaf-level maximum net assimilation rate $(A {\\text{max}})$ multiplied by a scaling factor $(A_d)$, plus foliar maintenance respiration at optimum temperature $(R_{\\text{leaf},0})$. The scaling factor $A_d$ accounts for daily variation in photosynthesis, representing the average fraction of $A_{\\text{max}}$ that is realized over the course of a day. Potential Photosynthesis $$ \\text{GPP} {\\text{pot}} = \\text{GPP} {\\text{max}} \\cdot D_{\\text{temp}} \\cdot D_{\\text{VPD}} \\cdot D_{\\text{light}} \\tag{Braswell A7}\\label{eq:A7} $$ The potential gross primary production $(\\text{GPP} {\\text{pot}})$ is calculated by reducing $\\text{GPP} {\\text{max}}$ by temperature, vapor pressure deficit, and light. Adjusted Gross Primary Production $$ \\text{GPP} = \\text{GPP} {\\text{pot}} \\cdot D {\\text{water}} \\tag{Braswell A17}\\label{eq:A17} $$ The total adjusted gross primary production (GPP) is the product of potential GPP $(\\text{GPP} {\\text{pot}})$ and the water stress factor $D {\\text{water,}A}$. The water stress factor $D_{\\text{water,}A}$ is defined in equation \\eqref{eq:A16} as the ratio of actual to potential transpiration, and therefore couples GPP to transpiration by reducing GPP. Plant Growth $$ \\text{NPP} = \\text{GPP} - R_A \\tag{1} \\label{eq:npp} $$ Net primary productivity $(\\text{NPP})$ is the total carbon gain of plant biomass. NPP is allocated to plant biomass pools in proportion to their allocation parameters $\\alpha_i$. $$ \\text{NPP}=\\sum_{1}^{i} \\frac{dC_{\\text{plant,}i}}{dt} \\tag{2} \\label{eq:npp_summ} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ Note that $\\alpha_i$ are specified input parameters and $\\sum_i{\\alpha_i} = 1$. $$ dC_{\\text{plant,}i} = \\text{NPP} \\cdot a_i \\mathfrak{- F^C_{\\text{harvest,removed,}i}} - F^C_{\\text{litter,}i} \\tag{Zobitz 3}\\label{eq:Z3} $$ This results in the following constraints: - In the case of annuals, all biomass is either harvested and removed or added to litter pools. $F^C_{\\text{harvest,removed,}i}$ is calculated by \\eqref{eq:harvest}. - In the case of perennials, a fraction of the biomass remains except at the end of the perennial's life. $$\\mathfrak{ F^C_{\\text{litter,}i} + F^C_{\\text{harvest,removed,}i} = \\begin{cases} 1 & \\text{annuals} \\ \\leq 1 & \\text{perennials} \\end{cases} }$$ Plant Death Plant death is implemented as a harvest event with the fraction of biomass transferred to litter, $f_{\\text{harvest,transfer,}i}$ set to 1. Wood Carbon $$ \\frac{dC_\\text{wood}}{dt} = \\alpha_\\text{wood}\\cdot\\text{NPP} - F^C_\\text{litter,wood} \\tag{Braswell A1}\\label{eq:A1} $$ Change in plant wood carbon $(C_W)$ over time is determined by the fraction of net primary productivity allocated to wood, and wood litter production $(F^C_\\text{litter,wood})$. Leaf Carbon $$ \\frac{dC_\\text{leaf}}{dt} = L - F^C_\\text{litter,leaf} \\tag{Braswell A2}\\label{eq:A2} $$ The change in plant leaf carbon $(C_\\text{leaf})$ over time is given by the balance of leaf production $(L)$ and leaf litter production $(F^C_\\text{litter,leaf})$. Leaf Maintenance Respiration $$ R_\\text{leaf,opt} = k_\\text{leaf} \\cdot A_{\\text{max}} \\cdot C_\\text{leaf} \\tag{Braswell A5}\\label{eq:A5} $$ Where $R_\\text{leaf,opt}$ is leaf maintenance respiration at $T_\\text{opt}$, proportional to the maximum photosynthetic rate $A_{\\text{max}}$ with a scaling factor $k_\\text{leaf}$ multiplied by the mass of leaf $C_\\text{leaf}$. $$ R_\\text{leaf} = R_\\text{leaf,opt} \\cdot D_{\\text{temp,Q10}} \\tag{Braswell A18a}\\label{eq:A18a} $$ Actual foliar respiration $(R_\\text{leaf})$ is modeled as a function of the foliar respiration rate $(R_\\text{leaf,opt})$ at optimum temperature of leaf respiration $T_\\text{opt}$ and the $Q_{10}$ temperature sensitivity factor. Wood Maintenance Respiration $$ R_\\text{wood} = K_\\text{wood} \\cdot C_\\text{wood} \\cdot D_{\\text{temp,Q10}_v} \\tag{Braswell A19}\\label{eq:A19} $$ Wood maintenance respiration $(R_m)$ depends on the wood carbon content $(C_\\text{wood})$, a scaling constant $(k_\\text{wood})$, and the temperature sensitivity scaling function $D_{\\text{temp,Q10}_v}$. Litter Carbon The change in the litter carbon pool over time is defined by the input of new litter and the loss to decomposition: $$ \\frac{dC_\\text{litter}}{dt} = F^C_\\text{litter} - F^C_{\\text{decomp}} $$ Where $F^C_\\text{litter}$ is the carbon flux from plant biomass into the litter pool through senescence and harvest \\eqref{eq:litter_flux}. $F^C_{\\text{decomp,litter}}$ is the total carbon flux lost from the litter pool due to decomposition and includes both transfer and decomposition \\eqref{eq:decomp_carbon}. The flux of carbon from the plant to the litter pool is the sum litter produced through senescence, transfer of any biomass pools during harvest, and organic matter ammendments: $$ F^C_\\text{litter} = \\sum_{i} K_{\\text{plant,}i} \\cdot C_{\\text{plant,}i} + \\mathfrak{ \\sum_{i} F^C_{\\text{harvest,transfer,}i} + F^C_\\text{fert,org} } \\tag{3}\\label{eq:litter_flux} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ Where $K$ is the turnover rate of plant pool $i$ that controls the rate at which plant biomass is transferred to litter. The decomposition flux from litter carbon is divided into heterotrophic respiration and carbon transfer to soil: $$ F^C_{\\text{decomp}} = R_{H,\\text{litter}} + F^C_{\\text{soil}} \\tag{4}\\label{eq:decomp_carbon} $$ Where $R_{H_{\\text{litter}}}$ is heterotrophic respiration from litter \\eqref{eq:rh_litter}, and $F^C_{\\text{soil}}$ is the carbon transfer from the litter pool to the soil \\eqref{eq:soil_carbon}. This partitioning is based on the fraction of litter that is respired, $f_{R_H}$. $$ R_{H_{\\text{litter}}} = f_{R_H} \\cdot K_\\text{litter} \\cdot C_\\text{litter} \\cdot D_{\\text{temp}} \\cdot D_{\\text{water}R_H} \\tag{5}\\label{eq:rh_litter} $$ $$ F^C_{\\text{soil}} = (1 - f_{R_H}) \\cdot K_\\text{litter} \\cdot C_\\text{litter} \\cdot D_{\\text{temp}} \\cdot D_{\\text{water}R_H} \\tag{6}\\label{eq:soil_carbon} $$ The rate of decomposition is a function of the litter carbon content and the decomposition rate $K_{\\text{litter}}$ modified by temperature and moisture factors. $f_{R_H}$ is the fraction of litter carbon that is respired. Soil Carbon $$ \\frac{dC_\\text{soil}}{dt} = F^C_\\text{soil} - R_{H_\\text{soil}} \\tag{Braswell A3}\\label{eq:A3} $$ The change in the SOC pool over time $\\frac{dC_\\text{soil}}{dt}$ is determined by the addition of litter carbon and the loss of carbon to heterotrophic respiration. This model assumes no loss of SOC to leaching or erosion. Heterotrophic Respiration $(C_\\text{soil,litter} \\rightarrow CO_2)$ Total heterotrophic respiration is the sum of respiration from soil and litter pools: $$ R_{H} = f_{R_H} \\cdot \\left(\\sum_j K_j \\cdot C_j \\mathfrak{\\cdot D_{\\text{tillage,}j}} \\right) \\cdot D_{\\text{temp}} \\cdot D_{\\text{water,}R_H} \\cdot D_{CN} \\tag{7}\\label{eq:rh} $$ $$\\small j \\in {\\text{soil, litter}}$$ Where heterotrophic respiration, $R_H$, is a function of each carbon pool $C_j$ and its associated decomposition rate $K_{C_j}$ adjusted by the fraction allocated to respiration, $f_{R_H}$, and the temperature, moisture, tillage, and CN dependency $(D_\\star)$ functions. $\\frak{Methane \\ Production \\ (C \\rightarrow CH_4)}$ $$ F^C_\\mathit{CH_4} = \\left(\\sum_{j} K_{CH_4,j} \\cdot C_\\text{j}\\right) \\cdot D_\\mathrm{water, O_2} \\cdot D_\\text{temp} \\tag{8}\\label{eq:ch4} $$ $$\\small j \\in {\\text{soil, litter}}$$ The calculation of methane flux $(F^C_{CH_4})$ is analagous to to that of $R_H$. It uses the same carbon pools as substrate and temperature dependence but has specific rate parameters $(K_{\\mathit{CH_4,}j})$, a moisture dependence function based on oxygen availability, and no direct dependence on tillage. $\\frak{Carbon:Nitrogen \\ Ratio \\ Dynamics (CN)}$ The carbon and nitrogen cycle are tightly coupled by the C:N ratios of plant and organic matter pools. The C:N ratio of plant biomass pools is fixed, while the C:N ratio of soil organic matter and litter pools is dynamic. $\\frak{Fixed \\ Plant \\ C:N \\ Ratios}$ Plant biomass pools have a fixed CN ratio and are thus stoichiometrically coupled to carbon: $$ N_i = \\frac{C_i}{CN_{i}} \\tag{9}\\label{eq:cn_stoich} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ Where $i$ is the leaf, wood, fine root, or coarse root pool. This relationship applies to both pools $C,N$ and fluxes $(F^C, F^N)$. Soil organic matter and litter pools have dynamic CN that is determined below. $\\frak{Dynamic \\ Soil \\ Organic \\ Matter \\ and \\ Litter \\ C:N \\ Ratios}$ The change in the soil C:N ratio over time of soil and litter pools depends on the rate of change of carbon and nitrogen in the pool, normalized by the total nitrogen in the pool. This makes sense as it captures how changes in carbon and nitrogen affect their ratio. $$ \\frac{dCN_{\\text{j}}}{dt} = \\frac{1}{N_{\\text{j}}} \\left( \\frac{dC_{\\text{j}}}{dt} - CN_{\\text{j}} \\cdot \\frac{dN_{\\text{j}}}{dt} \\right) \\tag{10}\\label{eq:cn} $$ $$\\small j \\in {\\text{soil, litter}}$$ $\\frak{C:N \\ Dependency \\ Function \\ (D_{CN})}$ To represent the influence of substrate quality on decomposition rate, we add a simple dependence function $D_{CN}$. $$ D_{CN} = \\frac{1}{1+k_CN \\cdot CN} \\tag{11}\\label{eq:cn_dep} $$ Where $k_CN$ is a scaling parameter that controls the sensitivity of decomposition rate to C:N ratio. This parameter represents the half-saturation constant of the Michaelis-Menten equation. $\\frak{Nitrogen \\ Dynamics (\\frac{dN}{dt})}$ $\\frak{Plant \\ Biomass \\ Nitrogen}$ Similar to the stoichiometric coupling of litter fluxes, the change in plant biomass N over time is stoichiometrically coupled to plant biomass C: $$ \\frac{dN_{\\text{plant,}i}}{dt} = \\frac{dC_{\\text{plant,}i}}{dt} / CN_{\\text{plant,}i} \\tag{12}\\label{eq:plant_n} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ $\\frak{Litter \\ Nitrogen}$ The change in litter nitrogen over time, $N_\\text{litter}$ is determined by inputs including leaf and wood litter, nitrogen in organic matter amendments, and losses to mineralization: $$ \\frac{dN_{\\text{litter}}}{dt} = \\sum_{i} F^N_{\\text{litter,}i} + F^N_\\text{fert,org} - F^N_\\text{litter,min} \\tag{13}\\label{eq:litter_dndt} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ The flux of nitrogen from living biomass to the litter pool is proportional to the carbon content of the biomass, based on the C:N ratio of the biomass pool \\eqref{eq:cn_stoich}. Similarly, nitrogen from organic matter amendments is calculated from the carbon content and the C:N ratio of the inputs. $\\frak{Soil \\ Organic \\ Nitrogen}$ $$ \\frac{dN_\\text{org,soil}}{dt} = F^N_\\text{litter} - F^N_\\text{soil,min} \\tag{14}\\label{eq:org_soil_dndt} $$ The change in nitrogen pools in this model is proportional to the ratio of carbon to nitrogen in the pool. Equations for the evolution of soil and litter CN are below. $\\frak{Soil \\ Mineral \\ Nitrogen \\ F^N_\\text{min}}$ Change in the mineral nitrogen pool over time is determined by inputs from mineralization and fertilization, and losses to volatilization, leaching, and plant uptake: $$ \\frac{dN_\\text{min}}{{dt}} = F^N_\\text{litter,min} + F^N_\\text{soil,min} + F^N_\\text{fix} - F^N_\\text{fert,min} - F^N_\\mathrm{vol} - F^N_\\text{leach} - F^N_\\text{uptake} \\tag{15}\\label{eq:mineral_n_dndt} $$ Mineralization, fertilization, and fixation add to the mineral nitrogen pool. Losses include mineralization, volatilization, leaching, and plant uptake, described below: $\\frak{N \\ Mineralization \\ (F^N_\\text{min})}$ Total nitrogen mineralization is proportional to the total heterotrophic respiration from soil and litter pools, divided by the C:N ratio of the pool. The effects of temperature, moisture, tillage, and C:N ratio on mineralization rate are captured in the calculation of $R_\\text{H}$. $$ F^N_\\text{min} = \\sum_j \\left( \\frac{R_{H\\text{j}}}{CN_{\\text{j}}} \\right) \\tag{16}\\label{eq:n_min} $$ $$\\small j \\in {\\text{soil, litter}}$$ $\\frak{Nitrogen \\ Volatilization \\ F^N_\\text{vol}: (N_\\text{min,soil} \\rightarrow N_2O)}$ The simplest way to represent $N_2O$ flux is as a proportion of the mineral N pool $N_\\text{min}$ or the N mineralization rate $F^N_{min}$. For example, CLM-CN and CLM 4.0 represent $N_2O$ flux as a proportion of $N_\\text{min}$ (Thornton et al 2007, TK-ref CLM 4.0). By contrast, Biome-BGC (Golinkoff et al 2010; Thornton and Rosenbloom, 2005 and https://github.com/bpbond/Biome-BGC, Golinkoff et al 2010; Thornton and Rosenbloom, 2005) represents $N_2O$ flux as a proportion of the N mineralization rate. Because we expect $N_2O$ emissions will be dominated by fertilizer N inputs, we will start with the $N_\\text{min}$ pool size approach. This approach also has the advantage of accounting for reduced $N_2O$ flux when N is limiting (Zahele and Dalmorech 2011). A new fixed parameter $K_\\text{vol}$ will represent the proportion of $N_\\text{min}$ that is volatilized as $N_2O$. $$ F^N_\\mathrm{N_2O vol} = K_\\text{vol} \\cdot N_\\text{min} \\cdot D_{\\text{temp}} \\cdot D_{\\text{water}R_H} \\tag{17}\\label{eq:n2o_vol} $$ $\\frak{Nitrogen \\ Leaching \\ F^N_\\text{leach}}$ $$ F^N_\\text{leach} = N_\\text{min} \\cdot F^W_{drainage} \\cdot f_{N leach} \\tag{18}\\label{eq:n_leach} $$ Where $F^N_\\text{leach}$ is the fraction of $N_{min}$ in soil water that is available to be leached, $F^W_{drainage}$ is drainage. $\\frak{Nitrogen \\ Fixation \\ F^N_\\text{fix}}$ The rate at which N is fixed is a function of the NPP of the plant and a fixed parameter $K_\\text{fix}$, and is modified by temperature. For nitrogen fixing plants, rates of symbiotic nitrogen fixation are assumed to be driven by plant growth, and also depend on temperature. $$ F^N_\\text{fix} = K_\\text{fix} \\cdot NPP \\cdot D_{\\text{temp}} \\tag{19}\\label{eq:n_fix} $$ Nitrogen fixation is represented by adding fixed nitrogen directly to the soil mineral nitrogen pool. This is a reasonable first approximation, consistent with the simplicity of the nitrogen limitation model where limitation only occurs when nitrogen demand exceeds supply. For nitrogen-fixing plants, most of the fixed nitrogen is directly used by the plant. It would be more complicated to model this by splitting, which could include splitting the fixed N into soil and plant pools and then meeting a portion of plant N demand with this flux. $\\frak{Plant \\ Nitrogen \\ Uptake \\ F^N_\\text{uptake}}$ Plant N demand is the amount of N required to support plant growth. This is calculated as the sum of changes in plant N pools: $$ F^N_\\text{uptake}=\\frac{dN_\\text{plant}}{dt} = \\sum_{i} \\frac{dN_{\\text{plant,}i}}{dt} \\tag{20}\\label{eq:plant_n_demand} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ Each term in the sum is calculated according to equation \\eqref{eq:plant_n}. $\\frak{Nitrogen \\ Limitation \\ Indicator \\ Function \\mathfrak{I_{\\text{N limit}}}}$ What happens when plant N demand exceeds available N? This is N limitation, a challenging process to represent in biogeochemical models. The initial approach to representing N limitation in SIPNET will be simple, and the primary motivation for implementing this is to avoid mass imbalance. First we will identify the presence of nitrogen limitation with an indicator variable: $$ I_{\\text{N limit}} = \\begin{cases} 1, & \\text{if } \\frac{dN_\\text{plant}}{dt} \\leq N_{\\text{min}} \\ 0, & \\text{if } \\frac{dN_\\text{plant}}{dt} > N_{\\text{min}} \\end{cases} \\tag{21}\\label{eq:n_limit} $$ When $I=0$, SIPNET will throw a warning and increase autotrophic respiration to $R_A=GPP$ to stop plant growth and associated N uptake: $$ R_A = \\max(R_A, I_{\\text{N limit}} \\cdot GPP) \\tag{22}\\label{eq:n_limit_ra} $$ This will effectively stop plant growth and N uptake when there there is insufficient N. We do expect N limitation to occur, including in vineyards and woodlands, but we assume that effect of nitrogen limitation on plant growth will have a relatively smaller impact on GHG budgets at the county and state scales. This is because nitrogen limitation should be rare in California's intensively managed croplands because the cost of N fertilzer is low compared to the impact of N limitation on crop yield. If this scheme is too simple, we can adjust either the conditions under which N limitation occurs or develop an N dependency function based on the balance between plant N demand and N availability. Water Dynamics Soil Water Storage $$ \\begin{aligned} \\frac{dW_{\\text{soil}}}{dt} &= f_{\\text{intercept}} \\cdot \\Bigl( F^W_{\\text{precip}} + F^W_{\\text{canopy irrigation}} \\Bigr)\\[1mm] &\\quad + \\mathfrak{F^W_{\\text{soil irrigation}}} - F^W_{\\text{drainage}} - F^W_{\\text{transpiration}} \\end{aligned} \\tag{Braswell A4}\\label{eq:A4} $$ The change in soil water content $(W_{\\text{soil}})$ is determined by precipitation $F^W_{\\text{precip}}$ and losses due to drainage $F^W_{\\text{drainage}}$ and transpiration $F^W_{\\text{transpiration}}$. $F^W_{\\text{precip}}$ is the precipitation rate prescribed at each time step in the <sitename>.clim file and fraction of precipitation intercepted by the canopy $f_{\\text{intercept}}$. Drainage Under well-drained conditions, drainage occurs when soil water content $(W_{\\text{soil}})$ exceeds the soil water holding capacity $(W_{\\text{WHC}})$. Beyond this point, additional water drains off at a rate controlled by the drainage parameter $f_{\\text{drain}}$. For well drained soils, this $f_{\\text{drain}}=1$. Setting $f_{\\text{drain}}<1$ reduced the rate of drainage, and flooding will will require a combination of a low $f_{\\text{drain}}$ and sufficient size and / or frequency of $F^W_\\text{irrigation}$ to maintain flooded conditions. $$ F^W_{\\text{drainage}} = f_\\text{drain} \\cdot \\max(W_{\\text{soil}} - W_{\\text{WHC}}, 0) \\tag{23}\\label{eq:drainage} $$ This is adapted from the original SIPNET formulation (Braswell et al 2005), adding a new parameter that controls the drainage rate. Transpiration Water Use Efficiency (WUE) $$ \\text{WUE} = \\frac{K_{\\text{WUE}}}{\\text{VPD}} \\tag{Braswell A13}\\label{eq:A13} $$ Water Use Efficiency (WUE) is defined as the ratio of a constant $K_{\\text{WUE}}$ to the vapor pressure deficit (VPD). Potential Transpiration $$ T_{\\text{pot}} = \\frac{\\text{GPP}_{\\text{pot}}}{\\text{WUE}} \\tag{Braswell A14}\\label{eq:A14} $$ Potential transpiration $(T_{\\text{pot}})$ is calculated as the potential gross primary production $(\\text{GPP}_{\\text{pot}})$ divided by WUE. Actual Transpiration $$ F^W_\\text{trans} = \\min(F^W_\\text{trans, pot}, f \\cdot W_\\text{soil}) \\tag{Braswell A15}\\label{eq:A15} $$ Actual transpiration $(F^W_\\text{trans})$ is the minimum of potential transpiration $(F^W_{\\text{pot}})$ and the fraction $(f)$ of the total soil water $(W_\\text{soil})$ that is removable in one day. Dependence Functions for Temperature and Moisture Metabolic processes including photosynthesis, autotrophic and heterotrophic respiration, decomposition, nitrogen volatilization, and methanogenesis are modified directly by temperature, soil moisture, and / or vapor pressure deficit. Below is a description of these functions. Temperature Dependence Functions $D_\\text{temp}$ Parabolic Function for Photosynthesis $D_\\text{temp, A}$ Photosynthesis has a temperature optimum in the range of observed air temperatures as well as maximum and minimum temperatures of photosynthesis $(A)$. SIPNET represents the temperature dependence of photosynthesis as a parabolic function. This function has a maximum at the temperature optimum, and decreases as temperature moves away from the optimum. $$ D_\\text{temp,A}=\\max\\left(\\frac{(T_\\text{max} - T_\\text{air})(T_\\text{air} - T_\\text{min})}{\\left(\\frac{T_\\text{max} - T_\\text{min}}{2}\\right)^2}, 0\\right) \\tag{Braswell A9}\\label{eq:A9} $$ Where $T_{\\text{env}}$ may be soil or air temperature $(T_\\text{soil}$ or $T_\\text{air})$. Becuase the function is symmetric around $T_\\text{opt}$, the parameters $T_{\\text{min}}$ and $T_{\\text{opt}}$ are provided and $T_{\\text{max}}$ is calculated internally as $T_{\\text{max}} = 2 \\cdot T_{\\text{opt}} - T_{\\text{min}}$. Exponential Function for Respiration $D_{\\text(temp,Q10)}$ The temperature response of autotrophic $(R_a)$ and heterotrophic $(R_H)$ respiration represented as an exponential relationship using a simplified Arrhenius function. $$ D_{\\text{temp,Q10}} = Q_{10}^{\\frac{(T-T_\\text{opt})}{10}} \\tag{Braswell A18b}\\label{eq:A18b} % Defined as part of eq A18 $$ The exponential function is a simplification of the Arrhenius function in which $Q_{10}$ is the temperature sensitivity parameter, $T$ is the temperature, and $T_{\\text{opt}}$ is the optimal temperature for the process set to 0 for wood and soil respiration. (Note that this is part of the equation for leaf respiration in Braswell et al. (2005). We assume $T=T_\\text{air}$ for leaf and wood respiration, and $T=T_\\text{soil}$ for soil and root respiration. The optimal temperature for leaf respiration is the optimal temperature for photosynthesis, $T_{\\text{opt}}=T_{\\text{opt,A}}$, while $T_{\\text{opt}}=0$ for wood, root, and soil respiration. This function provides two ways to reduce the number of parameters in the model. Braswell et al (2005) used two $Q_{10}$ values, one for $R_A$ and one for $R_H$ and these calibrated to the same value of 1.7. By contrast, Zobitz et al (2008) used four $Q_{10}$ values, one for both leaf and wood, and one each for coarse root, fine root, and soil. Notably, these four $Q_{10}$ values ranged from 1.4 to 5.8 when SIPNET was calibrated to $CO_2$ fluxes in a subalpine forest. Moisture dependence functions $D_{water}$ Moisture dependence functions are typically based on soil water content as a fraction of water holding capacity, also referred to as soil moisture or fractional soil wetness. We will represent this fraction of soil wetness as $f_\\text{WHC}$. Soil Water Content Fraction $$ f_{\\text{WHC}} = \\frac{W_{\\text{soil}}}{W_{\\text{WHC}}} $$ Where $W_{\\text{soil}}$: Soil water content $W_{\\text{WHC}}$: Soil water holding capacity Water Stress Factor $$ D_{\\text{water,}A} = \\frac{F^W_{\\text{trans}}}{F^W_{\\text{trans, pot}}} \\tag{Braswell A16} \\label{eq:A16} $$ The water stress factor $(D_{\\text{water,}A})$ is the ratio of actual transpiration $(F^W_\\text{trans})$ to potential transpiration $(F^W_\\text{trans, pot})$. Soil Respiration Moisture Dependence $(D_{\\text{water,}R_H})$ The moisture dependence of heterotrophic respiration is a linear function of soil water content when soil temperature is above freezing: $$ D_{\\text{water} R_H} = \\begin{cases} 1, & \\text{if } T_{\\text{soil}} \\leq 0 \\ f_{\\text{WHC}} & \\text{if } T_{\\text{soil}} > 0 \\end{cases} \\tag{24}\\label{eq:water_rh} $$ $\\frak{Moisture \\ Dependence \\ For \\ Anaerobic \\ Metabolism \\ with \\ Soil \\ Moisture \\ Optimum}$ There are many possible functions for the moisture dependence of anaerobic metabolism. The key feature is that there must be an optimum moisture level. Lets start with a two-parameter Beta function covering the range $50 < f_{\\text{WHC}} < 120$. Beta function $$ D_{\\mathrm{moistur,O_2}} = (f_{WHC} - f_{WHC_\\text{min}})^\\beta \\cdot (f_{WHC_\\text{max}} - f_{WHC})^\\gamma $$ Where $\\beta$ and $\\gamma$ are parameters that control the shape of the curve, and can be estimated for a particular maiximum and width. For the relationship between $N_2O$ flux and soil moisture, Wang et al (2023) suggest a Gaussian function. $\\frak{Agronomic \\ Management \\ Events}$ All management events are specified in the events.in . Each event is a separate record that includes the date of the event, the type of event, and associated parameters. $\\frak{Fertilizer \\ and \\ Organic \\ Matter \\ Additions}$ Additions of Mineral N, Organic N, and Organic C are represented by the fluxes $F^N_{\\text{fert,min}}$, $F^N_{\\text{fert,org}},$ and $F^C_{\\text{fert,org}}$ that are specified in the events.in configuration file. Event parameters specified in the events.in file: Organic N added $(F^N_{\\text{fert,org}})$ Organic C added $(F^C_{\\text{fert,org}})$ Mineral N added $(F^N_{\\text{fert,min}})$ These are added to the litter C and N and mineral N pools, respectively. Mineral N includes fertilizer supplied as NO3, NH4, and Urea-N. Urea-N is assumed to hydrolyze to ammonium and bicarbonate rapidly and is treated as a mineral N pool. This is a common assumption because of the high rate of this conversion, and is consistent the DayCent formulation (Parton et al TK-ref, other models and refs?). Only relatively recently did DayCent explicitly model Urea-N to NH4 in order to represent the impact of urease inhibitors (Gurung et al 2021) that slow down the rate. $\\frak{Tillage}$ To represent tillage, we define two new adjustment factors that modify the decomposition rates of litter $K_{\\text{litter}}$ and soil organic matter $K_{\\text{som}}$: Event parameters from the events.in file: SOM decomposition modifier $D_{K\\text{,tillage,litter}}$ Litter decomposition modifier $D_{K\\text{,tillage,som}}$ These values specified as fractions (e.g. 0.2 for 20% increase in decomposition rate). They are set to 0 by default and are expected to be >0. They are set in the events.in , and are effective for one month after the tillage event. $$ K^{\\prime} {\\text{i}} = K {\\text{i}} \\cdot (1+D_{K\\text{,tillage,}i}) $$ Where $i$ is either litter or soil organic matter pool, and $K^{\\prime}$ is the transiently adjusted decomposition rate. The choice of one month adjustment period is based on DayCent (Parton et al 2001). $\\frak{Planting \\ and \\ Emergence}$ A planting event is defined by its emergence date and directly specifies the amount of carbon added to each of four plant carbon pools: leaf, wood, fine root, and coarse root. On the emergence date, the model initializes the plant pools with the amounts of carbon specified in the events file. Following carbon addition, nitrogen for each pool is computed using the corresponding C:N stoichiometric ratios following equation \\eqref{eq:cn_stoich}. $\\frak{Harvest}$ A harvest event is specified by its date, the event type \"harv\", and the fractions of above and belowground carbon that is either transferred to litter or removed from the system. Because a harvest event only specifies the fraction of above and belowground carbon that is removed or transferred to litter, assume that the above terms apply to leaf + wood, and below applies to fine root + coarse root. The removed fraction is calculated as follows: $$ F^C_{\\text{harvest,removed}} = f_{\\text{remove,above}} \\cdot C_{\\text{above}} + f_{\\text{remove,below}} \\cdot C_{\\text{below}} $$ The fraction transferred to litter is calculated as follows: $$ F^C_{\\text{harvest,litter}} = f_{\\text{transfer,above}} \\cdot C_{\\text{leaf}} + f_{\\text{transfer,below}} \\cdot C_{\\text{root}} \\tag{28}\\label{eq:harvest} $$ This amount is then added to the litter flux in equation \\eqref{eq:litter_flux}. $\\frak{Irrigation}$ Event parameters: Irrigation rate $(F^W_{\\text{irrigation}})$, cm/day Irrigation type indicator $(I_{\\text{irrigation}})$: Canopy irrigation (0): Water applied to the canopy, simulating rainfall. Soil irrigation (1): Water directly added to the soil. Canopy irrigation is simulated in the same way as precipitation, where a fraction of irrigation is intercepted and evaporated, and the remainder is added to the soil water pool. Soil irrigation adds water directly to the soil pool without interception. Flooded furrow irrigation' is a special case of soil irrigation, with a high rate of irrigation. References Braswell, Bobby H., William J. Sacks, Ernst Linder, and David S. Schimel. 2005. Estimating Diurnal to Annual Ecosystem Parameters by Synthesis of a Carbon Flux Model with Eddy Covariance Net Ecosystem Exchange Observations. Global Change Biology 11 (2): 335\u201355. https://doi.org/10.1111/j.1365-2486.2005.00897.x. Libohova, Z., Seybold, C., Wysocki, D., Wills, S., Schoeneberger, P., Williams, C., Lindbo, D., Stott, D. and Owens, P.R., 2018. Reevaluating the effects of soil organic matter and other properties on available water-holding capacity using the National Cooperative Soil Survey Characterization Database. Journal of soil and water conservation, 73(4), pp.411-421. Manzoni, Stefano, and Amilcare Porporato. 2009. Soil Carbon and Nitrogen Mineralization: Theory and Models across Scales. Soil Biology and Biochemistry 41 (7): 1355\u201379. https://doi.org/10.1016/j.soilbio.2009.02.031. Parton, W. J., E. A. Holland, S. J. Del Grosso, M. D. Hartman, R. E. Martin, A. R. Mosier, D. S. Ojima, and D. S. Schimel. 2001. Generalized Model for NOx and N2O Emissions from Soils. Journal of Geophysical Research: Atmospheres 106 (D15): 17403\u201319. https://doi.org/10.1029/2001JD900101. Wang H, Yan Z, Ju X, Song X, Zhang J, Li S and Zhu-Barker X (2023) Quantifying nitrous oxide production rates from nitrification and denitrification under various moisture conditions in agricultural soils: Laboratory study and literature synthesis. Front. Microbiol. 13:1110151. doi: 10.3389/fmicb.2022.1110151 Zobitz, J. M., D. J. P. Moore, W. J. Sacks, R. K. Monson, D. R. Bowling, and D. S. Schimel. 2008. \u201cIntegration of Process-Based Soil Respiration Models with Whole-Ecosystem CO2 Measurements.\u201d Ecosystems 11 (2): 250\u201369. https://doi.org/10.1007/s10021-007-9120-1.","title":"Model structure"},{"location":"model-structure/#model-structure","text":"Goal: simplified biogeochemical model that is capable of simulating GHG balance, including soil carbon, $CO_2$, $CH_4$, and $N_2O$ flux. Key validation criteria is the ability to correctly capture the response of these pools and fluxes to changes in agronomic management practices, both current and future.","title":"Model Structure"},{"location":"model-structure/#design-approach","text":"Start as simple as possible, add complexity as needed. When new features are considered, they should be evaluated alongside other possible model improvements that have been considered, and the overall list of project needs.","title":"Design approach:"},{"location":"model-structure/#notes-on-notation","text":"Fluxes are denoted by $F$, except that respiration is denoted by $R$ following convention and previous descriptions of SIPNET. Parameters and other information can be found in the Parameters documentation.","title":"Notes on notation:"},{"location":"model-structure/#scope","text":"This document provides an overview of the SIPNET model\u2019s structure. It was written to - Consolidate the descriptions from multiple papers (notably Braswell et al 2005 and Zobitz et al 2008). - Provide enough detail to support the addition of agronomic events, CH4, and N2O fluxes. - Focus on features currently in regular use. There are multiple ways to configure the model structure, and not all model structures are listed, notably the litter quality model. We aim to extend the scope of this document to be more comprehensive of the regularly used features.","title":"Scope"},{"location":"model-structure/#mathfrakproposed-features","text":"Proposed features are indicated using the using $\\mathfrak{Fraktur Font}$. Where an entire section is new, it is only used in the section heading. Otherwise, it is used for terms within equations. As these features are implemented, the \\mathfrak{} commands should be removed.","title":"$\\mathfrak{Proposed \\ Features}$"},{"location":"model-structure/#carbon-dynamics","text":"","title":"Carbon Dynamics"},{"location":"model-structure/#maximum-photosynthetic-rate","text":"$$ \\text{GPP} {\\text{max}} = A {\\text{max}} \\cdot A_d + R_{leaf,0} \\tag{Braswell A6}\\label{eq:A6} $$ The daily maximum gross photosynthetic rate $(\\text{GPP} {\\text{max}})$ represents the maximum potential GPP under optimal conditions. It is modeled as the leaf-level maximum net assimilation rate $(A {\\text{max}})$ multiplied by a scaling factor $(A_d)$, plus foliar maintenance respiration at optimum temperature $(R_{\\text{leaf},0})$. The scaling factor $A_d$ accounts for daily variation in photosynthesis, representing the average fraction of $A_{\\text{max}}$ that is realized over the course of a day.","title":"Maximum Photosynthetic Rate"},{"location":"model-structure/#potential-photosynthesis","text":"$$ \\text{GPP} {\\text{pot}} = \\text{GPP} {\\text{max}} \\cdot D_{\\text{temp}} \\cdot D_{\\text{VPD}} \\cdot D_{\\text{light}} \\tag{Braswell A7}\\label{eq:A7} $$ The potential gross primary production $(\\text{GPP} {\\text{pot}})$ is calculated by reducing $\\text{GPP} {\\text{max}}$ by temperature, vapor pressure deficit, and light.","title":"Potential Photosynthesis"},{"location":"model-structure/#adjusted-gross-primary-production","text":"$$ \\text{GPP} = \\text{GPP} {\\text{pot}} \\cdot D {\\text{water}} \\tag{Braswell A17}\\label{eq:A17} $$ The total adjusted gross primary production (GPP) is the product of potential GPP $(\\text{GPP} {\\text{pot}})$ and the water stress factor $D {\\text{water,}A}$. The water stress factor $D_{\\text{water,}A}$ is defined in equation \\eqref{eq:A16} as the ratio of actual to potential transpiration, and therefore couples GPP to transpiration by reducing GPP.","title":"Adjusted Gross Primary Production"},{"location":"model-structure/#plant-growth","text":"$$ \\text{NPP} = \\text{GPP} - R_A \\tag{1} \\label{eq:npp} $$ Net primary productivity $(\\text{NPP})$ is the total carbon gain of plant biomass. NPP is allocated to plant biomass pools in proportion to their allocation parameters $\\alpha_i$. $$ \\text{NPP}=\\sum_{1}^{i} \\frac{dC_{\\text{plant,}i}}{dt} \\tag{2} \\label{eq:npp_summ} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ Note that $\\alpha_i$ are specified input parameters and $\\sum_i{\\alpha_i} = 1$. $$ dC_{\\text{plant,}i} = \\text{NPP} \\cdot a_i \\mathfrak{- F^C_{\\text{harvest,removed,}i}} - F^C_{\\text{litter,}i} \\tag{Zobitz 3}\\label{eq:Z3} $$ This results in the following constraints: - In the case of annuals, all biomass is either harvested and removed or added to litter pools. $F^C_{\\text{harvest,removed,}i}$ is calculated by \\eqref{eq:harvest}. - In the case of perennials, a fraction of the biomass remains except at the end of the perennial's life. $$\\mathfrak{ F^C_{\\text{litter,}i} + F^C_{\\text{harvest,removed,}i} = \\begin{cases} 1 & \\text{annuals} \\ \\leq 1 & \\text{perennials} \\end{cases} }$$","title":"Plant Growth"},{"location":"model-structure/#plant-death","text":"Plant death is implemented as a harvest event with the fraction of biomass transferred to litter, $f_{\\text{harvest,transfer,}i}$ set to 1.","title":"Plant Death"},{"location":"model-structure/#wood-carbon","text":"$$ \\frac{dC_\\text{wood}}{dt} = \\alpha_\\text{wood}\\cdot\\text{NPP} - F^C_\\text{litter,wood} \\tag{Braswell A1}\\label{eq:A1} $$ Change in plant wood carbon $(C_W)$ over time is determined by the fraction of net primary productivity allocated to wood, and wood litter production $(F^C_\\text{litter,wood})$.","title":"Wood Carbon"},{"location":"model-structure/#leaf-carbon","text":"$$ \\frac{dC_\\text{leaf}}{dt} = L - F^C_\\text{litter,leaf} \\tag{Braswell A2}\\label{eq:A2} $$ The change in plant leaf carbon $(C_\\text{leaf})$ over time is given by the balance of leaf production $(L)$ and leaf litter production $(F^C_\\text{litter,leaf})$.","title":"Leaf Carbon"},{"location":"model-structure/#leaf-maintenance-respiration","text":"$$ R_\\text{leaf,opt} = k_\\text{leaf} \\cdot A_{\\text{max}} \\cdot C_\\text{leaf} \\tag{Braswell A5}\\label{eq:A5} $$ Where $R_\\text{leaf,opt}$ is leaf maintenance respiration at $T_\\text{opt}$, proportional to the maximum photosynthetic rate $A_{\\text{max}}$ with a scaling factor $k_\\text{leaf}$ multiplied by the mass of leaf $C_\\text{leaf}$. $$ R_\\text{leaf} = R_\\text{leaf,opt} \\cdot D_{\\text{temp,Q10}} \\tag{Braswell A18a}\\label{eq:A18a} $$ Actual foliar respiration $(R_\\text{leaf})$ is modeled as a function of the foliar respiration rate $(R_\\text{leaf,opt})$ at optimum temperature of leaf respiration $T_\\text{opt}$ and the $Q_{10}$ temperature sensitivity factor.","title":"Leaf Maintenance Respiration"},{"location":"model-structure/#wood-maintenance-respiration","text":"$$ R_\\text{wood} = K_\\text{wood} \\cdot C_\\text{wood} \\cdot D_{\\text{temp,Q10}_v} \\tag{Braswell A19}\\label{eq:A19} $$ Wood maintenance respiration $(R_m)$ depends on the wood carbon content $(C_\\text{wood})$, a scaling constant $(k_\\text{wood})$, and the temperature sensitivity scaling function $D_{\\text{temp,Q10}_v}$.","title":"Wood Maintenance Respiration"},{"location":"model-structure/#litter-carbon","text":"The change in the litter carbon pool over time is defined by the input of new litter and the loss to decomposition: $$ \\frac{dC_\\text{litter}}{dt} = F^C_\\text{litter} - F^C_{\\text{decomp}} $$ Where $F^C_\\text{litter}$ is the carbon flux from plant biomass into the litter pool through senescence and harvest \\eqref{eq:litter_flux}. $F^C_{\\text{decomp,litter}}$ is the total carbon flux lost from the litter pool due to decomposition and includes both transfer and decomposition \\eqref{eq:decomp_carbon}. The flux of carbon from the plant to the litter pool is the sum litter produced through senescence, transfer of any biomass pools during harvest, and organic matter ammendments: $$ F^C_\\text{litter} = \\sum_{i} K_{\\text{plant,}i} \\cdot C_{\\text{plant,}i} + \\mathfrak{ \\sum_{i} F^C_{\\text{harvest,transfer,}i} + F^C_\\text{fert,org} } \\tag{3}\\label{eq:litter_flux} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ Where $K$ is the turnover rate of plant pool $i$ that controls the rate at which plant biomass is transferred to litter. The decomposition flux from litter carbon is divided into heterotrophic respiration and carbon transfer to soil: $$ F^C_{\\text{decomp}} = R_{H,\\text{litter}} + F^C_{\\text{soil}} \\tag{4}\\label{eq:decomp_carbon} $$ Where $R_{H_{\\text{litter}}}$ is heterotrophic respiration from litter \\eqref{eq:rh_litter}, and $F^C_{\\text{soil}}$ is the carbon transfer from the litter pool to the soil \\eqref{eq:soil_carbon}. This partitioning is based on the fraction of litter that is respired, $f_{R_H}$. $$ R_{H_{\\text{litter}}} = f_{R_H} \\cdot K_\\text{litter} \\cdot C_\\text{litter} \\cdot D_{\\text{temp}} \\cdot D_{\\text{water}R_H} \\tag{5}\\label{eq:rh_litter} $$ $$ F^C_{\\text{soil}} = (1 - f_{R_H}) \\cdot K_\\text{litter} \\cdot C_\\text{litter} \\cdot D_{\\text{temp}} \\cdot D_{\\text{water}R_H} \\tag{6}\\label{eq:soil_carbon} $$ The rate of decomposition is a function of the litter carbon content and the decomposition rate $K_{\\text{litter}}$ modified by temperature and moisture factors. $f_{R_H}$ is the fraction of litter carbon that is respired.","title":"Litter Carbon"},{"location":"model-structure/#soil-carbon","text":"$$ \\frac{dC_\\text{soil}}{dt} = F^C_\\text{soil} - R_{H_\\text{soil}} \\tag{Braswell A3}\\label{eq:A3} $$ The change in the SOC pool over time $\\frac{dC_\\text{soil}}{dt}$ is determined by the addition of litter carbon and the loss of carbon to heterotrophic respiration. This model assumes no loss of SOC to leaching or erosion.","title":"Soil Carbon"},{"location":"model-structure/#heterotrophic-respiration-c_textsoillitter-rightarrow-co_2","text":"Total heterotrophic respiration is the sum of respiration from soil and litter pools: $$ R_{H} = f_{R_H} \\cdot \\left(\\sum_j K_j \\cdot C_j \\mathfrak{\\cdot D_{\\text{tillage,}j}} \\right) \\cdot D_{\\text{temp}} \\cdot D_{\\text{water,}R_H} \\cdot D_{CN} \\tag{7}\\label{eq:rh} $$ $$\\small j \\in {\\text{soil, litter}}$$ Where heterotrophic respiration, $R_H$, is a function of each carbon pool $C_j$ and its associated decomposition rate $K_{C_j}$ adjusted by the fraction allocated to respiration, $f_{R_H}$, and the temperature, moisture, tillage, and CN dependency $(D_\\star)$ functions.","title":"Heterotrophic Respiration $(C_\\text{soil,litter} \\rightarrow CO_2)$"},{"location":"model-structure/#frakmethane-production-c-rightarrow-ch_4","text":"$$ F^C_\\mathit{CH_4} = \\left(\\sum_{j} K_{CH_4,j} \\cdot C_\\text{j}\\right) \\cdot D_\\mathrm{water, O_2} \\cdot D_\\text{temp} \\tag{8}\\label{eq:ch4} $$ $$\\small j \\in {\\text{soil, litter}}$$ The calculation of methane flux $(F^C_{CH_4})$ is analagous to to that of $R_H$. It uses the same carbon pools as substrate and temperature dependence but has specific rate parameters $(K_{\\mathit{CH_4,}j})$, a moisture dependence function based on oxygen availability, and no direct dependence on tillage.","title":"$\\frak{Methane \\ Production \\ (C \\rightarrow CH_4)}$"},{"location":"model-structure/#frakcarbonnitrogen-ratio-dynamics-cn","text":"The carbon and nitrogen cycle are tightly coupled by the C:N ratios of plant and organic matter pools. The C:N ratio of plant biomass pools is fixed, while the C:N ratio of soil organic matter and litter pools is dynamic.","title":"$\\frak{Carbon:Nitrogen \\ Ratio \\ Dynamics (CN)}$"},{"location":"model-structure/#frakfixed-plant-cn-ratios","text":"Plant biomass pools have a fixed CN ratio and are thus stoichiometrically coupled to carbon: $$ N_i = \\frac{C_i}{CN_{i}} \\tag{9}\\label{eq:cn_stoich} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ Where $i$ is the leaf, wood, fine root, or coarse root pool. This relationship applies to both pools $C,N$ and fluxes $(F^C, F^N)$. Soil organic matter and litter pools have dynamic CN that is determined below.","title":"$\\frak{Fixed \\ Plant \\ C:N \\ Ratios}$"},{"location":"model-structure/#frakdynamic-soil-organic-matter-and-litter-cn-ratios","text":"The change in the soil C:N ratio over time of soil and litter pools depends on the rate of change of carbon and nitrogen in the pool, normalized by the total nitrogen in the pool. This makes sense as it captures how changes in carbon and nitrogen affect their ratio. $$ \\frac{dCN_{\\text{j}}}{dt} = \\frac{1}{N_{\\text{j}}} \\left( \\frac{dC_{\\text{j}}}{dt} - CN_{\\text{j}} \\cdot \\frac{dN_{\\text{j}}}{dt} \\right) \\tag{10}\\label{eq:cn} $$ $$\\small j \\in {\\text{soil, litter}}$$","title":"$\\frak{Dynamic \\ Soil \\ Organic \\ Matter \\ and \\ Litter \\ C:N \\ Ratios}$"},{"location":"model-structure/#frakcn-dependency-function-d_cn","text":"To represent the influence of substrate quality on decomposition rate, we add a simple dependence function $D_{CN}$. $$ D_{CN} = \\frac{1}{1+k_CN \\cdot CN} \\tag{11}\\label{eq:cn_dep} $$ Where $k_CN$ is a scaling parameter that controls the sensitivity of decomposition rate to C:N ratio. This parameter represents the half-saturation constant of the Michaelis-Menten equation.","title":"$\\frak{C:N \\ Dependency \\ Function \\ (D_{CN})}$"},{"location":"model-structure/#fraknitrogen-dynamics-fracdndt","text":"","title":"$\\frak{Nitrogen \\ Dynamics (\\frac{dN}{dt})}$"},{"location":"model-structure/#frakplant-biomass-nitrogen","text":"Similar to the stoichiometric coupling of litter fluxes, the change in plant biomass N over time is stoichiometrically coupled to plant biomass C: $$ \\frac{dN_{\\text{plant,}i}}{dt} = \\frac{dC_{\\text{plant,}i}}{dt} / CN_{\\text{plant,}i} \\tag{12}\\label{eq:plant_n} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$","title":"$\\frak{Plant \\ Biomass \\ Nitrogen}$"},{"location":"model-structure/#fraklitter-nitrogen","text":"The change in litter nitrogen over time, $N_\\text{litter}$ is determined by inputs including leaf and wood litter, nitrogen in organic matter amendments, and losses to mineralization: $$ \\frac{dN_{\\text{litter}}}{dt} = \\sum_{i} F^N_{\\text{litter,}i} + F^N_\\text{fert,org} - F^N_\\text{litter,min} \\tag{13}\\label{eq:litter_dndt} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ The flux of nitrogen from living biomass to the litter pool is proportional to the carbon content of the biomass, based on the C:N ratio of the biomass pool \\eqref{eq:cn_stoich}. Similarly, nitrogen from organic matter amendments is calculated from the carbon content and the C:N ratio of the inputs.","title":"$\\frak{Litter \\ Nitrogen}$"},{"location":"model-structure/#fraksoil-organic-nitrogen","text":"$$ \\frac{dN_\\text{org,soil}}{dt} = F^N_\\text{litter} - F^N_\\text{soil,min} \\tag{14}\\label{eq:org_soil_dndt} $$ The change in nitrogen pools in this model is proportional to the ratio of carbon to nitrogen in the pool. Equations for the evolution of soil and litter CN are below.","title":"$\\frak{Soil \\ Organic \\ Nitrogen}$"},{"location":"model-structure/#fraksoil-mineral-nitrogen-fn_textmin","text":"Change in the mineral nitrogen pool over time is determined by inputs from mineralization and fertilization, and losses to volatilization, leaching, and plant uptake: $$ \\frac{dN_\\text{min}}{{dt}} = F^N_\\text{litter,min} + F^N_\\text{soil,min} + F^N_\\text{fix} - F^N_\\text{fert,min} - F^N_\\mathrm{vol} - F^N_\\text{leach} - F^N_\\text{uptake} \\tag{15}\\label{eq:mineral_n_dndt} $$ Mineralization, fertilization, and fixation add to the mineral nitrogen pool. Losses include mineralization, volatilization, leaching, and plant uptake, described below:","title":"$\\frak{Soil \\ Mineral \\ Nitrogen \\ F^N_\\text{min}}$"},{"location":"model-structure/#frakn-mineralization-fn_textmin","text":"Total nitrogen mineralization is proportional to the total heterotrophic respiration from soil and litter pools, divided by the C:N ratio of the pool. The effects of temperature, moisture, tillage, and C:N ratio on mineralization rate are captured in the calculation of $R_\\text{H}$. $$ F^N_\\text{min} = \\sum_j \\left( \\frac{R_{H\\text{j}}}{CN_{\\text{j}}} \\right) \\tag{16}\\label{eq:n_min} $$ $$\\small j \\in {\\text{soil, litter}}$$","title":"$\\frak{N \\ Mineralization \\ (F^N_\\text{min})}$"},{"location":"model-structure/#fraknitrogen-volatilization-fn_textvol-n_textminsoil-rightarrow-n_2o","text":"The simplest way to represent $N_2O$ flux is as a proportion of the mineral N pool $N_\\text{min}$ or the N mineralization rate $F^N_{min}$. For example, CLM-CN and CLM 4.0 represent $N_2O$ flux as a proportion of $N_\\text{min}$ (Thornton et al 2007, TK-ref CLM 4.0). By contrast, Biome-BGC (Golinkoff et al 2010; Thornton and Rosenbloom, 2005 and https://github.com/bpbond/Biome-BGC, Golinkoff et al 2010; Thornton and Rosenbloom, 2005) represents $N_2O$ flux as a proportion of the N mineralization rate. Because we expect $N_2O$ emissions will be dominated by fertilizer N inputs, we will start with the $N_\\text{min}$ pool size approach. This approach also has the advantage of accounting for reduced $N_2O$ flux when N is limiting (Zahele and Dalmorech 2011). A new fixed parameter $K_\\text{vol}$ will represent the proportion of $N_\\text{min}$ that is volatilized as $N_2O$. $$ F^N_\\mathrm{N_2O vol} = K_\\text{vol} \\cdot N_\\text{min} \\cdot D_{\\text{temp}} \\cdot D_{\\text{water}R_H} \\tag{17}\\label{eq:n2o_vol} $$","title":"$\\frak{Nitrogen \\ Volatilization \\ F^N_\\text{vol}: (N_\\text{min,soil} \\rightarrow N_2O)}$"},{"location":"model-structure/#fraknitrogen-leaching-fn_textleach","text":"$$ F^N_\\text{leach} = N_\\text{min} \\cdot F^W_{drainage} \\cdot f_{N leach} \\tag{18}\\label{eq:n_leach} $$ Where $F^N_\\text{leach}$ is the fraction of $N_{min}$ in soil water that is available to be leached, $F^W_{drainage}$ is drainage.","title":"$\\frak{Nitrogen \\ Leaching \\ F^N_\\text{leach}}$"},{"location":"model-structure/#fraknitrogen-fixation-fn_textfix","text":"The rate at which N is fixed is a function of the NPP of the plant and a fixed parameter $K_\\text{fix}$, and is modified by temperature. For nitrogen fixing plants, rates of symbiotic nitrogen fixation are assumed to be driven by plant growth, and also depend on temperature. $$ F^N_\\text{fix} = K_\\text{fix} \\cdot NPP \\cdot D_{\\text{temp}} \\tag{19}\\label{eq:n_fix} $$ Nitrogen fixation is represented by adding fixed nitrogen directly to the soil mineral nitrogen pool. This is a reasonable first approximation, consistent with the simplicity of the nitrogen limitation model where limitation only occurs when nitrogen demand exceeds supply. For nitrogen-fixing plants, most of the fixed nitrogen is directly used by the plant. It would be more complicated to model this by splitting, which could include splitting the fixed N into soil and plant pools and then meeting a portion of plant N demand with this flux.","title":"$\\frak{Nitrogen \\ Fixation \\ F^N_\\text{fix}}$"},{"location":"model-structure/#frakplant-nitrogen-uptake-fn_textuptake","text":"Plant N demand is the amount of N required to support plant growth. This is calculated as the sum of changes in plant N pools: $$ F^N_\\text{uptake}=\\frac{dN_\\text{plant}}{dt} = \\sum_{i} \\frac{dN_{\\text{plant,}i}}{dt} \\tag{20}\\label{eq:plant_n_demand} $$ $$\\small i \\in {\\text{leaf, wood, fine root, coarse root}}$$ Each term in the sum is calculated according to equation \\eqref{eq:plant_n}.","title":"$\\frak{Plant \\ Nitrogen \\ Uptake \\ F^N_\\text{uptake}}$"},{"location":"model-structure/#fraknitrogen-limitation-indicator-function-mathfraki_textn-limit","text":"What happens when plant N demand exceeds available N? This is N limitation, a challenging process to represent in biogeochemical models. The initial approach to representing N limitation in SIPNET will be simple, and the primary motivation for implementing this is to avoid mass imbalance. First we will identify the presence of nitrogen limitation with an indicator variable: $$ I_{\\text{N limit}} = \\begin{cases} 1, & \\text{if } \\frac{dN_\\text{plant}}{dt} \\leq N_{\\text{min}} \\ 0, & \\text{if } \\frac{dN_\\text{plant}}{dt} > N_{\\text{min}} \\end{cases} \\tag{21}\\label{eq:n_limit} $$ When $I=0$, SIPNET will throw a warning and increase autotrophic respiration to $R_A=GPP$ to stop plant growth and associated N uptake: $$ R_A = \\max(R_A, I_{\\text{N limit}} \\cdot GPP) \\tag{22}\\label{eq:n_limit_ra} $$ This will effectively stop plant growth and N uptake when there there is insufficient N. We do expect N limitation to occur, including in vineyards and woodlands, but we assume that effect of nitrogen limitation on plant growth will have a relatively smaller impact on GHG budgets at the county and state scales. This is because nitrogen limitation should be rare in California's intensively managed croplands because the cost of N fertilzer is low compared to the impact of N limitation on crop yield. If this scheme is too simple, we can adjust either the conditions under which N limitation occurs or develop an N dependency function based on the balance between plant N demand and N availability.","title":"$\\frak{Nitrogen \\ Limitation \\ Indicator \\ Function \\mathfrak{I_{\\text{N limit}}}}$"},{"location":"model-structure/#water-dynamics","text":"","title":"Water Dynamics"},{"location":"model-structure/#soil-water-storage","text":"$$ \\begin{aligned} \\frac{dW_{\\text{soil}}}{dt} &= f_{\\text{intercept}} \\cdot \\Bigl( F^W_{\\text{precip}} + F^W_{\\text{canopy irrigation}} \\Bigr)\\[1mm] &\\quad + \\mathfrak{F^W_{\\text{soil irrigation}}} - F^W_{\\text{drainage}} - F^W_{\\text{transpiration}} \\end{aligned} \\tag{Braswell A4}\\label{eq:A4} $$ The change in soil water content $(W_{\\text{soil}})$ is determined by precipitation $F^W_{\\text{precip}}$ and losses due to drainage $F^W_{\\text{drainage}}$ and transpiration $F^W_{\\text{transpiration}}$. $F^W_{\\text{precip}}$ is the precipitation rate prescribed at each time step in the <sitename>.clim file and fraction of precipitation intercepted by the canopy $f_{\\text{intercept}}$.","title":"Soil Water Storage"},{"location":"model-structure/#drainage","text":"Under well-drained conditions, drainage occurs when soil water content $(W_{\\text{soil}})$ exceeds the soil water holding capacity $(W_{\\text{WHC}})$. Beyond this point, additional water drains off at a rate controlled by the drainage parameter $f_{\\text{drain}}$. For well drained soils, this $f_{\\text{drain}}=1$. Setting $f_{\\text{drain}}<1$ reduced the rate of drainage, and flooding will will require a combination of a low $f_{\\text{drain}}$ and sufficient size and / or frequency of $F^W_\\text{irrigation}$ to maintain flooded conditions. $$ F^W_{\\text{drainage}} = f_\\text{drain} \\cdot \\max(W_{\\text{soil}} - W_{\\text{WHC}}, 0) \\tag{23}\\label{eq:drainage} $$ This is adapted from the original SIPNET formulation (Braswell et al 2005), adding a new parameter that controls the drainage rate.","title":"Drainage"},{"location":"model-structure/#transpiration","text":"","title":"Transpiration"},{"location":"model-structure/#water-use-efficiency-wue","text":"$$ \\text{WUE} = \\frac{K_{\\text{WUE}}}{\\text{VPD}} \\tag{Braswell A13}\\label{eq:A13} $$ Water Use Efficiency (WUE) is defined as the ratio of a constant $K_{\\text{WUE}}$ to the vapor pressure deficit (VPD).","title":"Water Use Efficiency (WUE)"},{"location":"model-structure/#potential-transpiration","text":"$$ T_{\\text{pot}} = \\frac{\\text{GPP}_{\\text{pot}}}{\\text{WUE}} \\tag{Braswell A14}\\label{eq:A14} $$ Potential transpiration $(T_{\\text{pot}})$ is calculated as the potential gross primary production $(\\text{GPP}_{\\text{pot}})$ divided by WUE.","title":"Potential Transpiration"},{"location":"model-structure/#actual-transpiration","text":"$$ F^W_\\text{trans} = \\min(F^W_\\text{trans, pot}, f \\cdot W_\\text{soil}) \\tag{Braswell A15}\\label{eq:A15} $$ Actual transpiration $(F^W_\\text{trans})$ is the minimum of potential transpiration $(F^W_{\\text{pot}})$ and the fraction $(f)$ of the total soil water $(W_\\text{soil})$ that is removable in one day.","title":"Actual Transpiration"},{"location":"model-structure/#dependence-functions-for-temperature-and-moisture","text":"Metabolic processes including photosynthesis, autotrophic and heterotrophic respiration, decomposition, nitrogen volatilization, and methanogenesis are modified directly by temperature, soil moisture, and / or vapor pressure deficit. Below is a description of these functions.","title":"Dependence Functions for Temperature and Moisture"},{"location":"model-structure/#temperature-dependence-functions-d_texttemp","text":"","title":"Temperature Dependence Functions $D_\\text{temp}$"},{"location":"model-structure/#parabolic-function-for-photosynthesis-d_texttemp-a","text":"Photosynthesis has a temperature optimum in the range of observed air temperatures as well as maximum and minimum temperatures of photosynthesis $(A)$. SIPNET represents the temperature dependence of photosynthesis as a parabolic function. This function has a maximum at the temperature optimum, and decreases as temperature moves away from the optimum. $$ D_\\text{temp,A}=\\max\\left(\\frac{(T_\\text{max} - T_\\text{air})(T_\\text{air} - T_\\text{min})}{\\left(\\frac{T_\\text{max} - T_\\text{min}}{2}\\right)^2}, 0\\right) \\tag{Braswell A9}\\label{eq:A9} $$ Where $T_{\\text{env}}$ may be soil or air temperature $(T_\\text{soil}$ or $T_\\text{air})$. Becuase the function is symmetric around $T_\\text{opt}$, the parameters $T_{\\text{min}}$ and $T_{\\text{opt}}$ are provided and $T_{\\text{max}}$ is calculated internally as $T_{\\text{max}} = 2 \\cdot T_{\\text{opt}} - T_{\\text{min}}$.","title":"Parabolic Function for Photosynthesis $D_\\text{temp, A}$"},{"location":"model-structure/#exponential-function-for-respiration-d_texttempq10","text":"The temperature response of autotrophic $(R_a)$ and heterotrophic $(R_H)$ respiration represented as an exponential relationship using a simplified Arrhenius function. $$ D_{\\text{temp,Q10}} = Q_{10}^{\\frac{(T-T_\\text{opt})}{10}} \\tag{Braswell A18b}\\label{eq:A18b} % Defined as part of eq A18 $$ The exponential function is a simplification of the Arrhenius function in which $Q_{10}$ is the temperature sensitivity parameter, $T$ is the temperature, and $T_{\\text{opt}}$ is the optimal temperature for the process set to 0 for wood and soil respiration. (Note that this is part of the equation for leaf respiration in Braswell et al. (2005). We assume $T=T_\\text{air}$ for leaf and wood respiration, and $T=T_\\text{soil}$ for soil and root respiration. The optimal temperature for leaf respiration is the optimal temperature for photosynthesis, $T_{\\text{opt}}=T_{\\text{opt,A}}$, while $T_{\\text{opt}}=0$ for wood, root, and soil respiration. This function provides two ways to reduce the number of parameters in the model. Braswell et al (2005) used two $Q_{10}$ values, one for $R_A$ and one for $R_H$ and these calibrated to the same value of 1.7. By contrast, Zobitz et al (2008) used four $Q_{10}$ values, one for both leaf and wood, and one each for coarse root, fine root, and soil. Notably, these four $Q_{10}$ values ranged from 1.4 to 5.8 when SIPNET was calibrated to $CO_2$ fluxes in a subalpine forest.","title":"Exponential Function for Respiration $D_{\\text(temp,Q10)}$"},{"location":"model-structure/#moisture-dependence-functions-d_water","text":"Moisture dependence functions are typically based on soil water content as a fraction of water holding capacity, also referred to as soil moisture or fractional soil wetness. We will represent this fraction of soil wetness as $f_\\text{WHC}$.","title":"Moisture dependence functions $D_{water}$"},{"location":"model-structure/#soil-water-content-fraction","text":"$$ f_{\\text{WHC}} = \\frac{W_{\\text{soil}}}{W_{\\text{WHC}}} $$ Where $W_{\\text{soil}}$: Soil water content $W_{\\text{WHC}}$: Soil water holding capacity","title":"Soil Water Content Fraction"},{"location":"model-structure/#water-stress-factor","text":"$$ D_{\\text{water,}A} = \\frac{F^W_{\\text{trans}}}{F^W_{\\text{trans, pot}}} \\tag{Braswell A16} \\label{eq:A16} $$ The water stress factor $(D_{\\text{water,}A})$ is the ratio of actual transpiration $(F^W_\\text{trans})$ to potential transpiration $(F^W_\\text{trans, pot})$.","title":"Water Stress Factor"},{"location":"model-structure/#soil-respiration-moisture-dependence-d_textwaterr_h","text":"The moisture dependence of heterotrophic respiration is a linear function of soil water content when soil temperature is above freezing: $$ D_{\\text{water} R_H} = \\begin{cases} 1, & \\text{if } T_{\\text{soil}} \\leq 0 \\ f_{\\text{WHC}} & \\text{if } T_{\\text{soil}} > 0 \\end{cases} \\tag{24}\\label{eq:water_rh} $$","title":"Soil Respiration Moisture Dependence $(D_{\\text{water,}R_H})$"},{"location":"model-structure/#frakmoisture-dependence-for-anaerobic-metabolism-with-soil-moisture-optimum","text":"There are many possible functions for the moisture dependence of anaerobic metabolism. The key feature is that there must be an optimum moisture level. Lets start with a two-parameter Beta function covering the range $50 < f_{\\text{WHC}} < 120$. Beta function $$ D_{\\mathrm{moistur,O_2}} = (f_{WHC} - f_{WHC_\\text{min}})^\\beta \\cdot (f_{WHC_\\text{max}} - f_{WHC})^\\gamma $$ Where $\\beta$ and $\\gamma$ are parameters that control the shape of the curve, and can be estimated for a particular maiximum and width. For the relationship between $N_2O$ flux and soil moisture, Wang et al (2023) suggest a Gaussian function.","title":"$\\frak{Moisture \\ Dependence \\ For \\ Anaerobic \\ Metabolism \\ with \\ Soil \\ Moisture \\ Optimum}$"},{"location":"model-structure/#frakagronomic-management-events","text":"All management events are specified in the events.in . Each event is a separate record that includes the date of the event, the type of event, and associated parameters.","title":"$\\frak{Agronomic \\ Management \\ Events}$"},{"location":"model-structure/#frakfertilizer-and-organic-matter-additions","text":"Additions of Mineral N, Organic N, and Organic C are represented by the fluxes $F^N_{\\text{fert,min}}$, $F^N_{\\text{fert,org}},$ and $F^C_{\\text{fert,org}}$ that are specified in the events.in configuration file. Event parameters specified in the events.in file: Organic N added $(F^N_{\\text{fert,org}})$ Organic C added $(F^C_{\\text{fert,org}})$ Mineral N added $(F^N_{\\text{fert,min}})$ These are added to the litter C and N and mineral N pools, respectively. Mineral N includes fertilizer supplied as NO3, NH4, and Urea-N. Urea-N is assumed to hydrolyze to ammonium and bicarbonate rapidly and is treated as a mineral N pool. This is a common assumption because of the high rate of this conversion, and is consistent the DayCent formulation (Parton et al TK-ref, other models and refs?). Only relatively recently did DayCent explicitly model Urea-N to NH4 in order to represent the impact of urease inhibitors (Gurung et al 2021) that slow down the rate.","title":"$\\frak{Fertilizer \\ and \\ Organic \\ Matter \\ Additions}$"},{"location":"model-structure/#fraktillage","text":"To represent tillage, we define two new adjustment factors that modify the decomposition rates of litter $K_{\\text{litter}}$ and soil organic matter $K_{\\text{som}}$: Event parameters from the events.in file: SOM decomposition modifier $D_{K\\text{,tillage,litter}}$ Litter decomposition modifier $D_{K\\text{,tillage,som}}$ These values specified as fractions (e.g. 0.2 for 20% increase in decomposition rate). They are set to 0 by default and are expected to be >0. They are set in the events.in , and are effective for one month after the tillage event. $$ K^{\\prime} {\\text{i}} = K {\\text{i}} \\cdot (1+D_{K\\text{,tillage,}i}) $$ Where $i$ is either litter or soil organic matter pool, and $K^{\\prime}$ is the transiently adjusted decomposition rate. The choice of one month adjustment period is based on DayCent (Parton et al 2001).","title":"$\\frak{Tillage}$"},{"location":"model-structure/#frakplanting-and-emergence","text":"A planting event is defined by its emergence date and directly specifies the amount of carbon added to each of four plant carbon pools: leaf, wood, fine root, and coarse root. On the emergence date, the model initializes the plant pools with the amounts of carbon specified in the events file. Following carbon addition, nitrogen for each pool is computed using the corresponding C:N stoichiometric ratios following equation \\eqref{eq:cn_stoich}.","title":"$\\frak{Planting \\ and \\ Emergence}$"},{"location":"model-structure/#frakharvest","text":"A harvest event is specified by its date, the event type \"harv\", and the fractions of above and belowground carbon that is either transferred to litter or removed from the system. Because a harvest event only specifies the fraction of above and belowground carbon that is removed or transferred to litter, assume that the above terms apply to leaf + wood, and below applies to fine root + coarse root. The removed fraction is calculated as follows: $$ F^C_{\\text{harvest,removed}} = f_{\\text{remove,above}} \\cdot C_{\\text{above}} + f_{\\text{remove,below}} \\cdot C_{\\text{below}} $$ The fraction transferred to litter is calculated as follows: $$ F^C_{\\text{harvest,litter}} = f_{\\text{transfer,above}} \\cdot C_{\\text{leaf}} + f_{\\text{transfer,below}} \\cdot C_{\\text{root}} \\tag{28}\\label{eq:harvest} $$ This amount is then added to the litter flux in equation \\eqref{eq:litter_flux}.","title":"$\\frak{Harvest}$"},{"location":"model-structure/#frakirrigation","text":"Event parameters: Irrigation rate $(F^W_{\\text{irrigation}})$, cm/day Irrigation type indicator $(I_{\\text{irrigation}})$: Canopy irrigation (0): Water applied to the canopy, simulating rainfall. Soil irrigation (1): Water directly added to the soil. Canopy irrigation is simulated in the same way as precipitation, where a fraction of irrigation is intercepted and evaporated, and the remainder is added to the soil water pool. Soil irrigation adds water directly to the soil pool without interception. Flooded furrow irrigation' is a special case of soil irrigation, with a high rate of irrigation.","title":"$\\frak{Irrigation}$"},{"location":"model-structure/#references","text":"Braswell, Bobby H., William J. Sacks, Ernst Linder, and David S. Schimel. 2005. Estimating Diurnal to Annual Ecosystem Parameters by Synthesis of a Carbon Flux Model with Eddy Covariance Net Ecosystem Exchange Observations. Global Change Biology 11 (2): 335\u201355. https://doi.org/10.1111/j.1365-2486.2005.00897.x. Libohova, Z., Seybold, C., Wysocki, D., Wills, S., Schoeneberger, P., Williams, C., Lindbo, D., Stott, D. and Owens, P.R., 2018. Reevaluating the effects of soil organic matter and other properties on available water-holding capacity using the National Cooperative Soil Survey Characterization Database. Journal of soil and water conservation, 73(4), pp.411-421. Manzoni, Stefano, and Amilcare Porporato. 2009. Soil Carbon and Nitrogen Mineralization: Theory and Models across Scales. Soil Biology and Biochemistry 41 (7): 1355\u201379. https://doi.org/10.1016/j.soilbio.2009.02.031. Parton, W. J., E. A. Holland, S. J. Del Grosso, M. D. Hartman, R. E. Martin, A. R. Mosier, D. S. Ojima, and D. S. Schimel. 2001. Generalized Model for NOx and N2O Emissions from Soils. Journal of Geophysical Research: Atmospheres 106 (D15): 17403\u201319. https://doi.org/10.1029/2001JD900101. Wang H, Yan Z, Ju X, Song X, Zhang J, Li S and Zhu-Barker X (2023) Quantifying nitrous oxide production rates from nitrification and denitrification under various moisture conditions in agricultural soils: Laboratory study and literature synthesis. Front. Microbiol. 13:1110151. doi: 10.3389/fmicb.2022.1110151 Zobitz, J. M., D. J. P. Moore, W. J. Sacks, R. K. Monson, D. R. Bowling, and D. S. Schimel. 2008. \u201cIntegration of Process-Based Soil Respiration Models with Whole-Ecosystem CO2 Measurements.\u201d Ecosystems 11 (2): 250\u201369. https://doi.org/10.1007/s10021-007-9120-1.","title":"References"},{"location":"parameters/","text":"Input and Output Parameters (DRAFT) Note: this is a work in progress draft. Not all parameters listed will be used in the CCMMF formulation of the model. The \"Notation\" section should be consistent with model equations, some of the mathematical symbols in the tables may not be. Numbered items are cross-referenced with original documentation. Table of Contents Input and Output Parameters (DRAFT) Table of Contents Notation Variables (Pools, Fluxes, and Parameters) Subscripts (Temporal, Spatial, or Contextual Identifiers) Run-time Parameters Initial state values Litter Quality Parameters Photosynthesis parameters Phenology-related parameters Allocation parameters Autotrophic respiration parameters Soil respiration parameters Nitrogen Cycle Parameters Methane parameters Moisture-related parameters Tree physiological parameters Compile-time parameters Drivers Climate Examples of climate files: Agronomic Events Fertilization Events Tillage Events Planting Events Harvest Events Example of events file: Outputs Notation Variables (Pools, Fluxes, and Parameters) Symbol Description $C$ Carbon pool $N$ Nitrogen pool $CN$ Carbon-to-Nitrogen ratio $W$ Water pool or content $R$ Respiration flux $A$ Photosynthesis rate (net assimilation) $T$ Temperature $K$ Rate constant (e.g., for decomposition or respiration) $LAI$ Leaf Area Index $PAR$ Photosynthetically Active Radiation $GPP$ Gross Primary Production $NPP$ Net Primary Production $NEE$ Net Ecosystem Exchange $VPD$ Vapor Pressure Deficit $ET$ Evapotranspiration $Q_{10}$ Temperature sensitivity coefficient $f$ The fraction of a pool or flux other than NPP $F$ Flux of carbon, nitrogen, or water $D$ Dependency or Damping Function $N$ Nitrogen $C$ Carbon $\\alpha$ The fraction of NPP allocated to a plant pool $k$ Scaling factor Subscripts (Temporal, Spatial, or Contextual Identifiers) Subscript Description $X_0$ Initial value, default value, state at time zero $X_t$ Value at time $t$ $X_d$ Daily value $X_\\text{max}$ Maximum value (e.g., temperature or rate) $X_\\text{min}$ Minimum value (e.g., temperature or rate) $X_\\text{opt}$ Optimal value (e.g., temperature or rate) $X_\\text{avg}$ Average value (e.g., over a timestep or spatial area) $X_\\text{leaf}$ leaf pools or fluxes $X_\\text{wood}$ wood pools or fluxes $X_\\text{root}$ root pool $X_\\text{fine root}$ fine root pool $X_\\text{coarse root}$ coarse root pool $X_\\text{soil}$ soil pools or processes $X_\\text{litter}$ litter pools or processes $X_\\text{veg}$ vegetation processes (general) $X_\\text{resp}$ respiration processes $X_\\text{dec}$ decomposition processes $X_\\text{vol}$ volatilization processes $X_\\text{VPD}$ vapor pressure deficit $X_\\text{org}$ organic forms $X_\\text{mineral}$ mineral forms $X_{\\text{anaer}}$ anaerobic soil conditions Subscripts may be used in combination, e.g. $X_{\\text{soil,mineral},0}$. Run-time Parameters Run-time parameters can change from one run to the next, or when the model is stopped and restarted. These include initial state values and parameters related to plant physiology, soil physiology, and biogeochemical cycling. Initial state values Symbol Parameter Name Definition Units notes 1 $C_{\\text{wood},0}$ plantWoodInit Initial wood carbon $\\text{g C} \\cdot \\text{m}^{-2} \\text{ ground area}$ above-ground + roots 2 $LAI_0$ laiInit Initial leaf area m^2 leaves * m^-2 ground area multiply by SLW to get initial plant leaf C: $C_{\\text{leaf},0} = LAI_0 \\cdot SLW$ 3 $C_{\\text{litter},0}$ litterInit Initial litter carbon $\\text{g C} \\cdot \\text{m}^{-2} \\text{ ground area}$ 4 $C_{\\text{soil},0}$ soilInit Initial soil carbon $\\text{g C} \\cdot \\text{m}^{-2} \\text{ ground area}$ 5 $W_{\\text{litter},0}$ litterWFracInit unitless fraction of litterWHC 6 $W_{\\text{soil},0}$ soilWFracInit unitless fraction of soilWHC $N_{\\text{soil},0}$ Initial soil organic nitrogen content g N m$^{-2}$ ${CH_4}_{\\text{soil},0}$ Initial methane concentration in the soil g C m$^{-2}$ ${N_2O}_{\\text{soil},0}$ Nitrous oxide concentration in the soil g N m$^{-2}$ $f_{\\text{fine root},0}$ fineRootFrac Fraction of plantWoodInit allocated to initial fine root carbon pool $f_{\\text{coarse root},0}$ coarseRootFrac Fraction of plantWoodInit allocated to initial coarse root carbon pool Litter Quality Parameters Symbol Name Description Units Notes $CN_{\\textrm{litter}}$ Carbon to Nitrogen ratio of litter $CN_{\\textrm{wood}}$ Carbon to Nitrogen ratio of wood CN_coarse_root = CN_wood $CN_{\\textrm{leaf}}$ Carbon to Nitrogen ratio of leaves $CN_{\\textrm{fine root}}$ Carbon to Nitrogen ratio of fine roots $CN_{\\textrm{coarse root}}$ Carbon to Nitrogen ratio of coarse roots $k_\\textit{CN}$ Decomposition CN scaling parameter Photosynthesis parameters Symbol Parameter Name Definition Units notes 8 $A_{\\text{max}}$ aMax Maximum net CO2 assimilation rate $\\text{nmol CO}_2 \\cdot \\text{g}^{-1} \\cdot \\text{leaf} \\cdot \\text{s}^{-1}$ assuming max. possible PAR, all intercepted, no temp, water or VPD stress 9 $f_{A_{\\text{max},d}}$ aMaxFrac avg. daily aMax as fraction of instantaneous fraction Avg. daily max photosynthesis as fraction of $A_{\\text{max}}$ 10 $R_\\text{leaf,opt}$ baseFolRespFrac basal Foliar maintenance respiration as fraction of $A_{\\text{max}}$ fraction 11 $T_{\\text{min}}$ psnTMin Minimum temperature at which net photosynthesis occurs $^{\\circ}\\text{C}$ 12 $T_{\\text{opt}}$ psnTOpt Optimum temperature at which net photosynthesis occurs $^{\\circ}\\text{C}$ 13 $K_\\text{VPD}$ dVpdSlope Slope of VPD\u2013photosynthesis relationship $kPa^{-1}$ dVpd = 1 - dVpdSlope * vpd^dVpdExp 14 $K_{\\text{VPD}},{\\text{exp}}$ dVpdExp Exponent used to calculate VPD effect on Psn dimensionless dVpd = 1 - dVpdSlope * vpd^dVpdExp 15 $\\text{PAR}_{1/2}$ halfSatPar Half saturation point of PAR\u2013photosynthesis relationship $m^{-2}$\\ ground area $\\cdot$ day$^{-1}$ PAR at which photosynthesis occurs at 1/2 theoretical maximum 16 $k$ attenuation Canopy PAR extinction coefficient Phenology-related parameters Symbol Parameter Name Definition Units notes 17 $D_{\\text{on}}$ leafOnDay Day of year when leaves appear day of year 18 gddLeafOn with gdd-based phenology, gdd threshold for leaf appearance 19 soilTempLeafOn with soil temp-based phenology, soil temp threshold for leaf appearance 20 $D_{\\text{off}}$ leafOffDay Day of year for leaf drop 21 leafGrowth additional leaf growth at start of growing season $\\text{g C} \\cdot \\text{m}^{-2} \\text{ ground}$ 22 fracLeafFall additional fraction of leaves that fall at end of growing season 23 $\\alpha_\\text{leaf}$ leafAllocation fraction of NPP allocated to leaf growth 24 $K_{leaf}$ leafTurnoverRate average turnover rate of leaves fraction per day read in as per-year rate $L_{\\text{max}}$ Maximum leaf area index obtained $\\text{m}^2 \\text{ leaf } \\text{m}^{-2} \\text{ ground}$ ? from Braswell et al 2005; can't find in code Allocation parameters Symbol Parameter Name Definition Units notes 64 fineRootFrac fraction of wood carbon allocated to fine root 65 coarseRootFrac fraction of wood carbon that is coarse root 66 $\\alpha_\\text{fine root}$ fineRootAllocation fraction of NPP allocated to fine roots 67 $\\alpha_\\text{wood}$ woodAllocation fraction of NPP allocated to wood Autotrophic respiration parameters Symbol Parameter Name Definition Units notes 25 $R_{\\text{a,wood},0}$ baseVegResp Wood maintenance respiration rate at $0^\\circ C$ g C respired * g$^{-1}$ plant C * day$^{-1}$ read in as per-year rate only counts plant wood C; leaves handled elsewhere (both above and below-ground: assumed for now to have same resp. rate) 26 $Q_{10v}$ vegRespQ10 Vegetation respiration Q10 Scalar determining effect of temp on veg. resp. 27 growthRespFrac growth resp. as fraction of ($GPP - R_\\text{a,wood} - R_\\text{a,leaf}$) 28 frozenSoilFolREff amount that foliar resp. is shutdown if soil is frozen 0 = full shutdown, 1 = no shutdown 29 frozenSoilThreshold soil temperature below which frozenSoilFolREff and frozenSoilEff kick in \u00b0C 72 baseFineRootResp base respiration rate of fine roots $\\text{y}^{-1}$ per year rate 73 baseCoarseRootResp base respiration rate of coarse roots $\\text{y}^{-1}$ per year rate Soil respiration parameters Symbol Parameter Name Definition Units notes 30 $K_\\text{litter}$ litterBreakdownRate rate at which litter is converted to soil / respired at 0\u00b0C and max soil moisture g C broken down * g^-1 litter C * day^-1 read in as per-year rate 31 fracLitterRespired of the litter broken down, fraction respired (the rest is transferred to soil pool) 32 $K_{dec}$ baseSoilResp Soil respiration rate at $0 ^{\\circ}\\text{C}$ and moisture saturated soil g C respired * g$^{-1}$ soil C * day$^{-1}$ read in as per-year rate 33 baseSoilRespCold soil respiration at 0\u00b0C and max soil moisture when tsoil < coldSoilThreshold g C respired * g$^{-1}$ soil C * day$^{-1}$ read in as per-year rate 34 $Q_{10s}$ soilRespQ10 Soil respiration Q10 scalar determining effect of temp on soil respiration 35 soilRespQ10Cold scalar determining effect of temp on soil resp. when tsoil < coldSoilThreshold 36 coldSoilThreshold temp. at which use baseSoilRespCold and soilRespQ10Cold \u00b0C Not used if SEASONAL_R_SOIL is 0 37 E0 E0 in Lloyd-Taylor soil respiration function Not used if LLOYD_TAYLOR is 0 38 T0 T0 in Lloyd-Taylor soil respiration function Not used if LLOYD_TAYLOR is 0 39 soilRespMoistEffect scalar determining effect of moisture on soil resp. baseMicrobeResp $R_{dec}$: Rate of decomposition $(\\text{day}^{-1})$ $Q_{10dec}$: Temperature coefficient for $R_{dec}$ (unitless) Nitrogen Cycle Parameters $K_{n,vol}$: Rate constant for volatilization (day-1) $f_{N2O_{vol}}$: Fraction of volatilization leading to N2O production $R_{min}$: Rate of mineralization (day-1) $I_\\text{N limit}$: Indicator for nitrogen limitation Methane parameters $R_{meth}$: Rate of methane production $(\\text{day}^{-1})$ $K_{meth}$: Rate constant for methane production under anaerobic conditions $(\\text{day}^{-1})$ $K_{methox}$: Rate constant, methane oxidation $(\\text{day}^{-1})$ Moisture-related parameters Symbol Parameter Name Definition Units notes 40 $f_{\\text{trans,avail}}$ waterRemoveFrac fraction of plant available soil water which can be removed in one day by transpiration without water stress occurring new $f_\\text{drain,0}$ waterDrainFrac fraction of plant available soil water which can be removed in one day by drainage $d^{-1}$ default 1 for well drained soils 41 frozenSoilEff fraction of water that is available if soil is frozen (0 = none available, 1 = all still avail.) if frozenSoilEff = 0, then shut down psn. even if WATER_PSN = 0, if soil is frozen (if frozenSoilEff > 0, it has no effect if WATER_PSN = 0) 42 wueConst water use efficiency constant 43 litterWHC litter (evaporative layer) water holding capacity cm 44 soilWHC soil (transpiration layer) water holding capacity cm 45 $f_\\text{intercept} immedEvapFrac fraction of rain that is immediately intercepted & evaporated 46 fastFlowFrac fraction of water entering soil that goes directly to drainage $k_\\text{SOM,drain}$ 47 snowMelt rate at which snow melts cm water equivavlent per degree Celsius per day 48 litWaterDrainRate rate at which litter rains into lower layer when litter layer fully moisture-saturated cm water/day 49 rdConst scalar determining amount of aerodynamic resistance 50 rSoilConst1 soil resistance = e^(rSoilConst1 - rSoilConst2 * W1) , where W1 = (litterWater/litterWHC) 51 rSoilConst2 soil resistance = e^(rSoilConst1 - rSoilConst2 * W1) , where W1 = (litterWater/litterWHC) 52 m_ballBerry slope for the Ball Berry relationship Tree physiological parameters Symbol Parameter Name Definition Units notes 53 $SLW$ leafCSpWt g C * m^-2 leaf area 54 $C_{frac}$ cFracLeaf g leaf C * g^-1 leaf 55 $K_\\text{wood}$ woodTurnoverRate average turnover rate of woody plant C $\\text{y}^{-1}$ read in as per-year rate; leaf loss handled separately 70 $K_\\text{fine root}$ fineRootTurnoverRate turnover of fine roots $\\text{y}^{-1}$ per year rate 71 $K_\\text{coarse root}$ coarseRootTurnoverRate turnover of coarse roots yr^-1 per year rate Compile-time parameters Parameter 0 Default Description CSV_O 0 output .out file as a CSV file ALTERNATIVE_TRANS 0 0 do we want to implement alternative transpiration? BALL_BERRY 0 0 implement a Ball Berry submodel to calculate gs from RH, CO2 and A PENMAN_MONTEITH_TRANS 0 0 implement a transpiration calculation based on the Penman-Monteith Equation GROWTH_RESP 0 0 explicitly model growth resp., rather than including with maint. resp. LLOYD_TAYLOR 0 0 use Lloyd-Taylor model for soil respiration, in which temperature sensitivity decreases at higher temperatures? SEASONAL_R_SOIL 0 && !LLOYD_TAYLOR 0 use different parameters for soil resp. (baseSoilResp and soilRespQ10) when tsoil < (some threshold)? WATER_PSN 1 1 does soil moisture affect photosynthesis? WATER_HRESP 1 1 does soil moisture affect heterotrophic respiration? DAYCENT_WATER_HRESP 0 && WATER_HRESP 0 use DAYCENT soil moisture function? MODEL_WATER 1 1 do we model soil water (and ignore soilWetness)? COMPLEX_WATER 1 && MODEL_WATER 1 do we use a more complex water submodel? (model evaporation as well as transpiration) LITTER_WATER 0 && (COMPLEX_WATER) 0 do we have a separate litter water layer, used for evaporation? LITTER_WATER_DRAINAGE 1 && (LITTER_WATER) 0 does water from the top layer drain down into bottom layer even if top layer not overflowing? SNOW (1 || (COMPLEX_WATER)) && MODEL_WATER 1 keep track of snowpack, rather than assuming all precip. is liquid GDD 0 0 use GDD to determine leaf growth? (note: mutually exclusive with SOIL_PHENOL) SOIL_PHENOL 0 && !GDD 0 use soil temp. to determine leaf growth? (note: mutually exclusive with GDD) LITTER_POOL 0 0 have extra litter pool, in addition to soil c pool SOIL_MULTIPOOL 0 && !LITTER_POOL 0 do we have a multipool approach to model soils? NUMBER_SOIL_CARBON_POOLS 3 3 number of pools we want to have. Equal to 1 if SOIL_MULTIPOOL is 0 SOIL_QUALITY 0 && SOIL_MULTIPOOL 0 do we have a soil quality submodel? MICROBES 0 && !SOIL_MULTIPOOL 0 do we utilize microbes. This will only be an option if SOIL_MULTIPOOL is 0 and MICROBES is 1 STOICHIOMETRY 0 && MICROBES 0 do we utilize stoichometric considerations for the microbial pool? ROOTS 0 0 do we model root dynamics? If no, roots are part of wood pool. If yes, split into coarse and fine roots MODIS 0 0 do we use modis FPAR data to constrain GPP? C_WEIGHT 12.0 12 molecular weight of carbon MEAN_NPP_DAYS 5 5 over how many days do we keep the running mean MEAN_NPP_MAX_ENTRIES MEAN_NPP_DAYS*50 assume that the most pts we can have is two per hour MEAN_GPP_SOIL_DAYS 5 5 over how many days do we keep the running mean MEAN_GPP_SOIL_MAX_ENTRIES MEAN_GPP_SOIL_DAYS*50 assume that the most pts we can have is one per hour LAMBDA 2501000 latent heat of vaporization (J/kg) LAMBDA_S 2835000 latent heat of sublimation (J/kg) RHO 1.3 air density (kg/m^3) CP 1005. specific heat of air (J/(kg K)) GAMMA 66 psychometric constant (Pa/K) E_STAR_SNOW 0.6 approximate saturation vapor pressure at 0\u00b0C (kPa) Drivers Climate For each step of the model, for each location, the following inputs are needed. These are provided in a file named <sitename>.clim with the following columns: col parameter description units notes 1 loc spatial location index maps to param-spatial file, can be 0 for a single site, as when used by PEcAn 2 year year of start of this timestep integer, e.g. 2010 3 day day of start of this timestep integer where 1 = Jan 1 4 time time of start of this timestep hours after midnight e.g. noon = 12.0, midnight = 0.0, can be a fraction 5 length length of this timestep days variable-length timesteps allowed, typically not used 6 tair avg. air temp for this time step degrees Celsius 7 tsoil average soil temperature for this time step degrees Celsius can be estimated from Tair 8 par average photosynthetically active radiation (PAR) for this time step $\\text{Einsteins} \\cdot m^{-2} \\text{ground area} \\cdot \\text{time step}^{-1}$ input is in Einsteins * m^-2 ground area, summed over entire time step 9 precip total precip. for this time step cm input is in mm; water equivilant - either rain or snow 10 vpd average vapor pressure deficit kPa input is in Pa, can be calculated from air temperature and relative humidity. 11 vpdSoil average vapor pressure deficit between soil and air kPa input is in Pa ; differs from vpd in that saturation vapor pressure is calculated using Tsoil rather than Tair 12 vPress average vapor pressure in canopy airspace kPa input is in Pa 13 wspd avg. wind speed m/s 14 soilWetness fractional soil wetness unitless (0-1) $f_\\text{WHC}$; Used if MODEL_WATER=0 ; if MODEL_WATER=1 , soil wetness is simulated Examples of climate files: Column names are not used, but are: loc year day time length tair tsoil par precip vpd vpdSoil vPress wspd soilWetness Half-hour time step 0 1998 305 0.00 -1800 1.9000 1.2719 0.0000 0.0000 109.5364 77.5454 726.6196 1.6300 0.0000 0 1998 305 0.50 -1800 1.9000 1.1832 0.0000 0.0000 109.5364 73.1254 726.6196 1.6300 0.0000 0 1998 305 1.00 -1800 2.0300 1.1171 0.0000 0.0000 110.4243 63.9567 732.5092 0.6800 0.0000 0 1998 305 1.50 -1800 2.0300 1.0439 0.0000 0.0000 110.4243 60.3450 732.5092 0.6800 0.0000 Variable time step 0 1998 305 0.00 0.292 1.5 0.8 0.0000 0.0000 105.8 70.1 711.6 0.9200 0.0000 0 1998 305 7.00 0.417 3.6 1.8 5.6016 0.0000 125.7 23.5 809.4 1.1270 0.0000 0 1998 305 17.00 0.583 1.9 1.3 0.0000 0.0000 108.1 75.9 732.7 1.1350 0.0000 0 1998 306 7.00 0.417 2.2 1.4 2.7104 1.0000 114.1 71.6 741.8 0.9690 0.0000 Agronomic Events For managed ecosystems, the following inputs are provided in a file named events.in with the following columns: col parameter description units notes 1 loc spatial location index maps to param-spatial file 2 year year of start of this timestep e.g. 2010 3 day day of start of this timestep Day of year 1 = Jan 1 4 event_type type of event one of plant, harv, till, fert, irrig 5...n event_param parameter associated with event see table below Agronomic events are stored in events.in, one event per row Events in the file are sorted first by location, and then chronologically Events are specified by year and day (no hourly timestamp) It is assumed that there is one (or more) records in the climate file for each location/day that appears in the events file We will throw an error if we find an event with no corresponding climate record Events are processed with the first climate record that occurs for the relevant location/day as an instantaneous one-time change We may need events with duration later, spec TBD. Tillage is likely in this bucket. The effects of an event are applied after fluxes are calculated for the current climate record; they are applied as a delta to one or more state variables, as required parameter col req? description amount 5 Y Amount added (cm/d) method 6 Y 0=canopy 1=soil 2=flood (placeholder) Model representation: an irrigation event increases soil moisture. Canopy irrigation also loses some moisture to evaporation. Specifically: - amount is listed as cm/d, but as events are specified per-day, this is treated as cm of water added on that day - For method=soil, this amount of water is added directly to the soilWater state variable - For method=canopy, a fraction of the irrigation water (determined by input param immedEvapFrac ) is added to the flux state variable immedEvap , with the remainder going to soilWater . - Initial implementation assumes that LITTER_WATER is not on. This might be revisited at a later date. Notes: - irrigation could also directly change the soil moisture content rather than adding water as a flux. This could be used to represent an irrigation program that sets a moisture range and turns irrigation on at the low end and off at the high end of the range. Fertilization Events parameter col req? description org-N 5 Y g N / m2 org-C 6 Y g C / m2 min-N 7 Y g N / m2 (NH4+NO3 in one pool model; NH4 in two pool model) min-N2 8 Y* g N / m2 (*not unused in one pool model, NO3 in two pool model) model representation: increases size of mineral N and litter C and N. Urea-N is assumed to be mineral N or NH4. notes: PEcAn will handle conversion from fertilizer amount and type to mass of N and C allocated to different pools Tillage Events parameter col req? description SOM decomposition modifier 5 Y % increase in $K_{dec}$ litter decomposition modifier 6 Y % increase in $K_{lit}$ model representation: increase k for one month, amount proportional to depth transfer litter C and N to soil pool notes: could also alter bulk density and other soil properties Planting Events parameter col req? description leaf-C 5 Y C added to leaf pool (g C / m2) wood-C 6 Y C added to above-ground wood pool (g C / m2) fine-root-C 7 Y C added to fine root pool (g C / m2) coarse-root-C 8 Y C added to coarse root pool (g C / m2) model representation: Date of event is the date of emergence, not the date of actual planting Increases size of carbon pools by the amount of each respective parameter $N$ pools are calculated from $CN$ stoichiometric ratios. notes: PFT (crop type) is not an input parameter for a planting event because SIPNET only represents a single PFT. Harvest Events parameter col req? description fraction of aboveground biomass removed 5 Y fraction of belowground biomass removed 6 N default = 0 fraction of aboveground biomass transferred to litter pool 7 N default = 1 - removed fraction of belowground biomass transferred to litter pool 8 N default = 1 - removed model representation: biomass C and N pools are either removed or added to litter for annuals or plants terminated, no biomass remains (col 5 + col 7 = 1 and col 6 + col 8 = 1). for perennials, some biomass may remain (col 5 + col 7 <= 1 and col 6 + col 8 <= 1; remainder is living). root biomass is only removed for root crops Example of events file: 1 2022 40 irrig 5 1 # 5cm canopy irrigation on day 40 1 2022 40 fert 10 5 0 0 # fertilized with 10 g / m2 NO3-N and 5 g / m2 NH4-N on day 40 1 2022 35 till 0.2 0.3 # tilled on day 35, soil organic matter pool decomposition rate increases by 20% and soil litter pool decomposition rate increases by 30% 1 2022 50 plant 10 3 2 5 # plant emergence on day 50 with 10/3/2/4 g C / m2, respectively, added to the leaf/wood/fine root/coarse root pools 1 2022 250 harv 0.1 # harvest 10% of aboveground plant biomass on day 250 Outputs Symbol Parameter Name Definition Units 1 loc spatial location index 2 year year of start of this timestep 3 day day of start of this timestep 4 time time of start of this timestep 5 plantWoodC carbon in wood g C/m$^2$ 6 plantLeafC carbon in leaves g C/m$^2$ 7 soil carbon in mineral soil g C/m$^2$ 8 microbeC carbon in soil microbes g C/m$^2$ 9 coarseRootC carbon in coarse roots g C/m$^2$ 10 fineRootC carbon in fine roots g C/m$^2$ 11 litter carbon in litter g C/m$^2$ 12 litterWater moisture in litter layer cm 13 soilWater moisture in soil cm 14 $f_\\text{WHC}$ soilWetnessFrac moisture in soil as fraction 15 snow snow water cm 16 npp net primary production g C/m$^2$ 17 nee net ecosystem production g C/m$^2$ 18 cumNEE cumulative nee g C/m$^2$ 19 $GPP$ gpp gross ecosystem production g C/m$^2$ 20 $R_{A,\\text{above}}$ rAboveground plant respiration above ground g C/m$^2$ 21 $R_H$ rSoil soil respiration g C/m$^2$ 22 $R_{A\\text{, root}}$ rRoot root respiration g C/m$^2$ 23 $R$ rtot total respiration g C/m$^2$ 24 fluxestranspiration transpiration cm $F^N_\\text{vol}$ fluxesn2o Nitrous Oxide flux g N/m$^2$ / timestep $F^C_{\\text{CH}_4}$ fluxesch4 Methane Flux g C/m$^2$ / timestep $F^N_\\text{vol}$ fluxesn2o Nitrous Oxide flux g N/m$^2$ / timestep $F^C_{\\text{CH}_4}$ fluxesch4 Methane Flux g C/m$^2$ / timestep","title":"Input and Output Parameters (DRAFT)"},{"location":"parameters/#input-and-output-parameters-draft","text":"Note: this is a work in progress draft. Not all parameters listed will be used in the CCMMF formulation of the model. The \"Notation\" section should be consistent with model equations, some of the mathematical symbols in the tables may not be. Numbered items are cross-referenced with original documentation.","title":"Input and Output Parameters (DRAFT)"},{"location":"parameters/#table-of-contents","text":"Input and Output Parameters (DRAFT) Table of Contents Notation Variables (Pools, Fluxes, and Parameters) Subscripts (Temporal, Spatial, or Contextual Identifiers) Run-time Parameters Initial state values Litter Quality Parameters Photosynthesis parameters Phenology-related parameters Allocation parameters Autotrophic respiration parameters Soil respiration parameters Nitrogen Cycle Parameters Methane parameters Moisture-related parameters Tree physiological parameters Compile-time parameters Drivers Climate Examples of climate files: Agronomic Events Fertilization Events Tillage Events Planting Events Harvest Events Example of events file: Outputs","title":"Table of Contents"},{"location":"parameters/#notation","text":"","title":"Notation"},{"location":"parameters/#variables-pools-fluxes-and-parameters","text":"Symbol Description $C$ Carbon pool $N$ Nitrogen pool $CN$ Carbon-to-Nitrogen ratio $W$ Water pool or content $R$ Respiration flux $A$ Photosynthesis rate (net assimilation) $T$ Temperature $K$ Rate constant (e.g., for decomposition or respiration) $LAI$ Leaf Area Index $PAR$ Photosynthetically Active Radiation $GPP$ Gross Primary Production $NPP$ Net Primary Production $NEE$ Net Ecosystem Exchange $VPD$ Vapor Pressure Deficit $ET$ Evapotranspiration $Q_{10}$ Temperature sensitivity coefficient $f$ The fraction of a pool or flux other than NPP $F$ Flux of carbon, nitrogen, or water $D$ Dependency or Damping Function $N$ Nitrogen $C$ Carbon $\\alpha$ The fraction of NPP allocated to a plant pool $k$ Scaling factor","title":"Variables (Pools, Fluxes, and Parameters)"},{"location":"parameters/#subscripts-temporal-spatial-or-contextual-identifiers","text":"Subscript Description $X_0$ Initial value, default value, state at time zero $X_t$ Value at time $t$ $X_d$ Daily value $X_\\text{max}$ Maximum value (e.g., temperature or rate) $X_\\text{min}$ Minimum value (e.g., temperature or rate) $X_\\text{opt}$ Optimal value (e.g., temperature or rate) $X_\\text{avg}$ Average value (e.g., over a timestep or spatial area) $X_\\text{leaf}$ leaf pools or fluxes $X_\\text{wood}$ wood pools or fluxes $X_\\text{root}$ root pool $X_\\text{fine root}$ fine root pool $X_\\text{coarse root}$ coarse root pool $X_\\text{soil}$ soil pools or processes $X_\\text{litter}$ litter pools or processes $X_\\text{veg}$ vegetation processes (general) $X_\\text{resp}$ respiration processes $X_\\text{dec}$ decomposition processes $X_\\text{vol}$ volatilization processes $X_\\text{VPD}$ vapor pressure deficit $X_\\text{org}$ organic forms $X_\\text{mineral}$ mineral forms $X_{\\text{anaer}}$ anaerobic soil conditions Subscripts may be used in combination, e.g. $X_{\\text{soil,mineral},0}$.","title":"Subscripts (Temporal, Spatial, or Contextual Identifiers)"},{"location":"parameters/#run-time-parameters","text":"Run-time parameters can change from one run to the next, or when the model is stopped and restarted. These include initial state values and parameters related to plant physiology, soil physiology, and biogeochemical cycling.","title":"Run-time Parameters"},{"location":"parameters/#initial-state-values","text":"Symbol Parameter Name Definition Units notes 1 $C_{\\text{wood},0}$ plantWoodInit Initial wood carbon $\\text{g C} \\cdot \\text{m}^{-2} \\text{ ground area}$ above-ground + roots 2 $LAI_0$ laiInit Initial leaf area m^2 leaves * m^-2 ground area multiply by SLW to get initial plant leaf C: $C_{\\text{leaf},0} = LAI_0 \\cdot SLW$ 3 $C_{\\text{litter},0}$ litterInit Initial litter carbon $\\text{g C} \\cdot \\text{m}^{-2} \\text{ ground area}$ 4 $C_{\\text{soil},0}$ soilInit Initial soil carbon $\\text{g C} \\cdot \\text{m}^{-2} \\text{ ground area}$ 5 $W_{\\text{litter},0}$ litterWFracInit unitless fraction of litterWHC 6 $W_{\\text{soil},0}$ soilWFracInit unitless fraction of soilWHC $N_{\\text{soil},0}$ Initial soil organic nitrogen content g N m$^{-2}$ ${CH_4}_{\\text{soil},0}$ Initial methane concentration in the soil g C m$^{-2}$ ${N_2O}_{\\text{soil},0}$ Nitrous oxide concentration in the soil g N m$^{-2}$ $f_{\\text{fine root},0}$ fineRootFrac Fraction of plantWoodInit allocated to initial fine root carbon pool $f_{\\text{coarse root},0}$ coarseRootFrac Fraction of plantWoodInit allocated to initial coarse root carbon pool","title":"Initial state values"},{"location":"parameters/#litter-quality-parameters","text":"Symbol Name Description Units Notes $CN_{\\textrm{litter}}$ Carbon to Nitrogen ratio of litter $CN_{\\textrm{wood}}$ Carbon to Nitrogen ratio of wood CN_coarse_root = CN_wood $CN_{\\textrm{leaf}}$ Carbon to Nitrogen ratio of leaves $CN_{\\textrm{fine root}}$ Carbon to Nitrogen ratio of fine roots $CN_{\\textrm{coarse root}}$ Carbon to Nitrogen ratio of coarse roots $k_\\textit{CN}$ Decomposition CN scaling parameter","title":"Litter Quality Parameters"},{"location":"parameters/#photosynthesis-parameters","text":"Symbol Parameter Name Definition Units notes 8 $A_{\\text{max}}$ aMax Maximum net CO2 assimilation rate $\\text{nmol CO}_2 \\cdot \\text{g}^{-1} \\cdot \\text{leaf} \\cdot \\text{s}^{-1}$ assuming max. possible PAR, all intercepted, no temp, water or VPD stress 9 $f_{A_{\\text{max},d}}$ aMaxFrac avg. daily aMax as fraction of instantaneous fraction Avg. daily max photosynthesis as fraction of $A_{\\text{max}}$ 10 $R_\\text{leaf,opt}$ baseFolRespFrac basal Foliar maintenance respiration as fraction of $A_{\\text{max}}$ fraction 11 $T_{\\text{min}}$ psnTMin Minimum temperature at which net photosynthesis occurs $^{\\circ}\\text{C}$ 12 $T_{\\text{opt}}$ psnTOpt Optimum temperature at which net photosynthesis occurs $^{\\circ}\\text{C}$ 13 $K_\\text{VPD}$ dVpdSlope Slope of VPD\u2013photosynthesis relationship $kPa^{-1}$ dVpd = 1 - dVpdSlope * vpd^dVpdExp 14 $K_{\\text{VPD}},{\\text{exp}}$ dVpdExp Exponent used to calculate VPD effect on Psn dimensionless dVpd = 1 - dVpdSlope * vpd^dVpdExp 15 $\\text{PAR}_{1/2}$ halfSatPar Half saturation point of PAR\u2013photosynthesis relationship $m^{-2}$\\ ground area $\\cdot$ day$^{-1}$ PAR at which photosynthesis occurs at 1/2 theoretical maximum 16 $k$ attenuation Canopy PAR extinction coefficient","title":"Photosynthesis parameters"},{"location":"parameters/#phenology-related-parameters","text":"Symbol Parameter Name Definition Units notes 17 $D_{\\text{on}}$ leafOnDay Day of year when leaves appear day of year 18 gddLeafOn with gdd-based phenology, gdd threshold for leaf appearance 19 soilTempLeafOn with soil temp-based phenology, soil temp threshold for leaf appearance 20 $D_{\\text{off}}$ leafOffDay Day of year for leaf drop 21 leafGrowth additional leaf growth at start of growing season $\\text{g C} \\cdot \\text{m}^{-2} \\text{ ground}$ 22 fracLeafFall additional fraction of leaves that fall at end of growing season 23 $\\alpha_\\text{leaf}$ leafAllocation fraction of NPP allocated to leaf growth 24 $K_{leaf}$ leafTurnoverRate average turnover rate of leaves fraction per day read in as per-year rate $L_{\\text{max}}$ Maximum leaf area index obtained $\\text{m}^2 \\text{ leaf } \\text{m}^{-2} \\text{ ground}$ ? from Braswell et al 2005; can't find in code","title":"Phenology-related parameters"},{"location":"parameters/#allocation-parameters","text":"Symbol Parameter Name Definition Units notes 64 fineRootFrac fraction of wood carbon allocated to fine root 65 coarseRootFrac fraction of wood carbon that is coarse root 66 $\\alpha_\\text{fine root}$ fineRootAllocation fraction of NPP allocated to fine roots 67 $\\alpha_\\text{wood}$ woodAllocation fraction of NPP allocated to wood","title":"Allocation parameters"},{"location":"parameters/#autotrophic-respiration-parameters","text":"Symbol Parameter Name Definition Units notes 25 $R_{\\text{a,wood},0}$ baseVegResp Wood maintenance respiration rate at $0^\\circ C$ g C respired * g$^{-1}$ plant C * day$^{-1}$ read in as per-year rate only counts plant wood C; leaves handled elsewhere (both above and below-ground: assumed for now to have same resp. rate) 26 $Q_{10v}$ vegRespQ10 Vegetation respiration Q10 Scalar determining effect of temp on veg. resp. 27 growthRespFrac growth resp. as fraction of ($GPP - R_\\text{a,wood} - R_\\text{a,leaf}$) 28 frozenSoilFolREff amount that foliar resp. is shutdown if soil is frozen 0 = full shutdown, 1 = no shutdown 29 frozenSoilThreshold soil temperature below which frozenSoilFolREff and frozenSoilEff kick in \u00b0C 72 baseFineRootResp base respiration rate of fine roots $\\text{y}^{-1}$ per year rate 73 baseCoarseRootResp base respiration rate of coarse roots $\\text{y}^{-1}$ per year rate","title":"Autotrophic respiration parameters"},{"location":"parameters/#soil-respiration-parameters","text":"Symbol Parameter Name Definition Units notes 30 $K_\\text{litter}$ litterBreakdownRate rate at which litter is converted to soil / respired at 0\u00b0C and max soil moisture g C broken down * g^-1 litter C * day^-1 read in as per-year rate 31 fracLitterRespired of the litter broken down, fraction respired (the rest is transferred to soil pool) 32 $K_{dec}$ baseSoilResp Soil respiration rate at $0 ^{\\circ}\\text{C}$ and moisture saturated soil g C respired * g$^{-1}$ soil C * day$^{-1}$ read in as per-year rate 33 baseSoilRespCold soil respiration at 0\u00b0C and max soil moisture when tsoil < coldSoilThreshold g C respired * g$^{-1}$ soil C * day$^{-1}$ read in as per-year rate 34 $Q_{10s}$ soilRespQ10 Soil respiration Q10 scalar determining effect of temp on soil respiration 35 soilRespQ10Cold scalar determining effect of temp on soil resp. when tsoil < coldSoilThreshold 36 coldSoilThreshold temp. at which use baseSoilRespCold and soilRespQ10Cold \u00b0C Not used if SEASONAL_R_SOIL is 0 37 E0 E0 in Lloyd-Taylor soil respiration function Not used if LLOYD_TAYLOR is 0 38 T0 T0 in Lloyd-Taylor soil respiration function Not used if LLOYD_TAYLOR is 0 39 soilRespMoistEffect scalar determining effect of moisture on soil resp. baseMicrobeResp $R_{dec}$: Rate of decomposition $(\\text{day}^{-1})$ $Q_{10dec}$: Temperature coefficient for $R_{dec}$ (unitless)","title":"Soil respiration parameters"},{"location":"parameters/#nitrogen-cycle-parameters","text":"$K_{n,vol}$: Rate constant for volatilization (day-1) $f_{N2O_{vol}}$: Fraction of volatilization leading to N2O production $R_{min}$: Rate of mineralization (day-1) $I_\\text{N limit}$: Indicator for nitrogen limitation","title":"Nitrogen Cycle Parameters"},{"location":"parameters/#methane-parameters","text":"$R_{meth}$: Rate of methane production $(\\text{day}^{-1})$ $K_{meth}$: Rate constant for methane production under anaerobic conditions $(\\text{day}^{-1})$ $K_{methox}$: Rate constant, methane oxidation $(\\text{day}^{-1})$","title":"Methane parameters"},{"location":"parameters/#moisture-related-parameters","text":"Symbol Parameter Name Definition Units notes 40 $f_{\\text{trans,avail}}$ waterRemoveFrac fraction of plant available soil water which can be removed in one day by transpiration without water stress occurring new $f_\\text{drain,0}$ waterDrainFrac fraction of plant available soil water which can be removed in one day by drainage $d^{-1}$ default 1 for well drained soils 41 frozenSoilEff fraction of water that is available if soil is frozen (0 = none available, 1 = all still avail.) if frozenSoilEff = 0, then shut down psn. even if WATER_PSN = 0, if soil is frozen (if frozenSoilEff > 0, it has no effect if WATER_PSN = 0) 42 wueConst water use efficiency constant 43 litterWHC litter (evaporative layer) water holding capacity cm 44 soilWHC soil (transpiration layer) water holding capacity cm 45 $f_\\text{intercept} immedEvapFrac fraction of rain that is immediately intercepted & evaporated 46 fastFlowFrac fraction of water entering soil that goes directly to drainage $k_\\text{SOM,drain}$ 47 snowMelt rate at which snow melts cm water equivavlent per degree Celsius per day 48 litWaterDrainRate rate at which litter rains into lower layer when litter layer fully moisture-saturated cm water/day 49 rdConst scalar determining amount of aerodynamic resistance 50 rSoilConst1 soil resistance = e^(rSoilConst1 - rSoilConst2 * W1) , where W1 = (litterWater/litterWHC) 51 rSoilConst2 soil resistance = e^(rSoilConst1 - rSoilConst2 * W1) , where W1 = (litterWater/litterWHC) 52 m_ballBerry slope for the Ball Berry relationship","title":"Moisture-related parameters"},{"location":"parameters/#tree-physiological-parameters","text":"Symbol Parameter Name Definition Units notes 53 $SLW$ leafCSpWt g C * m^-2 leaf area 54 $C_{frac}$ cFracLeaf g leaf C * g^-1 leaf 55 $K_\\text{wood}$ woodTurnoverRate average turnover rate of woody plant C $\\text{y}^{-1}$ read in as per-year rate; leaf loss handled separately 70 $K_\\text{fine root}$ fineRootTurnoverRate turnover of fine roots $\\text{y}^{-1}$ per year rate 71 $K_\\text{coarse root}$ coarseRootTurnoverRate turnover of coarse roots yr^-1 per year rate","title":"Tree physiological parameters"},{"location":"parameters/#compile-time-parameters","text":"Parameter 0 Default Description CSV_O 0 output .out file as a CSV file ALTERNATIVE_TRANS 0 0 do we want to implement alternative transpiration? BALL_BERRY 0 0 implement a Ball Berry submodel to calculate gs from RH, CO2 and A PENMAN_MONTEITH_TRANS 0 0 implement a transpiration calculation based on the Penman-Monteith Equation GROWTH_RESP 0 0 explicitly model growth resp., rather than including with maint. resp. LLOYD_TAYLOR 0 0 use Lloyd-Taylor model for soil respiration, in which temperature sensitivity decreases at higher temperatures? SEASONAL_R_SOIL 0 && !LLOYD_TAYLOR 0 use different parameters for soil resp. (baseSoilResp and soilRespQ10) when tsoil < (some threshold)? WATER_PSN 1 1 does soil moisture affect photosynthesis? WATER_HRESP 1 1 does soil moisture affect heterotrophic respiration? DAYCENT_WATER_HRESP 0 && WATER_HRESP 0 use DAYCENT soil moisture function? MODEL_WATER 1 1 do we model soil water (and ignore soilWetness)? COMPLEX_WATER 1 && MODEL_WATER 1 do we use a more complex water submodel? (model evaporation as well as transpiration) LITTER_WATER 0 && (COMPLEX_WATER) 0 do we have a separate litter water layer, used for evaporation? LITTER_WATER_DRAINAGE 1 && (LITTER_WATER) 0 does water from the top layer drain down into bottom layer even if top layer not overflowing? SNOW (1 || (COMPLEX_WATER)) && MODEL_WATER 1 keep track of snowpack, rather than assuming all precip. is liquid GDD 0 0 use GDD to determine leaf growth? (note: mutually exclusive with SOIL_PHENOL) SOIL_PHENOL 0 && !GDD 0 use soil temp. to determine leaf growth? (note: mutually exclusive with GDD) LITTER_POOL 0 0 have extra litter pool, in addition to soil c pool SOIL_MULTIPOOL 0 && !LITTER_POOL 0 do we have a multipool approach to model soils? NUMBER_SOIL_CARBON_POOLS 3 3 number of pools we want to have. Equal to 1 if SOIL_MULTIPOOL is 0 SOIL_QUALITY 0 && SOIL_MULTIPOOL 0 do we have a soil quality submodel? MICROBES 0 && !SOIL_MULTIPOOL 0 do we utilize microbes. This will only be an option if SOIL_MULTIPOOL is 0 and MICROBES is 1 STOICHIOMETRY 0 && MICROBES 0 do we utilize stoichometric considerations for the microbial pool? ROOTS 0 0 do we model root dynamics? If no, roots are part of wood pool. If yes, split into coarse and fine roots MODIS 0 0 do we use modis FPAR data to constrain GPP? C_WEIGHT 12.0 12 molecular weight of carbon MEAN_NPP_DAYS 5 5 over how many days do we keep the running mean MEAN_NPP_MAX_ENTRIES MEAN_NPP_DAYS*50 assume that the most pts we can have is two per hour MEAN_GPP_SOIL_DAYS 5 5 over how many days do we keep the running mean MEAN_GPP_SOIL_MAX_ENTRIES MEAN_GPP_SOIL_DAYS*50 assume that the most pts we can have is one per hour LAMBDA 2501000 latent heat of vaporization (J/kg) LAMBDA_S 2835000 latent heat of sublimation (J/kg) RHO 1.3 air density (kg/m^3) CP 1005. specific heat of air (J/(kg K)) GAMMA 66 psychometric constant (Pa/K) E_STAR_SNOW 0.6 approximate saturation vapor pressure at 0\u00b0C (kPa)","title":"Compile-time parameters"},{"location":"parameters/#drivers","text":"","title":"Drivers"},{"location":"parameters/#climate","text":"For each step of the model, for each location, the following inputs are needed. These are provided in a file named <sitename>.clim with the following columns: col parameter description units notes 1 loc spatial location index maps to param-spatial file, can be 0 for a single site, as when used by PEcAn 2 year year of start of this timestep integer, e.g. 2010 3 day day of start of this timestep integer where 1 = Jan 1 4 time time of start of this timestep hours after midnight e.g. noon = 12.0, midnight = 0.0, can be a fraction 5 length length of this timestep days variable-length timesteps allowed, typically not used 6 tair avg. air temp for this time step degrees Celsius 7 tsoil average soil temperature for this time step degrees Celsius can be estimated from Tair 8 par average photosynthetically active radiation (PAR) for this time step $\\text{Einsteins} \\cdot m^{-2} \\text{ground area} \\cdot \\text{time step}^{-1}$ input is in Einsteins * m^-2 ground area, summed over entire time step 9 precip total precip. for this time step cm input is in mm; water equivilant - either rain or snow 10 vpd average vapor pressure deficit kPa input is in Pa, can be calculated from air temperature and relative humidity. 11 vpdSoil average vapor pressure deficit between soil and air kPa input is in Pa ; differs from vpd in that saturation vapor pressure is calculated using Tsoil rather than Tair 12 vPress average vapor pressure in canopy airspace kPa input is in Pa 13 wspd avg. wind speed m/s 14 soilWetness fractional soil wetness unitless (0-1) $f_\\text{WHC}$; Used if MODEL_WATER=0 ; if MODEL_WATER=1 , soil wetness is simulated","title":"Climate"},{"location":"parameters/#examples-of-climate-files","text":"Column names are not used, but are: loc year day time length tair tsoil par precip vpd vpdSoil vPress wspd soilWetness Half-hour time step 0 1998 305 0.00 -1800 1.9000 1.2719 0.0000 0.0000 109.5364 77.5454 726.6196 1.6300 0.0000 0 1998 305 0.50 -1800 1.9000 1.1832 0.0000 0.0000 109.5364 73.1254 726.6196 1.6300 0.0000 0 1998 305 1.00 -1800 2.0300 1.1171 0.0000 0.0000 110.4243 63.9567 732.5092 0.6800 0.0000 0 1998 305 1.50 -1800 2.0300 1.0439 0.0000 0.0000 110.4243 60.3450 732.5092 0.6800 0.0000 Variable time step 0 1998 305 0.00 0.292 1.5 0.8 0.0000 0.0000 105.8 70.1 711.6 0.9200 0.0000 0 1998 305 7.00 0.417 3.6 1.8 5.6016 0.0000 125.7 23.5 809.4 1.1270 0.0000 0 1998 305 17.00 0.583 1.9 1.3 0.0000 0.0000 108.1 75.9 732.7 1.1350 0.0000 0 1998 306 7.00 0.417 2.2 1.4 2.7104 1.0000 114.1 71.6 741.8 0.9690 0.0000","title":"Examples of climate files:"},{"location":"parameters/#agronomic-events","text":"For managed ecosystems, the following inputs are provided in a file named events.in with the following columns: col parameter description units notes 1 loc spatial location index maps to param-spatial file 2 year year of start of this timestep e.g. 2010 3 day day of start of this timestep Day of year 1 = Jan 1 4 event_type type of event one of plant, harv, till, fert, irrig 5...n event_param parameter associated with event see table below Agronomic events are stored in events.in, one event per row Events in the file are sorted first by location, and then chronologically Events are specified by year and day (no hourly timestamp) It is assumed that there is one (or more) records in the climate file for each location/day that appears in the events file We will throw an error if we find an event with no corresponding climate record Events are processed with the first climate record that occurs for the relevant location/day as an instantaneous one-time change We may need events with duration later, spec TBD. Tillage is likely in this bucket. The effects of an event are applied after fluxes are calculated for the current climate record; they are applied as a delta to one or more state variables, as required parameter col req? description amount 5 Y Amount added (cm/d) method 6 Y 0=canopy 1=soil 2=flood (placeholder) Model representation: an irrigation event increases soil moisture. Canopy irrigation also loses some moisture to evaporation. Specifically: - amount is listed as cm/d, but as events are specified per-day, this is treated as cm of water added on that day - For method=soil, this amount of water is added directly to the soilWater state variable - For method=canopy, a fraction of the irrigation water (determined by input param immedEvapFrac ) is added to the flux state variable immedEvap , with the remainder going to soilWater . - Initial implementation assumes that LITTER_WATER is not on. This might be revisited at a later date. Notes: - irrigation could also directly change the soil moisture content rather than adding water as a flux. This could be used to represent an irrigation program that sets a moisture range and turns irrigation on at the low end and off at the high end of the range.","title":"Agronomic Events"},{"location":"parameters/#fertilization-events","text":"parameter col req? description org-N 5 Y g N / m2 org-C 6 Y g C / m2 min-N 7 Y g N / m2 (NH4+NO3 in one pool model; NH4 in two pool model) min-N2 8 Y* g N / m2 (*not unused in one pool model, NO3 in two pool model) model representation: increases size of mineral N and litter C and N. Urea-N is assumed to be mineral N or NH4. notes: PEcAn will handle conversion from fertilizer amount and type to mass of N and C allocated to different pools","title":"Fertilization Events"},{"location":"parameters/#tillage-events","text":"parameter col req? description SOM decomposition modifier 5 Y % increase in $K_{dec}$ litter decomposition modifier 6 Y % increase in $K_{lit}$ model representation: increase k for one month, amount proportional to depth transfer litter C and N to soil pool notes: could also alter bulk density and other soil properties","title":"Tillage Events"},{"location":"parameters/#planting-events","text":"parameter col req? description leaf-C 5 Y C added to leaf pool (g C / m2) wood-C 6 Y C added to above-ground wood pool (g C / m2) fine-root-C 7 Y C added to fine root pool (g C / m2) coarse-root-C 8 Y C added to coarse root pool (g C / m2) model representation: Date of event is the date of emergence, not the date of actual planting Increases size of carbon pools by the amount of each respective parameter $N$ pools are calculated from $CN$ stoichiometric ratios. notes: PFT (crop type) is not an input parameter for a planting event because SIPNET only represents a single PFT.","title":"Planting Events"},{"location":"parameters/#harvest-events","text":"parameter col req? description fraction of aboveground biomass removed 5 Y fraction of belowground biomass removed 6 N default = 0 fraction of aboveground biomass transferred to litter pool 7 N default = 1 - removed fraction of belowground biomass transferred to litter pool 8 N default = 1 - removed model representation: biomass C and N pools are either removed or added to litter for annuals or plants terminated, no biomass remains (col 5 + col 7 = 1 and col 6 + col 8 = 1). for perennials, some biomass may remain (col 5 + col 7 <= 1 and col 6 + col 8 <= 1; remainder is living). root biomass is only removed for root crops","title":"Harvest Events"},{"location":"parameters/#example-of-events-file","text":"1 2022 40 irrig 5 1 # 5cm canopy irrigation on day 40 1 2022 40 fert 10 5 0 0 # fertilized with 10 g / m2 NO3-N and 5 g / m2 NH4-N on day 40 1 2022 35 till 0.2 0.3 # tilled on day 35, soil organic matter pool decomposition rate increases by 20% and soil litter pool decomposition rate increases by 30% 1 2022 50 plant 10 3 2 5 # plant emergence on day 50 with 10/3/2/4 g C / m2, respectively, added to the leaf/wood/fine root/coarse root pools 1 2022 250 harv 0.1 # harvest 10% of aboveground plant biomass on day 250","title":"Example of events file:"},{"location":"parameters/#outputs","text":"Symbol Parameter Name Definition Units 1 loc spatial location index 2 year year of start of this timestep 3 day day of start of this timestep 4 time time of start of this timestep 5 plantWoodC carbon in wood g C/m$^2$ 6 plantLeafC carbon in leaves g C/m$^2$ 7 soil carbon in mineral soil g C/m$^2$ 8 microbeC carbon in soil microbes g C/m$^2$ 9 coarseRootC carbon in coarse roots g C/m$^2$ 10 fineRootC carbon in fine roots g C/m$^2$ 11 litter carbon in litter g C/m$^2$ 12 litterWater moisture in litter layer cm 13 soilWater moisture in soil cm 14 $f_\\text{WHC}$ soilWetnessFrac moisture in soil as fraction 15 snow snow water cm 16 npp net primary production g C/m$^2$ 17 nee net ecosystem production g C/m$^2$ 18 cumNEE cumulative nee g C/m$^2$ 19 $GPP$ gpp gross ecosystem production g C/m$^2$ 20 $R_{A,\\text{above}}$ rAboveground plant respiration above ground g C/m$^2$ 21 $R_H$ rSoil soil respiration g C/m$^2$ 22 $R_{A\\text{, root}}$ rRoot root respiration g C/m$^2$ 23 $R$ rtot total respiration g C/m$^2$ 24 fluxestranspiration transpiration cm $F^N_\\text{vol}$ fluxesn2o Nitrous Oxide flux g N/m$^2$ / timestep $F^C_{\\text{CH}_4}$ fluxesch4 Methane Flux g C/m$^2$ / timestep $F^N_\\text{vol}$ fluxesn2o Nitrous Oxide flux g N/m$^2$ / timestep $F^C_{\\text{CH}_4}$ fluxesch4 Methane Flux g C/m$^2$ / timestep","title":"Outputs"},{"location":"developer-guide/code-structure/","text":"","title":"Code Structure"},{"location":"user-guide/running-sipnet/","text":"","title":"Running SIPNET"}]}