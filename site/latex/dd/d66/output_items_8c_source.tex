\doxysection{output\+Items.\+c}
\label{output_items_8c_source}\index{outputItems.c@{outputItems.c}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*\ outputItems:\ structures\ and\ functions\ to\ output\ single\ variables\ to\ files}}
\DoxyCodeLine{00002\ \textcolor{comment}{}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ \ \ Author:\ Bill\ Sacks}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ \ \ Creation\ date:\ 6/4/07}}
\DoxyCodeLine{00005\ \textcolor{comment}{*/}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <stdlib.h>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}outputItems.h"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}util.h"{}}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{comment}{//\ Private/helper\ functions:\ not\ defined\ in\ outputItems.h:}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{comment}{/*\ Allocate\ space\ for\ a\ new\ singleOutputItem\ structure,\ return\ a\ pointer\ to\ it}}
\DoxyCodeLine{00016\ \textcolor{comment}{\ \ \ Name\ and\ ptr\ will\ have\ the\ given\ values;\ f\ and\ nextItem\ will\ be\ NULL}}
\DoxyCodeLine{00017\ \textcolor{comment}{*/}}
\DoxyCodeLine{00018\ SingleOutputItem\ *newSingleOutputItem(\textcolor{keywordtype}{char}\ *name,\ \textcolor{keywordtype}{double}\ *ptr)\ \ \{}
\DoxyCodeLine{00019\ \ \ SingleOutputItem\ *singleOutputItem;\ }
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \ \ \textcolor{keywordflow}{if}\ (strlen(name)\ >=\ OUTPUT\_ITEMS\_MAXNAME)\ \ \{}
\DoxyCodeLine{00022\ \ \ \ \ printf(\textcolor{stringliteral}{"{}ERROR\ in\ newSingleOutputItem:\ name\ '\%s'\ exceeds\ maximum\ length\ of\ \%d\(\backslash\)n"{}},\ name,\ OUTPUT\_ITEMS\_MAXNAME);}
\DoxyCodeLine{00023\ \ \ \ \ exit(1);}
\DoxyCodeLine{00024\ \ \ \}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ singleOutputItem\ =\ (SingleOutputItem\ *)malloc(\textcolor{keyword}{sizeof}(SingleOutputItem));}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ strcpy(singleOutputItem-\/>name,\ name);}
\DoxyCodeLine{00029\ \ \ singleOutputItem-\/>ptr\ =\ ptr;}
\DoxyCodeLine{00030\ \ \ singleOutputItem-\/>f\ =\ NULL;}
\DoxyCodeLine{00031\ \ \ singleOutputItem-\/>nextItem\ =\ NULL;}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \textcolor{keywordflow}{return}\ singleOutputItem;}
\DoxyCodeLine{00034\ \}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{comment}{/*\ Open\ the\ file\ associated\ with\ this\ output\ file}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ \ \ \ -\/\ This\ file\ will\ be\ named\ <filenameBase>.<name>}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ */}\ }
\DoxyCodeLine{00040\ \textcolor{keywordtype}{void}\ openOutputItemFile(SingleOutputItem\ *singleOutputItem,\ \textcolor{keywordtype}{char}\ *filenameBase)\ \ \{}
\DoxyCodeLine{00041\ \ \ \textcolor{keywordtype}{char}\ *filename;}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ filename\ =\ (\textcolor{keywordtype}{char}\ *)malloc((strlen(filenameBase)\ +\ strlen(singleOutputItem-\/>name)\ +\ 2)\ *\ \textcolor{keyword}{sizeof}(char));}
\DoxyCodeLine{00044\ \ \ strcpy(filename,\ filenameBase);}
\DoxyCodeLine{00045\ \ \ strcat(filename,\ \textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{00046\ \ \ strcat(filename,\ singleOutputItem-\/>name);}
\DoxyCodeLine{00047\ \ \ singleOutputItem-\/>f\ =\ openFile(filename,\ \textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{00048\ \ \ }
\DoxyCodeLine{00049\ \ \ free(filename);}
\DoxyCodeLine{00050\ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \textcolor{comment}{//\ close\ the\ file\ associated\ with\ this\ output\ item}}
\DoxyCodeLine{00054\ \textcolor{keywordtype}{void}\ closeOutputItemFile(SingleOutputItem\ *singleOutputItem)\ \ \{}
\DoxyCodeLine{00055\ \ \ fclose(singleOutputItem-\/>f);}
\DoxyCodeLine{00056\ \ \ singleOutputItem-\/>f\ =\ NULL;}
\DoxyCodeLine{00057\ \}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \textcolor{comment}{/*************************************************/}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{comment}{//\ Public\ functions:\ defined\ in\ outputItems.h}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{comment}{/*\ Allocate\ space\ for\ a\ new\ outputItems\ structure,\ return\ a\ pointer\ to\ it}}
\DoxyCodeLine{00066\ \textcolor{comment}{\ \ \ filenameBase\ is\ the\ base\ name\ of\ the\ files\ to\ which\ we'll\ output}}
\DoxyCodeLine{00067\ \textcolor{comment}{\ \ \ \ -\/\ we'll\ output\ to\ <filenameBase>.<name>\ for\ each\ output\ item}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ \ \ separator\ is\ the\ character\ separating\ values\ in\ the\ output\ files\ (e.g.\ space,\ tab,\ or\ comma)}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00070\ OutputItems\ *newOutputItems(\textcolor{keywordtype}{char}\ *filenameBase,\ \textcolor{keywordtype}{char}\ separator)\ \ \{}
\DoxyCodeLine{00071\ \ \ OutputItems\ *outputItems;}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ outputItems\ =\ (OutputItems\ *)malloc(\textcolor{keyword}{sizeof}(OutputItems));}
\DoxyCodeLine{00074\ \ \ }
\DoxyCodeLine{00075\ \ \ outputItems-\/>head\ =\ newSingleOutputItem(\textcolor{stringliteral}{"{}"{}},\ NULL);\ \ \textcolor{comment}{//\ we'll\ keep\ a\ dummy\ item\ at\ the\ head\ of\ the\ list}}
\DoxyCodeLine{00076\ \ \ outputItems-\/>tail\ =\ outputItems-\/>head;}
\DoxyCodeLine{00077\ \ \ outputItems-\/>count\ =\ 0;}
\DoxyCodeLine{00078\ \ }
\DoxyCodeLine{00079\ \ \ outputItems-\/>filenameBase\ =\ (\textcolor{keywordtype}{char}\ *)malloc((strlen(filenameBase)\ +\ 1)\ *\ \textcolor{keyword}{sizeof}(char));}
\DoxyCodeLine{00080\ \ \ strcpy(outputItems-\/>filenameBase,\ filenameBase);}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ outputItems-\/>separator\ =\ separator;}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{keywordflow}{return}\ outputItems;}
\DoxyCodeLine{00085\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{comment}{/*\ Add\ a\ new\ singleOutputItem\ to\ the\ end\ of\ the\ list\ given\ by\ outputItems}}
\DoxyCodeLine{00089\ \textcolor{comment}{\ \ \ strlen(name)\ must\ be\ <\ OUTPUT\_ITEMS\_MAXNAME}}
\DoxyCodeLine{00090\ \textcolor{comment}{\ \ \ ptr\ must\ be\ a\ pointer\ to\ the\ variable\ holding\ this\ item\ (double)}}
\DoxyCodeLine{00091\ \textcolor{comment}{\ \ \ }}
\DoxyCodeLine{00092\ \textcolor{comment}{\ \ \ After\ calling\ this\ function,\ the\ file\ associated\ with\ this\ output\ item\ will\ be\ open\ for\ writing}}
\DoxyCodeLine{00093\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00094\ \textcolor{keywordtype}{void}\ addOutputItem(OutputItems\ *outputItems,\ \textcolor{keywordtype}{char}\ *name,\ \textcolor{keywordtype}{double}\ *ptr)\ \ \{}
\DoxyCodeLine{00095\ \ \ SingleOutputItem\ *singleOutputItem;}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ singleOutputItem\ =\ newSingleOutputItem(name,\ ptr);}
\DoxyCodeLine{00098\ \ \ openOutputItemFile(singleOutputItem,\ outputItems-\/>filenameBase);}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ outputItems-\/>tail-\/>nextItem\ =\ singleOutputItem;}
\DoxyCodeLine{00101\ \ \ outputItems-\/>tail\ =\ singleOutputItem;}
\DoxyCodeLine{00102\ \ \ outputItems-\/>count++;}
\DoxyCodeLine{00103\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \textcolor{comment}{/*\ For\ each\ output\ item,\ write\ a\ label,\ followed\ by\ a\ separator}}
\DoxyCodeLine{00107\ \textcolor{comment}{\ \ \ This\ is\ intended\ for\ writing\ a\ single\ label\ at\ the\ start\ of\ each\ line}}
\DoxyCodeLine{00108\ \textcolor{comment}{\ \ \ -\/\ For\ example,\ could\ write\ the\ location\ for\ spatial\ output,\ or\ the\ value\ of\ some\ variable\ for\ a\ sensitivity\ test}}
\DoxyCodeLine{00109\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00110\ \textcolor{keywordtype}{void}\ writeOutputItemLabels(OutputItems\ *outputItems,\ \textcolor{keywordtype}{char}\ *label)\ \ \{}
\DoxyCodeLine{00111\ \ \ SingleOutputItem\ *singleOutputItem;}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ singleOutputItem\ =\ outputItems-\/>head-\/>nextItem;}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordflow}{while}(singleOutputItem\ !=\ NULL)\ \ \{}
\DoxyCodeLine{00115\ \ \ \ \ fprintf(singleOutputItem-\/>f,\ \textcolor{stringliteral}{"{}\%s\%c"{}},\ label,\ outputItems-\/>separator);}
\DoxyCodeLine{00116\ \ \ \ \ singleOutputItem\ =\ singleOutputItem-\/>nextItem;}
\DoxyCodeLine{00117\ \ \ \}}
\DoxyCodeLine{00118\ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \textcolor{comment}{//\ For\ each\ output\ item,\ write\ its\ current\ value,\ followed\ by\ a\ separator}}
\DoxyCodeLine{00122\ \textcolor{keywordtype}{void}\ writeOutputItemValues(OutputItems\ *outputItems)\ \ \{}
\DoxyCodeLine{00123\ \ \ SingleOutputItem\ *singleOutputItem;}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ singleOutputItem\ =\ outputItems-\/>head-\/>nextItem;}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordflow}{while}\ (singleOutputItem\ !=\ NULL)\ \ \{}
\DoxyCodeLine{00127\ \ \ \ \ fprintf(singleOutputItem-\/>f,\ \textcolor{stringliteral}{"{}\%f\%c"{}},\ *(singleOutputItem-\/>ptr),\ outputItems-\/>separator);}
\DoxyCodeLine{00128\ \ \ \ \ singleOutputItem\ =\ singleOutputItem-\/>nextItem;}
\DoxyCodeLine{00129\ \ \ \}}
\DoxyCodeLine{00130\ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \textcolor{comment}{/*\ For\ each\ output\ item,\ write\ a\ newline}}
\DoxyCodeLine{00134\ \textcolor{comment}{\ \ \ This\ is\ intended\ to\ be\ called\ at\ the\ end\ of\ each\ run}}
\DoxyCodeLine{00135\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00136\ \textcolor{keywordtype}{void}\ terminateOutputItemLines(OutputItems\ *outputItems)\ \ \{}
\DoxyCodeLine{00137\ \ \ SingleOutputItem\ *singleOutputItem;}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ singleOutputItem\ =\ outputItems-\/>head-\/>nextItem;}
\DoxyCodeLine{00140\ \ \ \textcolor{keywordflow}{while}(singleOutputItem\ !=\ NULL)\ \ \{}
\DoxyCodeLine{00141\ \ \ \ \ fprintf(singleOutputItem-\/>f,\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00142\ \ \ \ \ singleOutputItem\ =\ singleOutputItem-\/>nextItem;}
\DoxyCodeLine{00143\ \ \ \}}
\DoxyCodeLine{00144\ \}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \textcolor{comment}{/*\ Free\ up\ space\ used\ by\ outputItems}}
\DoxyCodeLine{00148\ \textcolor{comment}{\ \ \ Also,\ close\ all\ files\ associated\ with\ the\ individual\ output\ items}}
\DoxyCodeLine{00149\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00150\ \textcolor{keywordtype}{void}\ deleteOutputItems(OutputItems\ *outputItems)\ \ \{}
\DoxyCodeLine{00151\ \ \ SingleOutputItem\ *curr,\ *temp;}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ curr\ =\ outputItems-\/>head;}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{while}\ (curr\ !=\ NULL)\ \ \{}
\DoxyCodeLine{00155\ \ \ \ \ temp\ =\ curr;}
\DoxyCodeLine{00156\ \ \ \ \ curr\ =\ curr-\/>nextItem;}
\DoxyCodeLine{00157\ \ \ \ \ }
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordflow}{if}\ (temp-\/>f\ !=\ NULL)\ \ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ closeOutputItemFile(temp);}
\DoxyCodeLine{00160\ \ \ \ \ \ \ free(temp);}
\DoxyCodeLine{00161\ \ \ \ \ \}}
\DoxyCodeLine{00162\ \ \ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ free(outputItems-\/>filenameBase);}
\DoxyCodeLine{00165\ \ \ free(outputItems);}
\DoxyCodeLine{00166\ \}}

\end{DoxyCode}
