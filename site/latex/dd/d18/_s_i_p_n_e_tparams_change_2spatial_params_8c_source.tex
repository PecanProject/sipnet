\doxysection{SIPNETparams\+Change/spatial\+Params.c}
\label{_s_i_p_n_e_tparams_change_2spatial_params_8c_source}\index{spatialParams.c@{spatialParams.c}}
\textbf{ Go to the documentation of this file.}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*\ spatialParams:\ structure\ and\ functions\ to\ track\ and\ manipulate\ parameters\ that\ may\ vary\ spatially}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ \ \ }}
\DoxyCodeLine{00003\ \textcolor{comment}{\ \ \ Author:\ Bill\ Sacks}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ \ \ }}
\DoxyCodeLine{00005\ \textcolor{comment}{\ \ \ Creation\ date:\ 8/13/04}}
\DoxyCodeLine{00006\ \textcolor{comment}{*/}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <stdlib.h>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <math.h>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}spatialParams.h"{}}\ \textcolor{comment}{//\ includes\ definition\ of\ SpatialParams\ structure,\ as\ well\ as\ OneSpatialParam\ structure}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}util.h"{}}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{comment}{//\ Private/helper\ functions:\ not\ defined\ in\ spatialParams.h}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{comment}{/*\ return\ index\ of\ next\ unread\ parameter}}
\DoxyCodeLine{00019\ \textcolor{comment}{\ \ \ if\ no\ more\ unread\ parameters,\ returns\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00020\ \textcolor{comment}{*/}}
\DoxyCodeLine{00021\ \textcolor{keywordtype}{int}\ nextUnreadParam(SpatialParams\ *spatialParams)\ \{}
\DoxyCodeLine{00022\ \ \ \textcolor{keywordtype}{int}\ paramIndex;}
\DoxyCodeLine{00023\ \ }
\DoxyCodeLine{00024\ \ \ paramIndex\ =\ 0;}
\DoxyCodeLine{00025\ \ \ \textcolor{keywordflow}{while}\ (paramIndex\ <\ spatialParams-\/>numParameters\ \&\&\ spatialParams-\/>parameters[paramIndex].value\ !=\ NULL)}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{comment}{//\ while\ we\ haven't\ reached\ the\ end\ of\ the\ parameters\ vector,\ and\ we\ haven't\ found\ an\ unitialized\ parameter}}
\DoxyCodeLine{00027\ \ \ \ \ paramIndex++;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \textcolor{keywordflow}{return}\ paramIndex;}
\DoxyCodeLine{00030\ \}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{comment}{//\ Set\ array[0..length-\/1]\ to\ all\ be\ equal\ to\ value}}
\DoxyCodeLine{00034\ \textcolor{keywordtype}{void}\ setAll(\textcolor{keywordtype}{double}\ *array,\ \textcolor{keywordtype}{int}\ length,\ \textcolor{keywordtype}{double}\ value)\ \{}
\DoxyCodeLine{00035\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ length;\ i++)}
\DoxyCodeLine{00038\ \ \ \ \ array[i]\ =\ value;}
\DoxyCodeLine{00039\ \}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{comment}{/*\ If\ isSpatial\ =\ 0,\ return\ array[0]\ (ignore\ loc)}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ \ \ Otherwise,\ return\ array[loc]}}
\DoxyCodeLine{00044\ \textcolor{comment}{*/}}
\DoxyCodeLine{00045\ \textcolor{keywordtype}{double}\ getPossiblySpatial(\textcolor{keywordtype}{double}\ *array,\ \textcolor{keywordtype}{int}\ loc,\ \textcolor{keywordtype}{int}\ isSpatial)\ \{}
\DoxyCodeLine{00046\ \ \ \textcolor{keywordflow}{if}\ (isSpatial)}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keywordflow}{return}\ array[loc];}
\DoxyCodeLine{00048\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordflow}{return}\ array[0];}
\DoxyCodeLine{00050\ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \textcolor{comment}{/*\ If\ isSpatial\ =\ 0,\ set\ array[0]\ =\ value\ (ignore\ loc)}}
\DoxyCodeLine{00054\ \textcolor{comment}{\ \ \ Otherwise,\ if\ loc\ =\ -\/1,\ set\ array[0..length-\/1]\ =\ value}}
\DoxyCodeLine{00055\ \textcolor{comment}{\ \ \ Otherwise,\ set\ array[loc]\ =\ value}}
\DoxyCodeLine{00056\ \textcolor{comment}{*/}}
\DoxyCodeLine{00057\ \textcolor{keywordtype}{void}\ setPossiblySpatial(\textcolor{keywordtype}{double}\ *array,\ \textcolor{keywordtype}{int}\ loc,\ \textcolor{keywordtype}{double}\ value,\ \textcolor{keywordtype}{int}\ isSpatial,\ \textcolor{keywordtype}{int}\ length)\ \{}
\DoxyCodeLine{00058\ \ \ \textcolor{keywordflow}{if}\ (isSpatial)\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordflow}{if}\ (loc\ ==\ -\/1)}
\DoxyCodeLine{00060\ \ \ \ \ \ \ setAll(array,\ length,\ value);}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00062\ \ \ \ \ \ \ array[loc]\ =\ value;}
\DoxyCodeLine{00063\ \ \ \}}
\DoxyCodeLine{00064\ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ non-\/spatial}}
\DoxyCodeLine{00065\ \ \ \ \ array[0]\ =\ value;}
\DoxyCodeLine{00066\ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \textcolor{comment}{/*************************************************/}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \textcolor{comment}{//\ Public\ functions:\ defined\ in\ spatialParams.h}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{comment}{//\ allocate\ space\ for\ a\ new\ spatialParams\ structure,\ return\ a\ pointer\ to\ it}}
\DoxyCodeLine{00074\ SpatialParams\ *newSpatialParams(\textcolor{keywordtype}{int}\ numParameters,\ \textcolor{keywordtype}{int}\ numLocs)\ \{}
\DoxyCodeLine{00075\ \ \ SpatialParams\ *spatialParams;}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ spatialParams\ =\ (SpatialParams\ *)malloc(\textcolor{keyword}{sizeof}(SpatialParams));}
\DoxyCodeLine{00079\ \ \ spatialParams-\/>numParameters\ =\ numParameters;}
\DoxyCodeLine{00080\ \ \ spatialParams-\/>numLocs\ =\ numLocs;}
\DoxyCodeLine{00081\ \ \ spatialParams-\/>numChangeableParams\ =\ 0;\ \textcolor{comment}{//\ for\ now,\ anyway}}
\DoxyCodeLine{00082\ \ \ }
\DoxyCodeLine{00083\ \ \ \textcolor{comment}{//\ allocate\ space\ for\ vectors\ within\ this\ structure:}}
\DoxyCodeLine{00084\ \ \ spatialParams-\/>parameters\ =\ (OneSpatialParam\ *)malloc(numParameters\ *\ \textcolor{keyword}{sizeof}(OneSpatialParam));}
\DoxyCodeLine{00085\ \ \ spatialParams-\/>changeableParamIndices\ =\ (\textcolor{keywordtype}{int}\ *)malloc(numParameters\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));\ \textcolor{comment}{//\ the\ biggest\ it\ could\ have\ to\ be}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \textcolor{comment}{//\ set\ value\ pointers\ of\ all\ parameters\ to\ be\ NULL\ (this\ will\ mark\ uninitialized\ parameter):}}
\DoxyCodeLine{00088\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ numParameters;\ i++)}
\DoxyCodeLine{00089\ \ \ \ \ spatialParams-\/>parameters[i].value\ =\ NULL;}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \textcolor{keywordflow}{return}\ spatialParams;}
\DoxyCodeLine{00092\ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \textcolor{comment}{//\ return\ 1\ if\ all\ parameters\ have\ been\ read\ in,\ 0\ if\ not}}
\DoxyCodeLine{00096\ \textcolor{keywordtype}{int}\ allParamsRead(SpatialParams\ *spatialParams)\ \{}
\DoxyCodeLine{00097\ \ \ \textcolor{keywordflow}{if}\ (nextUnreadParam(spatialParams)\ ==\ spatialParams-\/>numParameters)\ \textcolor{comment}{//\ all\ parameters\ have\ been\ read}}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;\ }
\DoxyCodeLine{00099\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00101\ \}}
\DoxyCodeLine{00102\ \ \ }
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \textcolor{comment}{/*\ Read\ next\ parameter\ from\ file,\ setting\ all\ values\ in\ spatialParams\ structure\ appropriately}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ \ \ Ensure\ that\ name\ is\ the\ name\ of\ the\ parameter\ we're\ reading}}
\DoxyCodeLine{00106\ \textcolor{comment}{\ \ \ Set\ this\ parameter's\ externalLoc\ pointer\ to\ point\ to\ the\ location\ given\ by\ the\ externalLoc\ parameter}}
\DoxyCodeLine{00107\ \textcolor{comment}{\ \ \ Note:\ acceptable\ to\ have\ externalLoc\ =\ NULL,\ but\ then\ (obviously)\ won't\ be\ assigned\ by\ loadSpatialParams}}
\DoxyCodeLine{00108\ \textcolor{comment}{}}
\DoxyCodeLine{00109\ \textcolor{comment}{\ \ \ Structure\ of\ paramFile:}}
\DoxyCodeLine{00110\ \textcolor{comment}{\ \ \ \ \ \ name\ \ value\ \ changeable\ \ min\ \ max\ \ sigma}}
\DoxyCodeLine{00111\ \textcolor{comment}{\ \ \ where\ value\ is\ a\ number\ if\ parameter\ is\ non-\/spatial,\ or\ *\ if\ parameter\ is\ spatial;\ changeable\ is\ 0\ or\ 1\ (boolean)}}
\DoxyCodeLine{00112\ \textcolor{comment}{\ \ \ If\ parameter\ is\ spatial,\ look\ in\ spatialParamFile\ for\ value,\ which\ has\ the\ following\ structure:}}
\DoxyCodeLine{00113\ \textcolor{comment}{\ \ \ \ \ \ name\ \ value\ \ [value\ \ value...]}}
\DoxyCodeLine{00114\ \textcolor{comment}{\ \ \ where\ the\ number\ of\ values\ is\ equal\ to\ the\ number\ of\ spatial\ locations}}
\DoxyCodeLine{00115\ \textcolor{comment}{}}
\DoxyCodeLine{00116\ \textcolor{comment}{\ \ \ PRE:\ paramFile\ is\ open\ and\ file\ pointer\ points\ to\ the\ next\ parameter\ to\ be\ read}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ this\ is\ a\ spatial\ parameter,\ spatialParamFile\ is\ open\ and\ file\ pointer\ points\ to\ the\ next\ parameter\ to\ be\ read}}
\DoxyCodeLine{00118\ \textcolor{comment}{*/}}
\DoxyCodeLine{00119\ \textcolor{keywordtype}{void}\ readOneSpatialParam(SpatialParams\ *spatialParams,\ FILE\ *paramFile,\ FILE\ *spatialParamFile,\ \textcolor{keywordtype}{char}\ *name,\ \textcolor{keywordtype}{double}\ *externalLoc)\ \{}
\DoxyCodeLine{00120\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *TOKENS\ =\ \textcolor{stringliteral}{"{}\ \(\backslash\)t"{}};\ \textcolor{comment}{//\ tokens\ that\ can\ separate\ values\ in\ spatialParams\ file\ (space\ \&\ tab)}}
\DoxyCodeLine{00121\ \ \ }
\DoxyCodeLine{00122\ \ \ \textcolor{keywordtype}{char}\ line[256];}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordtype}{char}\ pName[64];\ \textcolor{comment}{//\ parameter\ name}}
\DoxyCodeLine{00124\ \ \ \textcolor{keywordtype}{char}\ strValue[32];\ \textcolor{comment}{//\ before\ we\ know\ whether\ value\ is\ a\ number\ or\ "{}*"{}}}
\DoxyCodeLine{00125\ \ \ \textcolor{keywordtype}{double}\ value,\ min,\ max,\ sigma;}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordtype}{int}\ changeable;}
\DoxyCodeLine{00127\ \ \ \textcolor{keywordtype}{char}\ *errc;}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordtype}{int}\ status;}
\DoxyCodeLine{00129\ \ \ \textcolor{keywordtype}{int}\ paramIndex;\ \textcolor{comment}{//\ index\ of\ next\ uninitialized\ parameter}}
\DoxyCodeLine{00130\ \ \ OneSpatialParam\ *param;\ \textcolor{comment}{//\ a\ pointer\ to\ the\ next\ uninitialized\ parameter}}
\DoxyCodeLine{00131\ \ \ \textcolor{keywordtype}{int}\ numLocs,\ i;}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \textcolor{keywordflow}{if}\ (allParamsRead(spatialParams))\ \{\ \textcolor{comment}{//\ all\ parameters\ have\ been\ read}}
\DoxyCodeLine{00134\ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error\ trying\ to\ read\ \%s:\ no\ more\ uninitialized\ parameters\ to\ fill\(\backslash\)n"{}},\ name);}
\DoxyCodeLine{00135\ \ \ \ \ exit(1);}
\DoxyCodeLine{00136\ \ \ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \textcolor{comment}{//\ otherwise,\ get\ the\ index\ of\ the\ next\ uninitialized\ parameter}}
\DoxyCodeLine{00139\ \ \ paramIndex\ =\ nextUnreadParam(spatialParams);}
\DoxyCodeLine{00140\ \ \ \textcolor{comment}{//\ and\ set\ param\ to\ point\ to\ it\ for\ easier\ access}}
\DoxyCodeLine{00141\ \ \ param\ =\ \&(spatialParams-\/>parameters[paramIndex]);}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{comment}{//\ read\ next\ line:}}
\DoxyCodeLine{00144\ \ \ \textcolor{keywordflow}{if}\ (fgets(line,\ \textcolor{keyword}{sizeof}(line),\ paramFile)\ ==\ NULL)\ \{}
\DoxyCodeLine{00145\ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error\ trying\ to\ read\ \%s:\ error\ or\ unexpected\ EOF\ in\ parameter\ file\(\backslash\)n"{}},\ name);}
\DoxyCodeLine{00146\ \ \ \ \ printf(\textcolor{stringliteral}{"{}feof\ =\ \%d,\ ferror\ =\ \%d\(\backslash\)n"{}},\ feof(paramFile),\ ferror(paramFile));}
\DoxyCodeLine{00147\ \ \ \ \ exit(1);}
\DoxyCodeLine{00148\ \ \ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \textcolor{comment}{//\ tokenize\ line:}}
\DoxyCodeLine{00151\ \ \ strcpy(pName,\ strtok(line,\ TOKENS));\ \textcolor{comment}{//\ copy\ first\ token\ into\ pName}}
\DoxyCodeLine{00152\ \ \ \textcolor{keywordflow}{if}\ (strcasecmp(pName,\ name)\ !=0)\ \{\ \textcolor{comment}{//\ compare,\ ignore\ case}}
\DoxyCodeLine{00153\ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error:\ read\ \%s,\ expected\ \%s\(\backslash\)n"{}},\ pName,\ name);}
\DoxyCodeLine{00154\ \ \ \ \ exit(1);}
\DoxyCodeLine{00155\ \ \ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \textcolor{comment}{//\ continue\ to\ tokenize:}}
\DoxyCodeLine{00158\ \ \ strcpy(strValue,\ strtok(NULL,\ TOKENS));\ \textcolor{comment}{//\ copy\ next\ token\ into\ strValue;\ wait\ until\ later\ to\ figure\ out\ if\ it's\ "{}*"{}\ or\ a\ number}}
\DoxyCodeLine{00159\ \ \ changeable\ =\ strtol(strtok(NULL,\ TOKENS),\ \&errc,\ 0);}
\DoxyCodeLine{00160\ \ \ min\ =\ strtod(strtok(NULL,\ TOKENS),\ \&errc);}
\DoxyCodeLine{00161\ \ \ max\ =\ strtod(strtok(NULL,\ TOKENS),\ \&errc);}
\DoxyCodeLine{00162\ \ \ sigma\ =\ strtod(strtok(NULL,\ TOKENS),\ \&errc);}
\DoxyCodeLine{00163\ \ \ }
\DoxyCodeLine{00164\ \ \ \textcolor{comment}{//\ fill\ the\ new\ spatialParam\ structure\ with\ everything\ but\ numLocs,\ value,\ guess,\ best,\ and\ knob\ (which\ we'll\ do\ later)}}
\DoxyCodeLine{00165\ \ \ strcpy(param-\/>name,\ pName);}
\DoxyCodeLine{00166\ \ \ param-\/>isChangeable\ =\ changeable;}
\DoxyCodeLine{00167\ \ \ param-\/>externalLoc\ =\ externalLoc;}
\DoxyCodeLine{00168\ \ \ param-\/>min\ =\ min;}
\DoxyCodeLine{00169\ \ \ param-\/>max\ =\ max;}
\DoxyCodeLine{00170\ \ \ param-\/>sigma\ =\ sigma;}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \textcolor{keywordflow}{if}\ (changeable)\ \{\ \textcolor{comment}{//\ we\ need\ to\ update\ info\ on\ changeable\ params\ in\ spatialParams}}
\DoxyCodeLine{00173\ \ \ \ \ spatialParams-\/>changeableParamIndices[spatialParams-\/>numChangeableParams]\ =\ paramIndex;}
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{comment}{//\ before\ we\ change\ it,\ spatialParams-\/>numChangeableParams\ is\ the\ index\ of\ the\ first\ free\ spot\ in\ the\ changeableParamIndices\ vector}}
\DoxyCodeLine{00175\ \ \ \ \ spatialParams-\/>numChangeableParams++;}
\DoxyCodeLine{00176\ \ \ \}}
\DoxyCodeLine{00177\ \ \ }
\DoxyCodeLine{00178\ \ \ \textcolor{comment}{//\ now\ we\ need\ to\ see\ if\ we\ read\ in\ an\ actual\ value,\ or\ a\ "{}*"{}\ (if\ the\ latter,\ it's\ a\ spatially-\/varying\ parameter)}}
\DoxyCodeLine{00179\ \ \ \textcolor{keywordflow}{if}\ (strcmp(strValue,\ \textcolor{stringliteral}{"{}*"{}})\ ==\ 0)\ \{\ \textcolor{comment}{//\ we\ read\ "{}*"{}:\ this\ is\ a\ spatially-\/varying\ parameter}}
\DoxyCodeLine{00180\ \ \ \ \ numLocs\ =\ param-\/>numLocs\ =\ spatialParams-\/>numLocs;}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{comment}{//\ read\ info\ from\ spatialParamFile:}}
\DoxyCodeLine{00183\ \ \ \ \ status\ =\ fscanf(spatialParamFile,\ \textcolor{stringliteral}{"{}\%s"{}},\ pName);}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{keywordflow}{if}\ (status\ ==\ EOF\ ||\ status\ ==\ 0)\ \{\ \textcolor{comment}{//\ error\ reading}}
\DoxyCodeLine{00185\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error\ trying\ to\ read\ \%s\ from\ spatialParamFile\(\backslash\)n"{}},\ name);}
\DoxyCodeLine{00186\ \ \ \ \ \ \ exit(1);}
\DoxyCodeLine{00187\ \ \ \ \ \}}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (strcasecmp(pName,\ name)\ !=\ 0)\ \{\ \textcolor{comment}{//\ compare,\ ignore\ case}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error:\ read\ \%s\ from\ spatialParamFile,\ expected\ \%s\(\backslash\)n"{}},\ pName,\ name);}
\DoxyCodeLine{00190\ \ \ \ \ \ \ exit(1);}
\DoxyCodeLine{00191\ \ \ \ \ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{comment}{//\ we've\ read\ correct\ name,\ now\ read\ all\ the\ values:}}
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{comment}{//\ first,\ allocate\ space:}}
\DoxyCodeLine{00195\ \ \ \ \ param-\/>value\ =\ (\textcolor{keywordtype}{double}\ *)malloc(numLocs\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00196\ \ \ \ \ param-\/>guess\ =\ (\textcolor{keywordtype}{double}\ *)malloc(numLocs\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00197\ \ \ \ \ param-\/>best\ =\ (\textcolor{keywordtype}{double}\ *)malloc(numLocs\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00198\ \ \ \ \ param-\/>knob\ =\ (\textcolor{keywordtype}{double}\ *)malloc(numLocs\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{comment}{//\ now\ read\ values\ and\ assign\ param-\/>value,\ guess,\ best,\ and\ knob:}}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ numLocs;\ i++)\ \{}
\DoxyCodeLine{00202\ \ \ \ \ \ \ status\ =\ fscanf(spatialParamFile,\ \textcolor{stringliteral}{"{}\%lf"{}},\ \&value);}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (status\ ==\ EOF\ ||\ status\ ==\ 0)\ \{\ \textcolor{comment}{//\ error\ reading}}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error:\ did\ not\ find\ enough\ values\ in\ spatialParamFile\ for\ \%s\(\backslash\)n"{}},\ pName);}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ exit(1);}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ \ \ \textcolor{comment}{//\ assign\ value,\ guess\ and\ best\ to\ all\ be\ the\ guess\ value\ initially:}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ param-\/>value[i]\ =\ param-\/>guess[i]\ =\ param-\/>best[i]\ =\ value;}
\DoxyCodeLine{00210\ \ \ \ \ \ \ param-\/>knob[i]\ =\ 0;\ \textcolor{comment}{//\ assign\ knob\ to\ be\ 0\ initially}}
\DoxyCodeLine{00211\ \ \ \ \ \}\ \textcolor{comment}{//\ for\ i}}
\DoxyCodeLine{00212\ \ \ \}\ \textcolor{comment}{//\ if\ spatially-\/varying}}
\DoxyCodeLine{00213\ \ \ \textcolor{keywordflow}{else}\ \{\ \textcolor{comment}{//\ non-\/spatially-\/varying\ parameter}}
\DoxyCodeLine{00214\ \ \ \ \ param-\/>numLocs\ =\ 0;\ \textcolor{comment}{//\ signifies\ non-\/spatially-\/varying}}
\DoxyCodeLine{00215\ \ \ \ \ }
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{comment}{//\ allocate\ space\ for\ a\ single\ value\ in\ each\ of\ param-\/>value,\ guess,\ best\ and\ knob:}}
\DoxyCodeLine{00217\ \ \ \ \ param-\/>value\ =\ (\textcolor{keywordtype}{double}\ *)malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00218\ \ \ \ \ param-\/>guess\ =\ (\textcolor{keywordtype}{double}\ *)malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00219\ \ \ \ \ param-\/>best\ =\ (\textcolor{keywordtype}{double}\ *)malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00220\ \ \ \ \ param-\/>knob\ =\ (\textcolor{keywordtype}{double}\ *)malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{comment}{//\ assign\ value,\ guess\ and\ best\ to\ all\ be\ the\ guess\ value\ initially:}}
\DoxyCodeLine{00223\ \ \ \ \ value\ =\ strtod(strValue,\ \&errc);\ \textcolor{comment}{//\ convert\ string\ value\ to\ double}}
\DoxyCodeLine{00224\ \ \ \ \ param-\/>value[0]\ =\ param-\/>guess[0]\ =\ param-\/>best[0]\ =\ value;}
\DoxyCodeLine{00225\ \ \ \ \ param-\/>knob[0]\ =\ 0;\ \textcolor{comment}{//\ assign\ knob\ to\ be\ 0\ initially}}
\DoxyCodeLine{00226\ \ \ \}\ \textcolor{comment}{//\ else\ non-\/spatially-\/varying}}
\DoxyCodeLine{00227\ \ \ }
\DoxyCodeLine{00228\ \}\ \textcolor{comment}{//\ readOneSpatialParam}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \textcolor{comment}{/*\ Return\ 1\ if\ parameter\ i\ varies\ spatially,\ 0\ if\ not}}
\DoxyCodeLine{00232\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00233\ \textcolor{comment}{*/}}
\DoxyCodeLine{00234\ \textcolor{keywordtype}{int}\ isSpatial(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i)\ \{}
\DoxyCodeLine{00235\ \ \ \textcolor{keywordflow}{return}\ (spatialParams-\/>parameters[i].numLocs\ >\ 0);}
\DoxyCodeLine{00236\ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \textcolor{comment}{/*\ Return\ 1\ if\ parameter\ i\ is\ changeable,\ 0\ if\ not}}
\DoxyCodeLine{00240\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters\ }}
\DoxyCodeLine{00241\ \textcolor{comment}{*/}}
\DoxyCodeLine{00242\ \textcolor{keywordtype}{int}\ isChangeable(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i)\ \{}
\DoxyCodeLine{00243\ \ \ \textcolor{keywordflow}{return}\ spatialParams-\/>parameters[i].isChangeable;}
\DoxyCodeLine{00244\ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \textcolor{comment}{/*\ Check\ to\ see\ whether\ value\ is\ within\ allowable\ range\ of\ parameter\ i}}
\DoxyCodeLine{00248\ \textcolor{comment}{\ \ \ Return\ 1\ if\ okay,\ 0\ if\ bad}}
\DoxyCodeLine{00249\ \textcolor{comment}{*/}}
\DoxyCodeLine{00250\ \textcolor{keywordtype}{int}\ checkSpatialParam(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{double}\ value)\ \{}
\DoxyCodeLine{00251\ \ \ \textcolor{keywordflow}{return}\ (value\ >=\ getSpatialParamMin(spatialParams,\ i)\ \&\&\ value\ <=\ getSpatialParamMax(spatialParams,\ i));}
\DoxyCodeLine{00252\ \}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \textcolor{comment}{/*\ Return\ value\ of\ parameter\ i,\ location\ loc\ (if\ this\ parameter\ is\ non-\/spatial,\ ignore\ loc)\ }}
\DoxyCodeLine{00256\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00257\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ this\ parameter\ is\ spatial,\ then\ 0\ <=\ loc\ <\ spatialParams-\/>numLocs}}
\DoxyCodeLine{00258\ \textcolor{comment}{*/}}
\DoxyCodeLine{00259\ \textcolor{keywordtype}{double}\ getSpatialParam(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ loc)\ \{}
\DoxyCodeLine{00260\ \ \ \textcolor{keywordflow}{return}\ getPossiblySpatial(spatialParams-\/>parameters[i].value,\ loc,\ isSpatial(spatialParams,\ i));}
\DoxyCodeLine{00261\ \}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \textcolor{comment}{/*\ Set\ parameter\ i,\ location\ loc\ to\ have\ given\ value}}
\DoxyCodeLine{00265\ \textcolor{comment}{\ \ \ If\ parameter\ is\ non-\/spatial,\ ignore\ loc}}
\DoxyCodeLine{00266\ \textcolor{comment}{\ \ \ If\ loc\ =\ -\/1,\ set\ this\ parameter\ at\ ALL\ LOCATIONS\ to\ have\ given\ value}}
\DoxyCodeLine{00267\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00268\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ this\ parameter\ is\ spatial,\ then\ -\/1\ <=\ loc\ <\ spatialParams-\/>numLocs}}
\DoxyCodeLine{00269\ \textcolor{comment}{*/}}
\DoxyCodeLine{00270\ \textcolor{keywordtype}{void}\ setSpatialParam(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ loc,\ \textcolor{keywordtype}{double}\ value)\ \{}
\DoxyCodeLine{00271\ \ \ setPossiblySpatial(spatialParams-\/>parameters[i].value,\ loc,\ value,\ isSpatial(spatialParams,\ i),\ spatialParams-\/>numLocs);}
\DoxyCodeLine{00272\ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \textcolor{comment}{/*\ Return\ guess\ value\ of\ parameter\ i,\ location\ loc\ (if\ this\ parameter\ is\ non-\/spatial,\ ignore\ loc)}}
\DoxyCodeLine{00276\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00277\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ this\ parameter\ is\ spatial,\ then\ 0\ <=\ loc\ <\ spatialParams-\/>numLocs}}
\DoxyCodeLine{00278\ \textcolor{comment}{*/}}
\DoxyCodeLine{00279\ \textcolor{keywordtype}{double}\ getSpatialParamGuess(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ loc)\ \{}
\DoxyCodeLine{00280\ \ \ \textcolor{keywordflow}{return}\ getPossiblySpatial(spatialParams-\/>parameters[i].guess,\ loc,\ isSpatial(spatialParams,\ i));}
\DoxyCodeLine{00281\ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \textcolor{comment}{/*\ Return\ min.\ value\ of\ range\ of\ parameter\ i\ (note:\ this\ is\ constant\ across\ space)}}
\DoxyCodeLine{00285\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00286\ \textcolor{comment}{*/}}
\DoxyCodeLine{00287\ \textcolor{keywordtype}{double}\ getSpatialParamMin(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i)\ \{}
\DoxyCodeLine{00288\ \ \ \textcolor{keywordflow}{return}\ spatialParams-\/>parameters[i].min;}
\DoxyCodeLine{00289\ \}}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \textcolor{comment}{/*\ Return\ max.\ value\ of\ range\ of\ parameter\ i\ (note:\ this\ is\ constant\ across\ space)}}
\DoxyCodeLine{00293\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00294\ \textcolor{comment}{*/}}
\DoxyCodeLine{00295\ \textcolor{keywordtype}{double}\ getSpatialParamMax(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i)\ \{}
\DoxyCodeLine{00296\ \ \ \textcolor{keywordflow}{return}\ spatialParams-\/>parameters[i].max;}
\DoxyCodeLine{00297\ \}}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \textcolor{comment}{/*\ Return\ sigma\ value\ of\ parameter\ i\ (note:\ this\ is\ constant\ across\ space)}}
\DoxyCodeLine{00301\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00302\ \textcolor{comment}{*/}}
\DoxyCodeLine{00303\ \textcolor{keywordtype}{double}\ getSpatialParamSigma(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i)\ \{}
\DoxyCodeLine{00304\ \ \ \textcolor{keywordflow}{return}\ spatialParams-\/>parameters[i].sigma;}
\DoxyCodeLine{00305\ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \textcolor{comment}{/*\ Return\ knob\ value\ of\ parameter\ i,\ location\ loc\ (if\ this\ parameter\ is\ non-\/spatial,\ ignore\ loc)}}
\DoxyCodeLine{00309\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00310\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ this\ parameter\ is\ spatial,\ then\ 0\ <=\ loc\ <\ spatialParams-\/>numLocs}}
\DoxyCodeLine{00311\ \textcolor{comment}{*/}}
\DoxyCodeLine{00312\ \textcolor{keywordtype}{double}\ getSpatialParamKnob(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ loc)\ \{}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{return}\ getPossiblySpatial(spatialParams-\/>parameters[i].knob,\ loc,\ isSpatial(spatialParams,\ i));}
\DoxyCodeLine{00314\ \}}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \textcolor{comment}{/*\ Set\ "{}knob"{}\ of\ parameter\ i,\ location\ loc\ to\ have\ given\ value}}
\DoxyCodeLine{00318\ \textcolor{comment}{\ \ \ If\ parameter\ is\ non-\/spatial,\ ignore\ loc}}
\DoxyCodeLine{00319\ \textcolor{comment}{\ \ \ If\ loc\ =\ -\/1,\ set\ knob\ value\ of\ this\ parameter\ at\ ALL\ LOCATIONS\ to\ have\ given\ value}}
\DoxyCodeLine{00320\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00321\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ this\ parameter\ is\ spatial,\ then\ -\/1\ <=\ loc\ <\ spatialParams-\/>numLocs}}
\DoxyCodeLine{00322\ \textcolor{comment}{*/}}
\DoxyCodeLine{00323\ \textcolor{keywordtype}{void}\ setSpatialParamKnob(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ loc,\ \textcolor{keywordtype}{double}\ value)\ \{}
\DoxyCodeLine{00324\ \ \ setPossiblySpatial(spatialParams-\/>parameters[i].knob,\ loc,\ value,\ isSpatial(spatialParams,\ i),\ spatialParams-\/>numLocs);}
\DoxyCodeLine{00325\ \}}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \textcolor{comment}{/*\ Return\ best\ value\ of\ parameter\ i,\ location\ loc\ (if\ this\ parameter\ is\ non-\/spatial,\ ignore\ loc)}}
\DoxyCodeLine{00329\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00330\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ this\ parameter\ is\ spatial,\ then\ 0\ <=\ loc\ <\ spatialParams-\/>numLocs}}
\DoxyCodeLine{00331\ \textcolor{comment}{*/}}
\DoxyCodeLine{00332\ \textcolor{keywordtype}{double}\ getSpatialParamBest(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ loc)\ \{}
\DoxyCodeLine{00333\ \ \ \textcolor{keywordflow}{return}\ getPossiblySpatial(spatialParams-\/>parameters[i].best,\ loc,\ isSpatial(spatialParams,\ i));}
\DoxyCodeLine{00334\ \}}
\DoxyCodeLine{00335\ }
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \textcolor{comment}{/*\ Set\ best\ value\ of\ parameter\ i,\ location\ loc\ to\ have\ given\ value}}
\DoxyCodeLine{00338\ \textcolor{comment}{\ \ \ If\ parameter\ is\ non-\/spatial,\ ignore\ loc}}
\DoxyCodeLine{00339\ \textcolor{comment}{\ \ \ If\ loc\ =\ -\/1,\ set\ best\ value\ of\ this\ parameter\ at\ ALL\ LOCATIONS\ to\ have\ given\ value}}
\DoxyCodeLine{00340\ \textcolor{comment}{\ \ \ PRE:\ 0\ <=\ i\ <\ spatialParams-\/>numParameters}}
\DoxyCodeLine{00341\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ this\ parameter\ is\ spatial,\ then\ -\/1\ <=\ loc\ <\ spatialParams-\/>numLocs}}
\DoxyCodeLine{00342\ \textcolor{comment}{*/}}
\DoxyCodeLine{00343\ \textcolor{keywordtype}{void}\ setSpatialParamBest(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ loc,\ \textcolor{keywordtype}{double}\ value)\ \{}
\DoxyCodeLine{00344\ \ \ setPossiblySpatial(spatialParams-\/>parameters[i].best,\ loc,\ value,\ isSpatial(spatialParams,\ i),\ spatialParams-\/>numLocs);}
\DoxyCodeLine{00345\ \}}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \textcolor{comment}{/*\ Set\ best\ value\ of\ all\ parameters\ at\ given\ location\ to\ be\ equal\ to\ their\ current\ value}}
\DoxyCodeLine{00349\ \textcolor{comment}{\ \ \ If\ loc\ =\ -\/1,\ set\ best\ value\ of\ all\ parameters\ at\ ALL\ locations\ to\ be\ equal\ to\ their\ current\ value}}
\DoxyCodeLine{00350\ \textcolor{comment}{*/}}
\DoxyCodeLine{00351\ \textcolor{keywordtype}{void}\ setAllSpatialParamBests(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ loc)\ \{}
\DoxyCodeLine{00352\ \ \ \textcolor{keywordtype}{int}\ numParams;}
\DoxyCodeLine{00353\ \ \ \textcolor{keywordtype}{int}\ firstLoc,\ lastLoc;}
\DoxyCodeLine{00354\ \ \ \textcolor{keywordtype}{int}\ i,\ currLoc;}
\DoxyCodeLine{00355\ \ \ \textcolor{keywordtype}{double}\ value;}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ numParams\ =\ spatialParams-\/>numParameters;}
\DoxyCodeLine{00358\ \ \ \textcolor{keywordflow}{if}\ (loc\ ==\ -\/1)\ \{\ \textcolor{comment}{//\ set\ best\ at\ all\ locations}}
\DoxyCodeLine{00359\ \ \ \ \ firstLoc\ =\ 0;}
\DoxyCodeLine{00360\ \ \ \ \ lastLoc\ =\ spatialParams-\/>numLocs\ -\/\ 1;}
\DoxyCodeLine{00361\ \ \ \}}
\DoxyCodeLine{00362\ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ set\ best\ at\ a\ single\ location}}
\DoxyCodeLine{00363\ \ \ \ \ firstLoc\ =\ lastLoc\ =\ loc;}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ numParams;\ i++)\ \{}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordflow}{if}\ (isSpatial(spatialParams,\ i))\ \{}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (currLoc\ =\ firstLoc;\ currLoc\ <=\ lastLoc;\ currLoc++)\ \{}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ value\ =\ getSpatialParam(spatialParams,\ i,\ currLoc);}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ setSpatialParamBest(spatialParams,\ i,\ currLoc,\ value);}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00371\ \ \ \ \ \}}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordflow}{else}\ \{\ \textcolor{comment}{//\ non-\/spatial}}
\DoxyCodeLine{00373\ \ \ \ \ \ \ value\ =\ getSpatialParam(spatialParams,\ i,\ 0);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ setSpatialParamBest(spatialParams,\ i,\ 0,\ value);}
\DoxyCodeLine{00375\ \ \ \ \ \}}
\DoxyCodeLine{00376\ \ \ \}}
\DoxyCodeLine{00377\ \}}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \textcolor{comment}{/*\ Return\ the\ index\ (into\ spatialParams-\/>parameters)\ of\ a\ randomly-\/chosen\ spatial\ parameter\ that\ is\ changeable\ }}
\DoxyCodeLine{00381\ \textcolor{comment}{\ \ \ PRE:\ random\ number\ generator\ has\ been\ seeded}}
\DoxyCodeLine{00382\ \textcolor{comment}{*/}}
\DoxyCodeLine{00383\ \textcolor{keywordtype}{int}\ randomChangeableSpatialParam(SpatialParams\ *spatialParams)\ \{}
\DoxyCodeLine{00384\ \ \ \textcolor{keywordtype}{int}\ rnd;\ }
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ rnd\ =\ (int)\ floor(spatialParams-\/>numChangeableParams\ *\ (rand()*1.0/(RAND\_MAX\ +\ 1.0)));\ \textcolor{comment}{//\ 0\ <=\ rnd\ <\ spatialParams-\/>numChangeableParams}}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00388\ \ \ \textcolor{keywordflow}{return}\ spatialParams-\/>changeableParamIndices[rnd];\ }
\DoxyCodeLine{00389\ \}}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \textcolor{comment}{/*\ Load\ spatial\ parameters\ into\ memory\ locations\ pointed\ to\ by\ paramPtrs}}
\DoxyCodeLine{00393\ \textcolor{comment}{\ \ \ For\ spatially-\/varying\ parameters,\ load\ value\ at\ location\ given\ by\ loc}}
\DoxyCodeLine{00394\ \textcolor{comment}{\ \ \ (Purpose:\ load\ all\ parameters\ into\ a\ localized\ structure\ for\ a\ model\ run,\ to\ make\ the\ model\ run\ more\ efficient)}}
\DoxyCodeLine{00395\ \textcolor{comment}{\ \ \ }}
\DoxyCodeLine{00396\ \textcolor{comment}{\ \ \ PRE:\ spatialParams-\/>parameters\ is\ loaded\ with\ param.\ values\ (particularly,\ at\ given\ location)}}
\DoxyCodeLine{00397\ \textcolor{comment}{\ \ \ \ \ \ \ \ externalLoc\ pointers\ have\ been\ set\ for\ each\ parameter}}
\DoxyCodeLine{00398\ \textcolor{comment}{\ \ \ \ \ \ \ \ 0\ <=\ loc\ <\ spatialParams-\/>numLocs}}
\DoxyCodeLine{00399\ \textcolor{comment}{*/}}
\DoxyCodeLine{00400\ \textcolor{keywordtype}{void}\ loadSpatialParams(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ loc)\ \{}
\DoxyCodeLine{00401\ \ \ \textcolor{keywordtype}{int}\ i,\ numParams;}
\DoxyCodeLine{00402\ \ \ \textcolor{keywordtype}{double}\ value;}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ numParams\ =\ spatialParams-\/>numParameters;}
\DoxyCodeLine{00405\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ numParams;\ i++)\ \{}
\DoxyCodeLine{00406\ \ \ \ \ \textcolor{comment}{//\ value\ will\ equal\ NULL\ if\ it\ hasn't\ been\ set\ yet;\ externalLoc\ will\ equal\ NULL\ if\ it\ was\ assigned\ to\ NULL\ in\ readOneSpatialParam}}
\DoxyCodeLine{00407\ \ \ \ \ \textcolor{keywordflow}{if}\ (spatialParams-\/>parameters[i].value\ !=\ NULL\ \&\&\ spatialParams-\/>parameters[i].externalLoc\ !=\ NULL)\ \{\ }
\DoxyCodeLine{00408\ \ \ \ \ \ \ value\ =\ getSpatialParam(spatialParams,\ i,\ loc);}
\DoxyCodeLine{00409\ \ \ \ \ \ \ *(spatialParams-\/>parameters[i].externalLoc)\ =\ value;\ \textcolor{comment}{//\ copy\ value\ into\ location\ pointed\ to\ by\ this\ externalLoc}}
\DoxyCodeLine{00410\ \ \ \ \ \}}
\DoxyCodeLine{00411\ \ \ \}}
\DoxyCodeLine{00412\ \}}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \textcolor{comment}{/*\ If\ randomReset\ =\ 0,\ set\ values\ of\ all\ parameters\ to\ be\ equal\ to\ guess\ values}}
\DoxyCodeLine{00416\ \textcolor{comment}{\ \ \ If\ randomReset\ non-\/zero,\ set\ parameter\ values\ to\ be\ somewhere\ (chosen\ uniform\ randomly)\ between\ min\ and\ max}}
\DoxyCodeLine{00417\ \textcolor{comment}{\ \ \ (If\ randomReset\ non-\/zero,\ random\ number\ generator\ must\ have\ been\ seeded)}}
\DoxyCodeLine{00418\ \textcolor{comment}{\ \ \ Set\ best\ values\ of\ all\ parameters\ to\ be\ equal\ to\ current\ values}}
\DoxyCodeLine{00419\ \textcolor{comment}{\ \ \ Set\ knobs\ of\ all\ parameters\ to\ be\ equal\ to\ knob\ argument}}
\DoxyCodeLine{00420\ \textcolor{comment}{*/}}
\DoxyCodeLine{00421\ \textcolor{keywordtype}{void}\ resetSpatialParams(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{double}\ knob,\ \textcolor{keywordtype}{int}\ randomReset)\ \{}
\DoxyCodeLine{00422\ \ \ \textcolor{keywordtype}{int}\ numParams,\ numLocs;}
\DoxyCodeLine{00423\ \ \ \textcolor{keywordtype}{int}\ i,\ loc;}
\DoxyCodeLine{00424\ \ \ \textcolor{keywordtype}{double}\ value;}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ numParams\ =\ spatialParams-\/>numParameters;}
\DoxyCodeLine{00427\ \ \ numLocs\ =\ spatialParams-\/>numLocs;}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ numParams;\ i++)\ \{}
\DoxyCodeLine{00430\ \ \ \ \ \textcolor{keywordflow}{if}\ (isSpatial(spatialParams,\ i))\ \{}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (loc\ =\ 0;\ loc\ <\ numLocs;\ loc++)\ \{}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (randomReset\ ==\ 0)\ \textcolor{comment}{//\ non-\/random:\ use\ guess\ value}}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ value\ =\ getSpatialParamGuess(spatialParams,\ i,\ loc);}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ random:\ set\ parameter\ value\ to\ be\ somewhere\ between\ min\ and\ max}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ value\ =\ getSpatialParamMin(spatialParams,\ i)\ +\ (getSpatialParamMax(spatialParams,\ i)\ -\/\ getSpatialParamMin(spatialParams,\ i))\ }
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ *\ ((\textcolor{keywordtype}{float})rand()/RAND\_MAX);}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ setSpatialParam(spatialParams,\ i,\ loc,\ value);}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ setSpatialParamBest(spatialParams,\ i,\ loc,\ value);}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ setSpatialParamKnob(spatialParams,\ i,\ loc,\ knob);}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00441\ \ \ \ \ \}}
\DoxyCodeLine{00442\ \ \ \ \ \textcolor{keywordflow}{else}\ \{\ \textcolor{comment}{//\ non-\/spatial}}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (randomReset\ ==\ 0)\ \textcolor{comment}{//\ non-\/random:\ use\ guess\ value}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ value\ =\ getSpatialParamGuess(spatialParams,\ i,\ 0);}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ random:\ set\ parameter\ value\ to\ be\ somewhere\ between\ min\ and\ max}}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ value\ =\ getSpatialParamMin(spatialParams,\ i)\ +\ (getSpatialParamMax(spatialParams,\ i)\ -\/\ getSpatialParamMin(spatialParams,\ i))}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ *\ ((\textcolor{keywordtype}{float})rand()/RAND\_MAX);}
\DoxyCodeLine{00448\ \ \ \ \ \ \ setSpatialParam(spatialParams,\ i,\ 0,\ value);}
\DoxyCodeLine{00449\ \ \ \ \ \ \ setSpatialParamBest(spatialParams,\ i,\ 0,\ value);}
\DoxyCodeLine{00450\ \ \ \ \ \ \ setSpatialParamKnob(spatialParams,\ i,\ 0,\ knob);}
\DoxyCodeLine{00451\ \ \ \ \ \}}
\DoxyCodeLine{00452\ \ \ \}}
\DoxyCodeLine{00453\ \}}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \textcolor{comment}{/*\ Write\ best\ parameter\ values,\ and\ other\ parameter\ info,\ to\ files}}
\DoxyCodeLine{00457\ \textcolor{comment}{\ \ \ Note\ that\ other\ parameter\ info\ won't\ have\ changed\ since\ the\ read\ -\/\ we\ just\ copy\ that\ over}}
\DoxyCodeLine{00458\ \textcolor{comment}{\ \ \ Write\ all\ parameter\ info\ to\ file\ with\ name\ *paramFile,\ and\ spatially-\/varying\ parameter\ values\ to\ file\ with\ name\ *spatialParamFile}}
\DoxyCodeLine{00459\ \textcolor{comment}{\ \ \ See\ readOneSpatialParam\ for\ file\ formats}}
\DoxyCodeLine{00460\ \textcolor{comment}{*/}}
\DoxyCodeLine{00461\ \textcolor{keywordtype}{void}\ writeBestSpatialParams(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{char}\ *paramFile,\ \textcolor{keywordtype}{char}\ *spatialParamFile)\ \{}
\DoxyCodeLine{00462\ \ \ FILE\ *paramF,\ *spatialParamF;}
\DoxyCodeLine{00463\ \ \ \textcolor{keywordtype}{int}\ numParams,\ numLocs;}
\DoxyCodeLine{00464\ \ \ \textcolor{keywordtype}{int}\ i,\ j;}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ paramF\ =\ openFile(paramFile,\ \textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{00467\ \ \ spatialParamF\ =\ openFile(spatialParamFile,\ \textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{00468\ }
\DoxyCodeLine{00469\ \ \ numParams\ =\ spatialParams-\/>numParameters;}
\DoxyCodeLine{00470\ \ \ numLocs\ =\ spatialParams-\/>numLocs;}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ fprintf(spatialParamF,\ \textcolor{stringliteral}{"{}\%d\(\backslash\)n"{}},\ numLocs);}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ numParams;\ i++)\ \{\ \textcolor{comment}{//\ loop\ through\ parameters}}
\DoxyCodeLine{00475\ \ \ \ \ fprintf(paramF,\ \textcolor{stringliteral}{"{}\%s\(\backslash\)t"{}},\ spatialParams-\/>parameters[i].name);}
\DoxyCodeLine{00476\ \ \ \ \ \textcolor{keywordflow}{if}\ (isSpatial(spatialParams,\ i))\ \{\ }
\DoxyCodeLine{00477\ \ \ \ \ \ \ fprintf(paramF,\ \textcolor{stringliteral}{"{}*\(\backslash\)t"{}});\ \textcolor{comment}{//\ write\ "{}*"{}\ in\ place\ of\ value,\ then\ write\ values\ to\ spatialParamFile}}
\DoxyCodeLine{00478\ \ \ \ \ \ \ fprintf(spatialParamF,\ \textcolor{stringliteral}{"{}\%s"{}},\ spatialParams-\/>parameters[i].name);}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ numLocs;\ j++)\ \textcolor{comment}{//\ loop\ through\ locations}}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ fprintf(spatialParamF,\ \textcolor{stringliteral}{"{}\(\backslash\)t\%f"{}},\ getSpatialParamBest(spatialParams,\ i,\ j));}
\DoxyCodeLine{00481\ \ \ \ \ \ \ fprintf(spatialParamF,\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00482\ \ \ \ \ \}}
\DoxyCodeLine{00483\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ non-\/spatial:\ write\ value}}
\DoxyCodeLine{00484\ \ \ \ \ \ \ fprintf(paramF,\ \textcolor{stringliteral}{"{}\%f\(\backslash\)t"{}},\ getSpatialParamBest(spatialParams,\ i,\ 0));}
\DoxyCodeLine{00485\ }
\DoxyCodeLine{00486\ \ \ \ \ \textcolor{comment}{//\ now\ write\ other\ info\ to\ file\ (other\ info\ is\ always\ non-\/spatial):}}
\DoxyCodeLine{00487\ \ \ \ \ fprintf(paramF,\ \textcolor{stringliteral}{"{}\%d\(\backslash\)t\%f\(\backslash\)t\%f\(\backslash\)t\%f\(\backslash\)n"{}},\ isChangeable(spatialParams,\ i),\ getSpatialParamMin(spatialParams,i),}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ getSpatialParamMax(spatialParams,\ i),\ getSpatialParamSigma(spatialParams,\ i));}
\DoxyCodeLine{00489\ \ \ \}}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \ \ fclose(paramF);}
\DoxyCodeLine{00492\ \ \ fclose(spatialParamF);}
\DoxyCodeLine{00493\ \}}
\DoxyCodeLine{00494\ \ \ \ \ }
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00496\ \textcolor{comment}{/*\ Write\ name,\ guess,\ min\ \&\ max,\ value,\ best\ and\ knob\ of\ each\ changeable\ param\ to\ file}}
\DoxyCodeLine{00497\ \textcolor{comment}{\ \ \ If\ loc\ >=\ 0,\ write\ info\ for\ that\ location;\ if\ loc\ =\ -\/1,\ write\ value\ at\ location\ 0,\ and\ append\ a\ *\ to\ spatial\ parameter\ values}}
\DoxyCodeLine{00498\ \textcolor{comment}{\ \ \ PRE:\ outF\ is\ open\ for\ writing}}
\DoxyCodeLine{00499\ \textcolor{comment}{*/}}
\DoxyCodeLine{00500\ \textcolor{keywordtype}{void}\ writeChangeableParamInfo(SpatialParams\ *spatialParams,\ \textcolor{keywordtype}{int}\ loc,\ FILE\ *outF)\ \{}
\DoxyCodeLine{00501\ \ \ \textcolor{keywordtype}{int}\ i,\ numParams,\ count;}
\DoxyCodeLine{00502\ \ \ \textcolor{keywordtype}{int}\ theLoc;\ \textcolor{comment}{//\ location\ that\ we're\ printing\ info\ for}}
\DoxyCodeLine{00503\ \ \ \textcolor{keywordtype}{char}\ appendage[2];}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \textcolor{keywordflow}{if}\ (loc\ ==\ -\/1)}
\DoxyCodeLine{00506\ \ \ \ \ theLoc\ =\ 0;}
\DoxyCodeLine{00507\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00508\ \ \ \ \ theLoc\ =\ loc;}
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00510\ \ \ numParams\ =\ spatialParams-\/>numParameters;}
\DoxyCodeLine{00511\ \ \ count\ =\ 0;\ \textcolor{comment}{//\ count\ of\ changeable\ parameters}}
\DoxyCodeLine{00512\ \ \ fprintf(outF,\ \textcolor{stringliteral}{"{}Changeable\ Parameters:\(\backslash\)n"{}});}
\DoxyCodeLine{00513\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ numParams;\ i++)\ \{}
\DoxyCodeLine{00514\ \ \ \ \ \textcolor{keywordflow}{if}\ (isChangeable(spatialParams,\ i))\ \{}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (loc\ ==\ -\/1\ \&\&\ isSpatial(spatialParams,\ i))\ \textcolor{comment}{//\ we'll\ append\ a\ *\ to\ spatially-\/varying\ values}}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ strcpy(appendage,\ \textcolor{stringliteral}{"{}*"{}});}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ strcpy(appendage,\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \ \ \ \ fprintf(outF,\ \textcolor{stringliteral}{"{}[\%d]\ \%s:\(\backslash\)t"{}},\ count,\ spatialParams-\/>parameters[i].name);}
\DoxyCodeLine{00521\ \ \ \ \ \ \ fprintf(outF,\ \textcolor{stringliteral}{"{}Value\ =\ \%f\%s\(\backslash\)t"{}},\ getSpatialParam(spatialParams,\ i,\ theLoc),\ appendage);}
\DoxyCodeLine{00522\ \ \ \ \ \ \ fprintf(outF,\ \textcolor{stringliteral}{"{}Best\ =\ \%f\%s\(\backslash\)t"{}},\ getSpatialParamBest(spatialParams,\ i,\ theLoc),\ appendage);}
\DoxyCodeLine{00523\ \ \ \ \ \ \ fprintf(outF,\ \textcolor{stringliteral}{"{}Knob\ =\ \%f\%s\(\backslash\)t"{}},\ getSpatialParamKnob(spatialParams,\ i,\ theLoc),\ appendage);}
\DoxyCodeLine{00524\ \ \ \ \ \ \ fprintf(outF,\ \textcolor{stringliteral}{"{}Prior:\ \%f\%s\ "{}},\ getSpatialParamGuess(spatialParams,\ i,\ theLoc),\ appendage);}
\DoxyCodeLine{00525\ \ \ \ \ \ \ fprintf(outF,\ \textcolor{stringliteral}{"{}\ [\%f,\ \%f]\(\backslash\)n"{}},\ getSpatialParamMin(spatialParams,\ i),\ getSpatialParamMax(spatialParams,\ i));}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00527\ \ \ \ \ \ \ count++;}
\DoxyCodeLine{00528\ \ \ \ \ \}}
\DoxyCodeLine{00529\ \ \ \}}
\DoxyCodeLine{00530\ \}}
\DoxyCodeLine{00531\ }
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ \textcolor{comment}{//\ Clean\ up:\ deallocate\ spatialParams\ and\ any\ other\ dynamically-\/allocated\ pointers\ that\ need\ deallocating}}
\DoxyCodeLine{00534\ \textcolor{keywordtype}{void}\ deleteSpatialParams(SpatialParams\ *spatialParams)\ \{}
\DoxyCodeLine{00535\ \ \ \textcolor{keywordtype}{int}\ numParameters,\ i;}
\DoxyCodeLine{00536\ \ \ OneSpatialParam\ *param;}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ \ \ \textcolor{comment}{//\ first\ loop\ through\ individual\ parameters,\ de-\/allocating\ space\ they\ use:}}
\DoxyCodeLine{00539\ \ \ numParameters\ =\ spatialParams-\/>numParameters;}
\DoxyCodeLine{00540\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ numParameters;\ i++)\ \{}
\DoxyCodeLine{00541\ \ \ \ \ param\ =\ \&(spatialParams-\/>parameters[i]);}
\DoxyCodeLine{00542\ \ \ \ \ \textcolor{keywordflow}{if}\ (param-\/>value\ !=\ NULL)\ \{\ \textcolor{comment}{//\ this\ parameter\ has\ been\ used\ -\/\ so\ space\ has\ been\ allocated\ for\ its\ various\ values}}
\DoxyCodeLine{00543\ \ \ \ \ \ \ free(param-\/>value);}
\DoxyCodeLine{00544\ \ \ \ \ \ \ free(param-\/>guess);}
\DoxyCodeLine{00545\ \ \ \ \ \ \ free(param-\/>best);}
\DoxyCodeLine{00546\ \ \ \ \ \ \ free(param-\/>knob);}
\DoxyCodeLine{00547\ \ \ \ \ \}}
\DoxyCodeLine{00548\ \ \ \}}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ \textcolor{comment}{//\ now\ free\ space\ used\ by\ spatialParams\ structure\ itself:}}
\DoxyCodeLine{00551\ \ \ free(spatialParams-\/>parameters);}
\DoxyCodeLine{00552\ \ \ free(spatialParams-\/>changeableParamIndices);}
\DoxyCodeLine{00553\ \}}
\DoxyCodeLine{00554\ }
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ }

\end{DoxyCode}
