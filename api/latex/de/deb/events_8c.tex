\doxysection{events.\+c File Reference}
\label{events_8c}\index{events.c@{events.c}}


Handles reading, parsing, and storing agronomic events for SIPNET simulations.  


{\ttfamily \#include "{}events.\+h"{}}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include "{}common/exit\+Codes.\+h"{}}\newline
{\ttfamily \#include "{}common/util.\+h"{}}\newline
Include dependency graph for events.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d63/events_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \textbf{ print\+Event} (\textbf{ Event\+Node} $\ast$event)
\item 
\textbf{ Event\+Node} $\ast$ \textbf{ create\+Event\+Node} (int loc, int year, int day, int event\+Type, const char $\ast$event\+Params\+Str)
\item 
\textbf{ event\+\_\+type\+\_\+t} \textbf{ get\+Event\+Type} (const char $\ast$event\+Type\+Str)
\item 
\textbf{ Event\+Node} $\ast$$\ast$ \textbf{ read\+Event\+Data} (char $\ast$event\+File, int \textbf{ num\+Locs})
\item 
const char $\ast$ \textbf{ event\+Type\+To\+String} (\textbf{ event\+\_\+type\+\_\+t} type)
\item 
FILE $\ast$ \textbf{ open\+Event\+Out\+File} (int print\+Header)
\item 
void \textbf{ write\+Event\+Out} (FILE $\ast$out, \textbf{ Event\+Node} $\ast$event, int num\+Params,...)
\begin{DoxyCompactList}\small\item\em Write a line to events.\+out for a single event. \end{DoxyCompactList}\item 
void \textbf{ close\+Event\+Out\+File} (FILE $\ast$file)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handles reading, parsing, and storing agronomic events for SIPNET simulations. 

The {\ttfamily events.\+in} file specifies agronomic events with the following columns\+: \tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ col   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ parameter   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ description   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ units    }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ col   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ parameter   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ description   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ units    }\\\cline{1-4}
\endhead
1   &loc   &spatial location index   &\\\cline{1-4}
2   &year   &year of start of this timestep   &\\\cline{1-4}
3   &day   &day of start of this timestep   &Day of year    \\\cline{1-4}
4   &event\+\_\+type   &type of event   &(e.\+g., "{}irrig"{})    \\\cline{1-4}
5...n   &event\+\_\+param   &parameters specific to the event type   &(varies)   \\\cline{1-4}
\end{longtabu}


Event types include\+:
\begin{DoxyItemize}
\item "{}irrig"{}\+: \doxyref{Parameters}{p.}{d0/dbf/struct_parameters} = [amount added (cm/d), type (0=canopy, 1=soil, 2=flood)]
\item "{}fert"{}\+: \doxyref{Parameters}{p.}{d0/dbf/struct_parameters} = [Org-\/N (g/m²), Org-\/C (g/ha), Min-\/N (g/m²), Min-\/\+N2 (g/m²)]
\item "{}till"{}\+: \doxyref{Parameters}{p.}{d0/dbf/struct_parameters} = [SOM decomposition modifier, litter decomposition modifier]
\item "{}plant"{}\+: \doxyref{Parameters}{p.}{d0/dbf/struct_parameters} = [leaf C (g/m²), wood C (g/m²), fine root C (g/m²), corase root C (g/m²)]
\item "{}harv"{}\+: \doxyref{Parameters}{p.}{d0/dbf/struct_parameters} = [fraction aboveground removed, fraction belowground removed, ...] See test examples in {\ttfamily tests/sipnet/test\+\_\+events\+\_\+infrastructure/} and tests/sipnet/test\+\_\+events\+\_\+types/. 
\end{DoxyItemize}

Definition in file \textbf{ events.\+c}.



\doxysubsection{Function Documentation}
\label{events_8c_a9751770959684fd1795afaa844e7f132} 
\index{events.c@{events.c}!closeEventOutFile@{closeEventOutFile}}
\index{closeEventOutFile@{closeEventOutFile}!events.c@{events.c}}
\doxysubsubsection{closeEventOutFile()}
{\footnotesize\ttfamily void close\+Event\+Out\+File (\begin{DoxyParamCaption}\item[{FILE $\ast$}]{file }\end{DoxyParamCaption})}

Close the event output file 
\begin{DoxyParams}{Parameters}
{\em file} & FILE pointer for output file \\
\hline
\end{DoxyParams}


Definition at line \textbf{ 364} of file \textbf{ events.\+c}.



Referenced by \textbf{ cleanup\+Model()}.

\label{events_8c_a3145169f83f9dc878adef2f12da419af} 
\index{events.c@{events.c}!createEventNode@{createEventNode}}
\index{createEventNode@{createEventNode}!events.c@{events.c}}
\doxysubsubsection{createEventNode()}
{\footnotesize\ttfamily \textbf{ Event\+Node} $\ast$ create\+Event\+Node (\begin{DoxyParamCaption}\item[{int}]{loc,  }\item[{int}]{year,  }\item[{int}]{day,  }\item[{int}]{event\+Type,  }\item[{const char $\ast$}]{event\+Params\+Str }\end{DoxyParamCaption})}



Definition at line \textbf{ 36} of file \textbf{ events.\+c}.



References \textbf{ EXIT\+\_\+\+CODE\+\_\+\+BAD\+\_\+\+PARAMETER\+\_\+\+VALUE}, \textbf{ EXIT\+\_\+\+CODE\+\_\+\+INPUT\+\_\+\+FILE\+\_\+\+ERROR}, \textbf{ FERTILIZATION}, \textbf{ HARVEST}, \textbf{ IRRIGATION}, \textbf{ Event\+Node\+::loc}, \textbf{ NUM\+\_\+\+FERTILIZATION\+\_\+\+PARAMS}, \textbf{ NUM\+\_\+\+HARVEST\+\_\+\+PARAMS}, \textbf{ NUM\+\_\+\+IRRIGATION\+\_\+\+PARAMS}, \textbf{ NUM\+\_\+\+PLANTING\+\_\+\+PARAMS}, \textbf{ NUM\+\_\+\+TILLAGE\+\_\+\+PARAMS}, \textbf{ params}, \textbf{ PLANTING}, and \textbf{ TILLAGE}.



Referenced by \textbf{ read\+Event\+Data()}.

\label{events_8c_adaf5398f33e074025777106e1211e3c6} 
\index{events.c@{events.c}!eventTypeToString@{eventTypeToString}}
\index{eventTypeToString@{eventTypeToString}!events.c@{events.c}}
\doxysubsubsection{eventTypeToString()}
{\footnotesize\ttfamily const char $\ast$ event\+Type\+To\+String (\begin{DoxyParamCaption}\item[{\textbf{ event\+\_\+type\+\_\+t}}]{type }\end{DoxyParamCaption})}

Convert event enum value to corresponding string


\begin{DoxyParams}{Parameters}
{\em type} & enum value representing the event \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string version of event enum type 
\end{DoxyReturn}


Definition at line \textbf{ 316} of file \textbf{ events.\+c}.



References \textbf{ EXIT\+\_\+\+CODE\+\_\+\+UNKNOWN\+\_\+\+EVENT\+\_\+\+TYPE\+\_\+\+OR\+\_\+\+PARAM}, \textbf{ FERTILIZATION}, \textbf{ HARVEST}, \textbf{ IRRIGATION}, \textbf{ PLANTING}, and \textbf{ TILLAGE}.



Referenced by \textbf{ write\+Event\+Out()}.

\label{events_8c_a4314c765f6bbd615a94286919f475f41} 
\index{events.c@{events.c}!getEventType@{getEventType}}
\index{getEventType@{getEventType}!events.c@{events.c}}
\doxysubsubsection{getEventType()}
{\footnotesize\ttfamily \textbf{ event\+\_\+type\+\_\+t} get\+Event\+Type (\begin{DoxyParamCaption}\item[{const char $\ast$}]{event\+Type\+Str }\end{DoxyParamCaption})}



Definition at line \textbf{ 145} of file \textbf{ events.\+c}.



References \textbf{ FERTILIZATION}, \textbf{ HARVEST}, \textbf{ IRRIGATION}, \textbf{ PLANTING}, \textbf{ TILLAGE}, and \textbf{ UNKNOWN\+\_\+\+EVENT}.



Referenced by \textbf{ read\+Event\+Data()}.

\label{events_8c_a89e0951d47d80ebfe47bf24c892ae03b} 
\index{events.c@{events.c}!openEventOutFile@{openEventOutFile}}
\index{openEventOutFile@{openEventOutFile}!events.c@{events.c}}
\doxysubsubsection{openEventOutFile()}
{\footnotesize\ttfamily FILE $\ast$ open\+Event\+Out\+File (\begin{DoxyParamCaption}\item[{int}]{print\+Header }\end{DoxyParamCaption})}

Open the event output file and optionally write a header row 
\begin{DoxyParams}{Parameters}
{\em print\+Header} & Flag, non-\/zero value means write a header row \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
FILE pointer to output file 
\end{DoxyReturn}


Definition at line \textbf{ 334} of file \textbf{ events.\+c}.



References \textbf{ EVENT\+\_\+\+OUT\+\_\+\+FILE}, and \textbf{ open\+File()}.



Referenced by \textbf{ init\+Events()}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=241pt]{de/deb/events_8c_a89e0951d47d80ebfe47bf24c892ae03b_cgraph}
\end{center}
\end{figure}
\label{events_8c_aeda31871c170fe492587b17f70382344} 
\index{events.c@{events.c}!printEvent@{printEvent}}
\index{printEvent@{printEvent}!events.c@{events.c}}
\doxysubsubsection{printEvent()}
{\footnotesize\ttfamily void print\+Event (\begin{DoxyParamCaption}\item[{\textbf{ Event\+Node} $\ast$}]{event }\end{DoxyParamCaption})}



Definition at line \textbf{ 266} of file \textbf{ events.\+c}.



References \textbf{ Irrigation\+Params\+::amount\+Added}, \textbf{ Planting\+Params\+::coarse\+RootC}, \textbf{ Event\+Node\+::event\+Params}, \textbf{ FERTILIZATION}, \textbf{ Planting\+Params\+::fine\+RootC}, \textbf{ Tillage\+Params\+::fraction\+Litter\+Transferred}, \textbf{ Harvest\+Params\+::fraction\+Removed\+Above}, \textbf{ Harvest\+Params\+::fraction\+Removed\+Below}, \textbf{ Harvest\+Params\+::fraction\+Transferred\+Above}, \textbf{ Harvest\+Params\+::fraction\+Transferred\+Below}, \textbf{ HARVEST}, \textbf{ IRRIGATION}, \textbf{ Planting\+Params\+::leafC}, \textbf{ Tillage\+Params\+::litter\+Decomp\+Modifier}, \textbf{ Event\+Node\+::loc}, \textbf{ Fertilization\+Params\+::minN}, \textbf{ Fertilization\+Params\+::orgC}, \textbf{ Fertilization\+Params\+::orgN}, \textbf{ PLANTING}, \textbf{ Tillage\+Params\+::som\+Decomp\+Modifier}, \textbf{ TILLAGE}, \textbf{ Event\+Node\+::type}, and \textbf{ Planting\+Params\+::woodC}.

\label{events_8c_a23276d1145e6335ce7579bbbd6c27404} 
\index{events.c@{events.c}!readEventData@{readEventData}}
\index{readEventData@{readEventData}!events.c@{events.c}}
\doxysubsubsection{readEventData()}
{\footnotesize\ttfamily \textbf{ Event\+Node} $\ast$$\ast$ read\+Event\+Data (\begin{DoxyParamCaption}\item[{char $\ast$}]{event\+File,  }\item[{int}]{num\+Locs }\end{DoxyParamCaption})}

Read event data from input filename (canonically events.\+in)

Format\+: returned data is structured as an array of \doxyref{Event\+Node}{p.}{d6/d43/struct_event_node} pointers, indexed by location. Each element of the array is the first event for that location (or null if there are no events). It is assumed that the events are ordered first by location and then by year and day. 

Definition at line \textbf{ 160} of file \textbf{ events.\+c}.



References \textbf{ create\+Event\+Node()}, \textbf{ events}, \textbf{ EXIT\+\_\+\+CODE\+\_\+\+INPUT\+\_\+\+FILE\+\_\+\+ERROR}, \textbf{ EXIT\+\_\+\+CODE\+\_\+\+UNKNOWN\+\_\+\+EVENT\+\_\+\+TYPE\+\_\+\+OR\+\_\+\+PARAM}, \textbf{ get\+Event\+Type()}, \textbf{ Event\+Node\+::next\+Event}, \textbf{ NUM\+\_\+\+EVENT\+\_\+\+CORE\+\_\+\+PARAMS}, \textbf{ num\+Locs}, \textbf{ open\+File()}, and \textbf{ UNKNOWN\+\_\+\+EVENT}.



Referenced by \textbf{ init\+Events()}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=270pt]{de/deb/events_8c_a23276d1145e6335ce7579bbbd6c27404_cgraph}
\end{center}
\end{figure}
\label{events_8c_ae9bd841e389dc48f66a90ba59466ee08} 
\index{events.c@{events.c}!writeEventOut@{writeEventOut}}
\index{writeEventOut@{writeEventOut}!events.c@{events.c}}
\doxysubsubsection{writeEventOut()}
{\footnotesize\ttfamily void write\+Event\+Out (\begin{DoxyParamCaption}\item[{FILE $\ast$}]{out,  }\item[{\textbf{ Event\+Node} $\ast$}]{event,  }\item[{int}]{num\+Params,  }\item[{}]{... }\end{DoxyParamCaption})}



Write a line to events.\+out for a single event. 

Writes a single event to events.\+out. This is a variadic function which expects to receive 2$\ast$num\+Params values in (char$\ast$, double) pairs after the num\+Params argument.

Output format\+:

loc year day event\+\_\+type $<$param\+\_\+name$>$=$<$delta$>$[,$<$param\+\_\+name$>$=$<$delta$>$,...]


\begin{DoxyParams}{Parameters}
{\em out} & FILE pointer to events.\+out \\
\hline
{\em event} & Pointer to event node \\
\hline
{\em num\+Params} & Number of param/value pairs to write \\
\hline
{\em ...} & Pairs of (char$\ast$, double) arguments to write, 2$\ast$num\+Params values \\
\hline
\end{DoxyParams}


Definition at line \textbf{ 345} of file \textbf{ events.\+c}.



References \textbf{ Event\+Node\+::day}, \textbf{ event\+Type\+To\+String()}, \textbf{ Event\+Node\+::loc}, \textbf{ Event\+Node\+::type}, and \textbf{ Event\+Node\+::year}.



Referenced by \textbf{ process\+Events()}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=272pt]{de/deb/events_8c_ae9bd841e389dc48f66a90ba59466ee08_cgraph}
\end{center}
\end{figure}
